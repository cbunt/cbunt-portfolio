{"version":3,"file":"816.bundle.js","mappings":"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","sources":["webpack://cbunt-portfolio/./src/components/button/button.module.scss","webpack://cbunt-portfolio/./src/components/checkbox/checkbox.module.scss","webpack://cbunt-portfolio/./src/components/select/select.module.scss","webpack://cbunt-portfolio/./src/components/slider/slider.module.scss","webpack://cbunt-portfolio/./src/components/viewport/fullscreen-button/fullscreen-button.module.scss","webpack://cbunt-portfolio/./src/components/viewport/settings-panel/settings-panel.module.scss","webpack://cbunt-portfolio/./src/rendering/core/tonemap-pass.ts","webpack://cbunt-portfolio/./src/rendering/core/skybox-pass.ts","webpack://cbunt-portfolio/./src/rendering/core/gbuffer.ts","webpack://cbunt-portfolio/./src/rendering/shaders/brdfs.shader.ts","webpack://cbunt-portfolio/./src/rendering/core/ibl-textures/create-bfrd-lut.ts","webpack://cbunt-portfolio/./src/rendering/core/ibl-textures/create-irradiance-texture.ts","webpack://cbunt-portfolio/./src/rendering/core/ibl-textures/create-radiance-texture.ts","webpack://cbunt-portfolio/./src/rendering/core/deferred-pass.ts","webpack://cbunt-portfolio/./src/rendering/core/renderer.ts","webpack://cbunt-portfolio/./src/components/button/button.module.scss?9a7c","webpack://cbunt-portfolio/./src/components/button/button.tsx","webpack://cbunt-portfolio/./src/components/select/select.module.scss?3528","webpack://cbunt-portfolio/./src/components/select/select.tsx","webpack://cbunt-portfolio/./src/components/file-upload/file-upload.tsx","webpack://cbunt-portfolio/./src/utils/hooks.tsx","webpack://cbunt-portfolio/./src/components/checkbox/checkbox.module.scss?a988","webpack://cbunt-portfolio/./src/components/checkbox/checkbox.tsx","webpack://cbunt-portfolio/./src/components/slider/slider.module.scss?79f0","webpack://cbunt-portfolio/./src/components/slider/slider.tsx","webpack://cbunt-portfolio/./src/components/viewport/settings-panel/settings-panel.module.scss?7544","webpack://cbunt-portfolio/./src/components/viewport/settings-panel/settings-panel.tsx","webpack://cbunt-portfolio/./src/components/viewport/model-settings-gui.tsx","webpack://cbunt-portfolio/./src/components/viewport/fullscreen-button/fullscreen-button.module.scss?6823","webpack://cbunt-portfolio/./src/components/viewport/fullscreen-button/fullscreen-button.tsx","webpack://cbunt-portfolio/./src/rendering/core/camera/orbit-camera-controller.ts","webpack://cbunt-portfolio/./src/components/viewport/viewport.tsx","webpack://cbunt-portfolio/./src/rendering/core/camera/camera.ts","webpack://cbunt-portfolio/./src/rendering/core/constants.ts","webpack://cbunt-portfolio/./src/rendering/core/global-uniforms.ts","webpack://cbunt-portfolio/./src/rendering/samples/settings/property-listener.ts","webpack://cbunt-portfolio/./src/rendering/shaders/blit-vert.shader.ts","webpack://cbunt-portfolio/./src/rendering/shaders/cubemap-sampling.shader.ts","webpack://cbunt-portfolio/./src/rendering/utils/data-copy.ts","webpack://cbunt-portfolio/./src/utils/general.ts"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `html{--hover-scale: 1.075;--active-scale: 0.95;--scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);--scale-transition-duration: 0.2s}@media(prefers-reduced-motion)or (hover: none){html{--hover-scale: 1 !important;--active-scale: 1 !important}}main button:not([class]){--scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);transition:var(--scale-transition);position:relative;border:0.2lh solid rgba(0,0,0,0);--hover-scale: 1.05;--active-scale: 1;border-radius:6px;white-space:nowrap;height:1lh;padding:.75lh .5lh;width:100%;display:inline-flex;align-items:center;justify-content:center;font-weight:700;transition:font-stretch .15s var(--scale-bezier),var(--scale-transition)}main button:not([class]):not(:disabled){cursor:pointer}main button:not([class]):hover:not(:disabled){scale:var(--hover-scale)}main button:not([class]):active:not(:disabled){scale:var(--active-scale)}main button:not([class]):before{content:\"\";position:absolute;z-index:1;pointer-events:none;width:calc(100% + 0.2lh);height:calc(100% + 0.2lh);top:calc(-0.5*0.2lh);left:calc(-0.5*0.2lh);filter:var(--distortion-filter);border:solid;background-color:rgba(0,0,0,0);border-radius:inherit;border-width:0.2lh;border-color:currentColor}main button:not([class]):hover:not(:disabled){font-stretch:110%;filter:drop-shadow(0 0 2px currentColor) var(--distortion-filter)}main button:not([class]):active:not(:disabled){font-stretch:105%}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/mixins.module.scss\",\"webpack://./src/components/button/button.module.scss\"],\"names\":[],\"mappings\":\"AAAA,KACI,oBAAA,CACA,oBAAA,CACA,iDAAA,CACA,iCAAA,CAEA,+CANJ,KAOQ,2BAAA,CACA,4BAAA,CAAA,CCNR,yBDWI,8EAAA,CACA,kCAAA,CAgBA,iBAAA,CACA,gCAAA,CCzBA,mBAAA,CACA,iBAAA,CAEA,iBAAA,CAEA,kBAAA,CAEA,UAAA,CACA,kBAAA,CACA,UAAA,CAEA,mBAAA,CACA,kBAAA,CACA,sBAAA,CAEA,eAAA,CAEA,wEACI,CDRJ,wCACI,cAAA,CAGJ,8CACI,wBAAA,CAGJ,+CACI,yBAAA,CAQJ,gCACI,UAAA,CACA,iBAAA,CACA,SAAA,CACA,mBAAA,CAEA,wBAAA,CACA,yBAAA,CACA,oBAAA,CACA,qBAAA,CACA,+BAAA,CAEA,YAAA,CACA,8BAAA,CACA,qBAAA,CACA,kBAAA,CACA,yBAAA,CCtBJ,8CACI,iBAAA,CACA,iEACI,CAIR,+CACI,iBAAA\",\"sourcesContent\":[\"html {\\n    --hover-scale: 1.075;\\n    --active-scale: 0.95;\\n    --scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);\\n    --scale-transition-duration: 0.2s; \\n\\n    @media (prefers-reduced-motion) OR (hover: none) { \\n        --hover-scale: 1 !important;\\n        --active-scale: 1 !important;\\n    }\\n}\\n\\n@mixin clickable {\\n    --scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);\\n    transition: var(--scale-transition);\\n\\n    &:not(:disabled) {\\n        cursor: pointer;\\n    }\\n    \\n    &:hover:not(:disabled) {\\n        scale: var(--hover-scale);\\n    }\\n    \\n    &:active:not(:disabled) {\\n        scale: var(--active-scale);\\n    }\\n}\\n\\n@mixin distortion-border($width, $color: currentColor) {\\n    position: relative;\\n    border: #{$width} solid transparent;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: 1;\\n        pointer-events: none;\\n    \\n        width: calc(100% + #{$width});\\n        height: calc(100% + #{$width});\\n        top: calc(-0.5 * #{$width});\\n        left: calc(-0.5 * #{$width});\\n        filter: var(--distortion-filter);\\n    \\n        border: solid;\\n        background-color: #0000;\\n        border-radius: inherit;\\n        border-width: #{$width};\\n        border-color: #{$color};\\n    }\\n}\\n\\n@mixin distortion-background($color:var(--background-color)) {\\n    position: relative;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: -1;\\n        top: 0;\\n        left: 0;\\n        width: 100%;\\n        height: 100%;\\n        filter: var(--distortion-filter);\\n\\n        border-radius: inherit;\\n        background-color: #{$color};\\n    }\\n}\\n\",\"@use \\\"../mixins.module.scss\\\" as mixins;\\n\\nmain button:not([class]) {\\n    @include mixins.clickable;\\n    @include mixins.distortion-border(0.2lh);\\n\\n    --hover-scale: 1.05;\\n    --active-scale: 1;\\n\\n    border-radius: 6px;\\n\\n    white-space: nowrap;\\n\\n    height: 1lh;\\n    padding: 0.75lh 0.5lh;\\n    width: 100%;\\n\\n    display: inline-flex;\\n    align-items: center;\\n    justify-content: center;\\n\\n    font-weight: 700;\\n\\n    transition:\\n        font-stretch 0.15s var(--scale-bezier),\\n        var(--scale-transition);\\n\\n    &:hover:not(:disabled) {\\n        font-stretch: 110%;\\n        filter: \\n            drop-shadow(0 0 2px currentColor)\\n            var(--distortion-filter);\\n    }\\n\\n    &:active:not(:disabled) {\\n        font-stretch: 105%;\\n    }\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `html{--hover-scale: 1.075;--active-scale: 0.95;--scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);--scale-transition-duration: 0.2s}@media(prefers-reduced-motion)or (hover: none){html{--hover-scale: 1 !important;--active-scale: 1 !important}}input[type=checkbox]{--scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);transition:var(--scale-transition);--height: 1lh;height:var(--height);appearance:none;margin:0;aspect-ratio:1;position:relative;border:.25lh solid oklch(from var(--accent-2) calc(l * var(--ok-l2)) c h);border-radius:5px;background-color:var(--background-color);transition:var(--scale-transition),background-color .2s ease-out,border-color .2s ease-out}input[type=checkbox]:not(:disabled){cursor:pointer}input[type=checkbox]:hover:not(:disabled){scale:var(--hover-scale)}input[type=checkbox]:active:not(:disabled){scale:var(--active-scale)}input[type=checkbox] label{position:relative}input[type=checkbox]:checked{background-color:var(--accent-2);border-color:var(--accent-2)}input[type=checkbox]:before,input[type=checkbox]:after{content:\"\";position:absolute;top:-0.2lh;width:calc(var(--height)*1.4142135624);height:max(4px,.2rem);scale:0 1;background:oklch(from var(--accent-2) calc(l * var(--ok-l2)) c h);border-radius:6px;transition-property:scale;transition-timing-function:ease-in;transition-duration:75ms}input[type=checkbox]:checked::before,input[type=checkbox]:checked:after{scale:1;transition-timing-function:ease-out;transition-duration:100ms}input[type=checkbox]:before{rotate:45deg;left:0;transform-origin:left top;transition-delay:100ms}input[type=checkbox]:after{rotate:-45deg;right:0;transform-origin:right top}input[type=checkbox]:checked:after{transition-delay:150ms}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/mixins.module.scss\",\"webpack://./src/components/checkbox/checkbox.module.scss\"],\"names\":[],\"mappings\":\"AAAA,KACI,oBAAA,CACA,oBAAA,CACA,iDAAA,CACA,iCAAA,CAEA,+CANJ,KAOQ,2BAAA,CACA,4BAAA,CAAA,CCNR,qBDWI,8EAAA,CACA,kCAAA,CCTA,aAAA,CACA,oBAAA,CAEA,eAAA,CACA,QAAA,CAEA,cAAA,CACA,iBAAA,CAEA,yEAAA,CACA,iBAAA,CACA,wCAAA,CAEA,0FACI,CDHJ,oCACI,cAAA,CAGJ,0CACI,wBAAA,CAGJ,2CACI,yBAAA,CCFJ,2BACI,iBAAA,CAGJ,6BACI,gCAAA,CACA,4BAAA,CAGJ,uDAEI,UAAA,CACA,iBAAA,CACA,UAAA,CAEA,sCAAA,CACA,qBAAA,CACA,SAAA,CAEA,iEAAA,CACA,iBAAA,CAEA,yBAAA,CACA,kCAAA,CACA,wBAAA,CAGJ,wEAEI,OAAA,CACA,mCAAA,CACA,yBAAA,CAGJ,4BACI,YAAA,CACA,MAAA,CACA,yBAAA,CACA,sBAAA,CAGJ,2BACI,aAAA,CACA,OAAA,CACA,0BAAA,CAGJ,mCACI,sBAAA\",\"sourcesContent\":[\"html {\\n    --hover-scale: 1.075;\\n    --active-scale: 0.95;\\n    --scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);\\n    --scale-transition-duration: 0.2s; \\n\\n    @media (prefers-reduced-motion) OR (hover: none) { \\n        --hover-scale: 1 !important;\\n        --active-scale: 1 !important;\\n    }\\n}\\n\\n@mixin clickable {\\n    --scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);\\n    transition: var(--scale-transition);\\n\\n    &:not(:disabled) {\\n        cursor: pointer;\\n    }\\n    \\n    &:hover:not(:disabled) {\\n        scale: var(--hover-scale);\\n    }\\n    \\n    &:active:not(:disabled) {\\n        scale: var(--active-scale);\\n    }\\n}\\n\\n@mixin distortion-border($width, $color: currentColor) {\\n    position: relative;\\n    border: #{$width} solid transparent;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: 1;\\n        pointer-events: none;\\n    \\n        width: calc(100% + #{$width});\\n        height: calc(100% + #{$width});\\n        top: calc(-0.5 * #{$width});\\n        left: calc(-0.5 * #{$width});\\n        filter: var(--distortion-filter);\\n    \\n        border: solid;\\n        background-color: #0000;\\n        border-radius: inherit;\\n        border-width: #{$width};\\n        border-color: #{$color};\\n    }\\n}\\n\\n@mixin distortion-background($color:var(--background-color)) {\\n    position: relative;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: -1;\\n        top: 0;\\n        left: 0;\\n        width: 100%;\\n        height: 100%;\\n        filter: var(--distortion-filter);\\n\\n        border-radius: inherit;\\n        background-color: #{$color};\\n    }\\n}\\n\",\"@use \\\"../mixins.module.scss\\\" as mixins;\\n\\ninput[type=\\\"checkbox\\\"] {\\n    @include mixins.clickable;\\n\\n    --height: 1lh;\\n    height: var(--height);\\n\\n    appearance: none;\\n    margin: 0;\\n\\n    aspect-ratio: 1;\\n    position: relative;\\n\\n    border: 0.25lh solid oklch(from var(--accent-2) calc(l * var(--ok-l2)) c h);\\n    border-radius: 5px;\\n    background-color: var(--background-color);\\n\\n    transition:\\n        var(--scale-transition),\\n        background-color 0.2s ease-out,\\n        border-color 0.2s ease-out;\\n\\n    label {\\n        position: relative;\\n    }\\n\\n    &:checked {\\n        background-color: var(--accent-2);\\n        border-color: var(--accent-2);\\n    }\\n\\n    &:before,\\n    &:after {\\n        content: '';\\n        position: absolute;\\n        top: -0.2lh;\\n\\n        width: calc(var(--height) * sqrt(2));\\n        height: max(4px, 0.2rem);\\n        scale: 0 1;\\n\\n        background: oklch(from var(--accent-2) calc(l * var(--ok-l2)) c h);\\n        border-radius: 6px;\\n        \\n        transition-property: scale;\\n        transition-timing-function: ease-in;\\n        transition-duration: 75ms;\\n    }\\n\\n    &:checked::before,\\n    &:checked:after {\\n        scale: 1;\\n        transition-timing-function: ease-out;\\n        transition-duration: 100ms;\\n    }\\n\\n    &:before {\\n        rotate: 45deg;\\n        left: 0;\\n        transform-origin: left top;\\n        transition-delay: 100ms;\\n    }\\n\\n    &:after {\\n        rotate: -45deg;\\n        right: 0;\\n        transform-origin: right top;\\n    }\\n\\n    &:checked:after {\\n        transition-delay: 150ms;\\n    }\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `select{text-wrap:none;text-overflow:ellipsis;max-width:30ch}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/select/select.module.scss\"],\"names\":[],\"mappings\":\"AAAA,OACI,cAAA,CACA,sBAAA,CACA,cAAA\",\"sourcesContent\":[\"select {\\n    text-wrap: none;\\n    text-overflow: ellipsis;\\n    max-width: 30ch;\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `html{--hover-scale: 1.075;--active-scale: 0.95;--scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);--scale-transition-duration: 0.2s}@media(prefers-reduced-motion)or (hover: none){html{--hover-scale: 1 !important;--active-scale: 1 !important}}input[type=range]{--scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);transition:var(--scale-transition);--track-color: var(--accent-2);--slider-color: oklch(from var(--track-color) calc(l * var(--ok-l2)) calc(c * 0.6) h);border-radius:5px;border:solid .2lh var(--track-color);background:rgba(0,0,0,0);transition:background-color .3s,var(--scale-transition);color:var(--slider-color);appearance:none;overflow:hidden;height:1lh;width:100%}input[type=range]:not(:disabled){cursor:pointer}input[type=range]:hover:not(:disabled){scale:var(--hover-scale)}input[type=range]:active:not(:disabled){scale:var(--active-scale)}input[type=range]::-webkit-slider-thumb{width:0;appearance:none;transition:color .3s ease;box-shadow:calc(-100vmax + 2px) 0 0 100vmax currentcolor}input[type=range]::-moz-range-track,input[type=range]::-moz-range-thumb{visibility:hidden}input[type=range]::-moz-range-progress{background:currentcolor;transition:color .3s;height:100%}input[type=range]:hover:not(:disabled)::-webkit-slider-thumb{color:color-mix(in oklch, var(--slider-color) 50%, var(--track-color))}input[type=range]:hover:not(:disabled)::-moz-range-progress{color:color-mix(in oklch, var(--slider-color) 50%, var(--track-color))}input[type=number]{width:100%;height:100%;font:inherit;color:inherit;caret-color:currentColor;appearance:none;border:none;background-color:var(--background-color);outline-color:var(--hi-vis-color);border-radius:5px;padding-left:6px;-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button{appearance:none;margin:0}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/mixins.module.scss\",\"webpack://./src/components/slider/slider.module.scss\"],\"names\":[],\"mappings\":\"AAAA,KACI,oBAAA,CACA,oBAAA,CACA,iDAAA,CACA,iCAAA,CAEA,+CANJ,KAOQ,2BAAA,CACA,4BAAA,CAAA,CCNR,kBDWI,8EAAA,CACA,kCAAA,CCTA,8BAAA,CACA,qFAAA,CAEA,iBAAA,CACA,oCAAA,CAEA,wBAAA,CACA,uDACI,CAGJ,yBAAA,CACA,eAAA,CACA,eAAA,CACA,UAAA,CACA,UAAA,CDJA,iCACI,cAAA,CAGJ,uCACI,wBAAA,CAGJ,wCACI,yBAAA,CCFJ,wCACI,OAAA,CACA,eAAA,CACA,yBAAA,CACA,wDAAA,CAIJ,wEAEI,iBAAA,CAGJ,uCACI,uBAAA,CACA,oBAAA,CACA,WAAA,CAIA,6DACI,sEAAA,CAGJ,4DACI,sEAAA,CAKZ,mBACI,UAAA,CACA,WAAA,CACA,YAAA,CACA,aAAA,CACA,wBAAA,CACA,eAAA,CACA,WAAA,CACA,wCAAA,CACA,iCAAA,CAEA,iBAAA,CACA,gBAAA,CACA,yBAAA,CAEA,8CACI,eAAA,CACA,QAAA\",\"sourcesContent\":[\"html {\\n    --hover-scale: 1.075;\\n    --active-scale: 0.95;\\n    --scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);\\n    --scale-transition-duration: 0.2s; \\n\\n    @media (prefers-reduced-motion) OR (hover: none) { \\n        --hover-scale: 1 !important;\\n        --active-scale: 1 !important;\\n    }\\n}\\n\\n@mixin clickable {\\n    --scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);\\n    transition: var(--scale-transition);\\n\\n    &:not(:disabled) {\\n        cursor: pointer;\\n    }\\n    \\n    &:hover:not(:disabled) {\\n        scale: var(--hover-scale);\\n    }\\n    \\n    &:active:not(:disabled) {\\n        scale: var(--active-scale);\\n    }\\n}\\n\\n@mixin distortion-border($width, $color: currentColor) {\\n    position: relative;\\n    border: #{$width} solid transparent;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: 1;\\n        pointer-events: none;\\n    \\n        width: calc(100% + #{$width});\\n        height: calc(100% + #{$width});\\n        top: calc(-0.5 * #{$width});\\n        left: calc(-0.5 * #{$width});\\n        filter: var(--distortion-filter);\\n    \\n        border: solid;\\n        background-color: #0000;\\n        border-radius: inherit;\\n        border-width: #{$width};\\n        border-color: #{$color};\\n    }\\n}\\n\\n@mixin distortion-background($color:var(--background-color)) {\\n    position: relative;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: -1;\\n        top: 0;\\n        left: 0;\\n        width: 100%;\\n        height: 100%;\\n        filter: var(--distortion-filter);\\n\\n        border-radius: inherit;\\n        background-color: #{$color};\\n    }\\n}\\n\",\"@use \\\"../mixins.module.scss\\\" as mixins;\\n\\ninput[type=\\\"range\\\"] {\\n    @include mixins.clickable;\\n\\n    --track-color: var(--accent-2);\\n    --slider-color: oklch(from var(--track-color) calc(l * var(--ok-l2)) calc(c * 0.6) h);\\n\\n    border-radius: 5px;\\n    border: solid 0.2lh var(--track-color);\\n\\n    background: #0000;\\n    transition:\\n        background-color 0.3s,\\n        var(--scale-transition);\\n\\n    color: var(--slider-color);\\n    appearance: none;\\n    overflow: hidden;\\n    height: 1lh;\\n    width: 100%;\\n\\n    /* === WebKit specific styles === */\\n    &::-webkit-slider-thumb {\\n        width: 0;\\n        appearance: none;\\n        transition: color 0.3s ease;\\n        box-shadow: calc(-100vmax + 2px) 0 0 100vmax currentcolor;\\n    }\\n\\n    /* === Firefox specific styles === */\\n    &::-moz-range-track,\\n    &::-moz-range-thumb {\\n        visibility: hidden;\\n    }\\n\\n    &::-moz-range-progress {\\n        background: currentcolor;\\n        transition: color 0.3s;\\n        height: 100%;\\n    }\\n\\n    &:hover:not(:disabled) {\\n        &::-webkit-slider-thumb {\\n            color: color-mix(in oklch, var(--slider-color) 50%, var(--track-color));\\n        }\\n\\n        &::-moz-range-progress {\\n            color: color-mix(in oklch, var(--slider-color) 50%, var(--track-color));\\n        }\\n    }\\n}\\n\\ninput[type=\\\"number\\\"] {\\n    width: 100%;\\n    height: 100%;\\n    font: inherit;\\n    color: inherit;\\n    caret-color: currentColor;\\n    appearance: none;\\n    border: none;\\n    background-color: var(--background-color);\\n    outline-color: var(--hi-vis-color);\\n\\n    border-radius: 5px;\\n    padding-left: 6px;\\n    -moz-appearance: textfield;\\n\\n    &::-webkit-inner-spin-button {\\n        appearance: none;\\n        margin: 0;\\n    }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `html{--hover-scale: 1.075;--active-scale: 0.95;--scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);--scale-transition-duration: 0.2s}@media(prefers-reduced-motion)or (hover: none){html{--hover-scale: 1 !important;--active-scale: 1 !important}}.y_wWV2HJOLQpRVu3VJT9{--scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);transition:var(--scale-transition);position:absolute;right:20px;top:20px;width:5%;min-width:30px;max-width:65px;aspect-ratio:1;color:color-mix(in oklab, var(--background-color) 85%, var(--hi-vis-gray))}.y_wWV2HJOLQpRVu3VJT9:not(:disabled){cursor:pointer}.y_wWV2HJOLQpRVu3VJT9:hover:not(:disabled){scale:var(--hover-scale)}.y_wWV2HJOLQpRVu3VJT9:active:not(:disabled){scale:var(--active-scale)}.y_wWV2HJOLQpRVu3VJT9 svg{height:100%;width:100%;fill:currentColor;filter:drop-shadow(2px 2px 0 color-mix(in oklab, currentcolor 65%, var(--hi-vis-gray))) drop-shadow(-1px -1px 0 color-mix(in oklab, currentcolor 75%, var(--hi-vis-gray)))}.y_wWV2HJOLQpRVu3VJT9:hover svg{filter:drop-shadow(2px 2px 0 var(--accent-3)) drop-shadow(-1px -1px 0 var(--accent-2))}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/mixins.module.scss\",\"webpack://./src/components/viewport/fullscreen-button/fullscreen-button.module.scss\"],\"names\":[],\"mappings\":\"AAAA,KACI,oBAAA,CACA,oBAAA,CACA,iDAAA,CACA,iCAAA,CAEA,+CANJ,KAOQ,2BAAA,CACA,4BAAA,CAAA,CCNR,sBDWI,8EAAA,CACA,kCAAA,CCTA,iBAAA,CACA,UAAA,CACA,QAAA,CAEA,QAAA,CACA,cAAA,CACA,cAAA,CACA,cAAA,CAEA,0EAAA,CDEA,qCACI,cAAA,CAGJ,2CACI,wBAAA,CAGJ,4CACI,yBAAA,CCTJ,0BACI,WAAA,CACA,UAAA,CACA,iBAAA,CAEA,0KACI,CAKJ,gCACI,sFACI\",\"sourcesContent\":[\"html {\\n    --hover-scale: 1.075;\\n    --active-scale: 0.95;\\n    --scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);\\n    --scale-transition-duration: 0.2s; \\n\\n    @media (prefers-reduced-motion) OR (hover: none) { \\n        --hover-scale: 1 !important;\\n        --active-scale: 1 !important;\\n    }\\n}\\n\\n@mixin clickable {\\n    --scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);\\n    transition: var(--scale-transition);\\n\\n    &:not(:disabled) {\\n        cursor: pointer;\\n    }\\n    \\n    &:hover:not(:disabled) {\\n        scale: var(--hover-scale);\\n    }\\n    \\n    &:active:not(:disabled) {\\n        scale: var(--active-scale);\\n    }\\n}\\n\\n@mixin distortion-border($width, $color: currentColor) {\\n    position: relative;\\n    border: #{$width} solid transparent;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: 1;\\n        pointer-events: none;\\n    \\n        width: calc(100% + #{$width});\\n        height: calc(100% + #{$width});\\n        top: calc(-0.5 * #{$width});\\n        left: calc(-0.5 * #{$width});\\n        filter: var(--distortion-filter);\\n    \\n        border: solid;\\n        background-color: #0000;\\n        border-radius: inherit;\\n        border-width: #{$width};\\n        border-color: #{$color};\\n    }\\n}\\n\\n@mixin distortion-background($color:var(--background-color)) {\\n    position: relative;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: -1;\\n        top: 0;\\n        left: 0;\\n        width: 100%;\\n        height: 100%;\\n        filter: var(--distortion-filter);\\n\\n        border-radius: inherit;\\n        background-color: #{$color};\\n    }\\n}\\n\",\"@use \\\"../../mixins.module.scss\\\" as mixins;\\n\\n.fullscreen-button {\\n    @include mixins.clickable;\\n\\n    position: absolute;\\n    right: 20px;\\n    top: 20px;\\n\\n    width: 5%;\\n    min-width: 30px;\\n    max-width: 65px;\\n    aspect-ratio: 1;\\n\\n    color: color-mix(in oklab, var(--background-color) 85%, var(--hi-vis-gray));\\n\\n    svg {\\n        height: 100%;\\n        width: 100%;\\n        fill: currentColor;\\n\\n        filter:\\n            drop-shadow(2px 2px 0 color-mix(in oklab, currentcolor 65%, var(--hi-vis-gray))) \\n            drop-shadow(-1px -1px 0 color-mix(in oklab, currentcolor 75%, var(--hi-vis-gray)));\\n    }\\n\\n    &:hover {\\n        svg {\\n            filter:\\n                drop-shadow(2px 2px 0 var(--accent-3)) \\n                drop-shadow(-1px -1px 0 var(--accent-2));\\n        }\\n    }\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"fullscreen-button\": `y_wWV2HJOLQpRVu3VJT9`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `html{--hover-scale: 1.075;--active-scale: 0.95;--scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);--scale-transition-duration: 0.2s}@media(prefers-reduced-motion)or (hover: none){html{--hover-scale: 1 !important;--active-scale: 1 !important}}.hqgt3TMMzCkkoelepz55{position:relative;display:grid;grid-template-columns:minmax(4rem, auto) minmax(4rem, 0.6fr) minmax(3rem, 0.3fr);gap:.5lh 1lh;color:var(--hi-vis-gray);border-radius:10px;font-size:.7em;position:absolute;top:0;left:0;z-index:2;font-weight:600;padding:1em 1em 1em 3em}.hqgt3TMMzCkkoelepz55:before{content:\"\";position:absolute;z-index:-1;top:0;left:0;width:100%;height:100%;filter:var(--distortion-filter);border-radius:inherit;background-color:var(--secondary-color)}.hqgt3TMMzCkkoelepz55>button:not([class]){color:var(--accent-3)}.hqgt3TMMzCkkoelepz55 input[type=checkbox]{justify-self:center}.hqgt3TMMzCkkoelepz55 label{margin:auto 0 auto .5em;color:var(--accent-1);grid-column:1}.hqgt3TMMzCkkoelepz55>svg:first-child{position:absolute;padding:1rem 0 1rem .5rem;width:2rem;height:100%;cursor:grab;fill:var(--background-color)}.hqgt3TMMzCkkoelepz55:before{box-shadow:color-mix(in oklch, var(--background-color) 50%, black) 6px 6px 4px}.hqgt3TMMzCkkoelepz55.lWIZ5qssR5cpP_5U_H3j{row-gap:0}.hqgt3TMMzCkkoelepz55.lWIZ5qssR5cpP_5U_H3j>:not(button:first-of-type):not(svg:first-of-type),.hqgt3TMMzCkkoelepz55.lWIZ5qssR5cpP_5U_H3j>:not(button:first-of-type):before{border-top-width:0;border-bottom-width:0;padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;height:0;min-height:0;overflow:clip}`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/mixins.module.scss\",\"webpack://./src/components/viewport/settings-panel/settings-panel.module.scss\"],\"names\":[],\"mappings\":\"AAAA,KACI,oBAAA,CACA,oBAAA,CACA,iDAAA,CACA,iCAAA,CAEA,+CANJ,KAOQ,2BAAA,CACA,4BAAA,CAAA,CCNR,sBDoDI,iBAAA,CCjDA,YAAA,CACA,gFAAA,CAEA,YAAA,CAEA,wBAAA,CAEA,kBAAA,CACA,cAAA,CAEA,iBAAA,CACA,KAAA,CACA,MAAA,CACA,SAAA,CACA,eAAA,CAEA,uBAAA,CDmCA,6BACI,UAAA,CACA,iBAAA,CACA,UAAA,CACA,KAAA,CACA,MAAA,CACA,UAAA,CACA,WAAA,CACA,+BAAA,CAEA,qBAAA,CACA,uCAAA,CC5CJ,0CACI,qBAAA,CAGJ,2CACI,mBAAA,CAGJ,4BACI,uBAAA,CACA,qBAAA,CACA,aAAA,CAIJ,sCACI,iBAAA,CACA,yBAAA,CACA,UAAA,CACA,WAAA,CAEA,WAAA,CACA,4BAAA,CAGJ,6BACI,8EAAA,CAGJ,2CACI,SAAA,CAEA,0KAEI,kBAAA,CACA,qBAAA,CACA,aAAA,CACA,gBAAA,CACA,YAAA,CACA,eAAA,CACA,QAAA,CACA,YAAA,CACA,aAAA\",\"sourcesContent\":[\"html {\\n    --hover-scale: 1.075;\\n    --active-scale: 0.95;\\n    --scale-bezier: cubic-bezier(0.81, 0, 0.37, 3.69);\\n    --scale-transition-duration: 0.2s; \\n\\n    @media (prefers-reduced-motion) OR (hover: none) { \\n        --hover-scale: 1 !important;\\n        --active-scale: 1 !important;\\n    }\\n}\\n\\n@mixin clickable {\\n    --scale-transition: scale var(--scale-transition-duration) var(--scale-bezier);\\n    transition: var(--scale-transition);\\n\\n    &:not(:disabled) {\\n        cursor: pointer;\\n    }\\n    \\n    &:hover:not(:disabled) {\\n        scale: var(--hover-scale);\\n    }\\n    \\n    &:active:not(:disabled) {\\n        scale: var(--active-scale);\\n    }\\n}\\n\\n@mixin distortion-border($width, $color: currentColor) {\\n    position: relative;\\n    border: #{$width} solid transparent;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: 1;\\n        pointer-events: none;\\n    \\n        width: calc(100% + #{$width});\\n        height: calc(100% + #{$width});\\n        top: calc(-0.5 * #{$width});\\n        left: calc(-0.5 * #{$width});\\n        filter: var(--distortion-filter);\\n    \\n        border: solid;\\n        background-color: #0000;\\n        border-radius: inherit;\\n        border-width: #{$width};\\n        border-color: #{$color};\\n    }\\n}\\n\\n@mixin distortion-background($color:var(--background-color)) {\\n    position: relative;\\n\\n    &:before {\\n        content: '';\\n        position: absolute;\\n        z-index: -1;\\n        top: 0;\\n        left: 0;\\n        width: 100%;\\n        height: 100%;\\n        filter: var(--distortion-filter);\\n\\n        border-radius: inherit;\\n        background-color: #{$color};\\n    }\\n}\\n\",\"@use \\\"../../mixins.module.scss\\\" as mixins;\\n\\n.settings-panel {\\n    @include mixins.distortion-background(var(--secondary-color));\\n\\n    display: grid;\\n    grid-template-columns: minmax(4rem, auto) minmax(4rem, 0.6fr) minmax(3rem, 0.3fr);\\n\\n    gap: 0.5lh 1lh;\\n\\n    color: var(--hi-vis-gray);\\n\\n    border-radius: 10px;\\n    font-size: 0.7em;\\n\\n    position: absolute;\\n    top: 0;\\n    left: 0;\\n    z-index: 2;\\n    font-weight: 600;\\n\\n    padding: 1em 1em 1em 3em;\\n\\n    > button:not([class]) {\\n        color: var(--accent-3);\\n    }\\n\\n    input[type=\\\"checkbox\\\"] {\\n        justify-self: center;\\n    }\\n\\n    label {\\n        margin: auto 0 auto 0.5em;\\n        color: var(--accent-1);\\n        grid-column: 1;\\n    }\\n\\n    /* drag handle */\\n    > svg:first-child {\\n        position: absolute;\\n        padding: 1rem 0 1rem 0.5rem;\\n        width: 2rem;\\n        height: 100%;\\n\\n        cursor: grab;\\n        fill: var(--background-color);\\n    }\\n\\n    &:before {\\n        box-shadow: color-mix(in oklch, var(--background-color) 50%, black) 6px 6px 4px;\\n    }\\n\\n    &.disabled {\\n        row-gap: 0;\\n\\n        >:not(button:first-of-type):not(svg:first-of-type),\\n        >:not(button:first-of-type):before {\\n            border-top-width: 0;\\n            border-bottom-width: 0;\\n            padding-top: 0;\\n            padding-bottom: 0;\\n            margin-top: 0;\\n            margin-bottom: 0;\\n            height: 0;\\n            min-height: 0;\\n            overflow: clip;\\n        }\\n    }\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"settings-panel\": `hqgt3TMMzCkkoelepz55`,\n\t\"disabled\": `lWIZ5qssR5cpP_5U_H3j`\n};\nexport default ___CSS_LOADER_EXPORT___;\n","import blit from '../shaders/blit-vert.shader';\r\n\r\nconst label = 'tonemap pass';\r\n\r\nexport default class TonemapPass {\r\n    static readonly code = /* wgsl */`\r\n        @group(0) @binding(0) var colorTexture: texture_2d<f32>;\r\n\r\n        ${blit}\r\n\r\n        fn fitRRTAndODT(color: vec3f) -> vec3f {\r\n            let a = color * (color + 0.0245786) - 0.000090537;\r\n            let b = color * (0.983729 * color + 0.4329510) + 0.238081;\r\n            return a / b;\r\n        }\r\n\r\n        fn aces_tone_map(hdr: vec3f) -> vec3f {\r\n            const inputMat = mat3x3(\r\n                0.59719, 0.07600, 0.02840,\r\n                0.35458, 0.90834, 0.13383,\r\n                0.04823, 0.01566, 0.83777,\r\n            );\r\n            const outputMat = mat3x3(\r\n                1.60475, -0.10208, -0.00327,\r\n                -0.53108, 1.10813, -0.07276,\r\n                -0.07367, -0.00605, 1.07602,\r\n            );\r\n            const boost = 1.0 / 0.6;\r\n\r\n            var color = hdr * boost;\r\n            color = inputMat * color;\r\n            color = fitRRTAndODT(color);\r\n            color = outputMat * color;\r\n            return saturate(color);\r\n        }\r\n\r\n        fn linear_to_srgb(color: vec3f) -> vec3f {\r\n            return pow(color, vec3(1.0/2.2));\r\n        }\r\n\r\n        @fragment\r\n        fn fs(@builtin(position) pos: vec4f) -> @location(0) vec4f {\r\n            let uv = vec2<i32>(floor(pos.xy));\r\n\r\n            var color = textureLoad(colorTexture, uv, 0).rgb;\r\n            color = aces_tone_map(color);\r\n            color = linear_to_srgb(color);\r\n            return vec4f(color, 1.0);\r\n        }\r\n    `;\r\n\r\n    static readonly bindGroupLayoutDescriptor: GPUBindGroupLayoutDescriptor = {\r\n        label,\r\n        entries: [{\r\n            binding: 0,\r\n            texture: { sampleType: 'float', viewDimension: '2d' },\r\n            visibility: GPUShaderStage.FRAGMENT,\r\n        }],\r\n    };\r\n\r\n    colorAttachment: GPURenderPassColorAttachment = {\r\n        loadOp: 'load',\r\n        storeOp: 'store',\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        view: undefined!,\r\n    };\r\n\r\n    passDescriptor: GPURenderPassDescriptor = {\r\n        label,\r\n        colorAttachments: [this.colorAttachment],\r\n    };\r\n\r\n    pipeline: GPURenderPipeline;\r\n    pipelineDescriptor: GPURenderPipelineDescriptor;\r\n\r\n    renderTarget: GPUColorTargetState;\r\n    bindgroupLayout: GPUBindGroupLayout;\r\n    bindgroup?: GPUBindGroup;\r\n\r\n    constructor(\r\n        public device: GPUDevice,\r\n        format: GPUTextureFormat,\r\n    ) {\r\n        this.renderTarget = { format };\r\n        this.bindgroupLayout = device.createBindGroupLayout(TonemapPass.bindGroupLayoutDescriptor);\r\n        const module = device.createShaderModule({ label, code: TonemapPass.code });\r\n\r\n        this.pipelineDescriptor = {\r\n            label,\r\n            layout: device.createPipelineLayout({\r\n                label,\r\n                bindGroupLayouts: [this.bindgroupLayout],\r\n            }),\r\n            vertex: {\r\n                module,\r\n                entryPoint: 'vs',\r\n            },\r\n            fragment: {\r\n                module,\r\n                entryPoint: 'fs',\r\n                targets: [this.renderTarget],\r\n            },\r\n        };\r\n\r\n        this.pipeline = device.createRenderPipeline(this.pipelineDescriptor);\r\n    }\r\n\r\n    updateInput(input: GPUTextureView) {\r\n        this.bindgroup = this.device.createBindGroup({\r\n            label,\r\n            layout: this.bindgroupLayout,\r\n            entries: [{\r\n                binding: 0,\r\n                resource: input,\r\n            }],\r\n        });\r\n    }\r\n\r\n    render(encoder: GPUCommandEncoder, output: GPUTexture) {\r\n        if (this.bindgroup == null) return;\r\n\r\n        if (this.renderTarget.format !== output.format) {\r\n            this.renderTarget.format = output.format;\r\n            this.pipeline = this.device.createRenderPipeline(this.pipelineDescriptor);\r\n        }\r\n\r\n        this.colorAttachment.view = output.createView({ dimension: '2d' });\r\n\r\n        const pass = encoder.beginRenderPass(this.passDescriptor);\r\n        pass.setPipeline(this.pipeline);\r\n        pass.setBindGroup(0, this.bindgroup);\r\n        pass.draw(3);\r\n        pass.end();\r\n    }\r\n}\r\n","import GlobalUniforms from './global-uniforms';\n\nconst label = 'skybox pass';\n\nexport default class SkyboxPass {\n    static readonly code = /* wgsl */`\n        ${GlobalUniforms.code(0)}\n\n        struct SkyboxUniforms {\n            mipBias: f32,\n        };\n\n        @group(1) @binding(0) var environmentTexture: texture_cube<f32>;\n        @group(1) @binding(1) var depthTexture: texture_depth_2d;\n        @group(1) @binding(2) var environmentSampler: sampler;\n        @group(1) @binding(3) var<uniform> skyboxUniforms: SkyboxUniforms;\n\n        struct Varyings {\n            @builtin(position) position: vec4f,\n            @location(0) pos: vec4f,\n            @location(1) mipBias: f32,\n        };\n    \n        @vertex \n        fn vs(@builtin(vertex_index) vNdx: u32) -> Varyings {\n            const pos = array(\n                vec2(-1.0,  3.0),\n                vec2(-1.0, -1.0),\n                vec2( 3.0, -1.0),\n            );\n    \n            var vsOut: Varyings;\n            vsOut.position = vec4(pos[vNdx], 0.0, 1.0);\n    \n            // Ignores the camera's translation without needing a separate rotation matrix.\n            vsOut.pos = globals.inverseViewToClip * vsOut.position;\n            let w = vsOut.pos.w;\n            vsOut.pos.w = 0.0;\n            vsOut.pos = globals.inverseWorldToView * vsOut.pos;\n            vsOut.pos.w = w;\n\n            vsOut.mipBias = clamp(skyboxUniforms.mipBias, 0, f32(textureNumLevels(environmentTexture)));\n            return vsOut;\n        }\n\n        @fragment\n        fn fs(in: Varyings) -> @location(0) vec4f {\n            let dimensions = textureDimensions(depthTexture);\n            let uv = min(vec2<u32>(floor(in.position.xy)), dimensions - 1);\n            let depth = textureLoad(depthTexture, uv, 0);\n            if (depth < 1.0) { discard; }\n\n            let t = normalize(in.pos.xyz / in.pos.w);\n            let color = textureSampleLevel(environmentTexture, environmentSampler, t, in.mipBias).rgb;\n            return vec4(color, 1.0);\n        }\n    `;\n\n    bindgroupLayout: GPUBindGroupLayout;\n    pipelineLayout: GPUPipelineLayout;\n    shader: GPUShaderModule;\n\n    linearSampler: GPUSampler;\n    nearestSampler: GPUSampler;\n    textureBindgroup?: GPUBindGroup;\n\n    uniformBuffer: GPUBuffer;\n    uniformArray = new Float32Array(8);\n\n    pipeline?: GPURenderPipeline;\n\n    #skyTexture?: GPUTextureView;\n    #depthTexture?: GPUTextureView;\n    #targetFormat!: GPUTextureFormat;\n    #useNearestSample = false;\n\n    get mipLevel() { return this.uniformArray[0]; }\n    set mipLevel(val: number) {\n        if (val === this.uniformArray[0]) return;\n        this.uniformArray[0] = val;\n        this.device.queue.writeBuffer(this.uniformBuffer, 0, this.uniformArray, 0, 1);\n    }\n\n    get useNearestSample() { return this.#useNearestSample; }\n    set useNearestSample(val: boolean) {\n        if (val === this.#useNearestSample) return;\n        this.#useNearestSample = val;\n        this.#updateBindgroup();\n    }\n\n    get targetFormat() { return this.#targetFormat; }\n    set targetFormat(format: GPUTextureFormat) {\n        if (format === this.#targetFormat) return;\n        this.#targetFormat = format;\n\n        this.pipeline = this.device.createRenderPipeline({\n            label,\n            layout: this.pipelineLayout,\n            vertex: {\n                entryPoint: 'vs',\n                module: this.shader,\n            },\n            fragment: {\n                entryPoint: 'fs',\n                targets: [{ format }],\n                module: this.shader,\n            },\n        });\n    }\n\n    set skyTexture(skybox: GPUTextureView) {\n        if (skybox === this.#skyTexture) return;\n        this.#skyTexture = skybox;\n        this.#updateBindgroup();\n    }\n\n    set depthTexture(depthTexture: GPUTextureView) {\n        if (depthTexture === this.#depthTexture) return;\n        this.#depthTexture = depthTexture;\n        this.#updateBindgroup();\n    }\n\n    target: GPURenderPassColorAttachment = {\n        clearValue: { r: 0.0, g: 0.0, b: 0.0, a: 1.0 },\n        loadOp: 'clear',\n        storeOp: 'store',\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        view: undefined!,\n    };\n\n    readonly passDescriptor: GPURenderPassDescriptor = { colorAttachments: [this.target] };\n\n    constructor(\n        public device: GPUDevice,\n        public globals: GlobalUniforms,\n        targetFormat: GPUTextureFormat,\n        skybox?: GPUTextureView,\n    ) {\n        this.bindgroupLayout = device.createBindGroupLayout({\n            label,\n            entries: [\n                {\n                    binding: 0,\n                    texture: { viewDimension: 'cube' },\n                    visibility: GPUShaderStage.FRAGMENT | GPUShaderStage.VERTEX,\n                },\n                {\n                    binding: 1,\n                    texture: {\n                        viewDimension: '2d',\n                        sampleType: 'depth',\n                    },\n                    visibility: GPUShaderStage.FRAGMENT,\n                },\n                {\n                    binding: 2,\n                    visibility: GPUShaderStage.FRAGMENT,\n                    sampler: {},\n                },\n                {\n                    binding: 3,\n                    visibility: GPUShaderStage.VERTEX,\n                    buffer: { type: 'uniform' },\n                },\n            ],\n        });\n\n        this.linearSampler = device.createSampler({\n            minFilter: 'linear',\n            magFilter: 'linear',\n            mipmapFilter: 'linear',\n        });\n\n        this.nearestSampler = device.createSampler({\n            minFilter: 'nearest',\n            magFilter: 'nearest',\n            mipmapFilter: 'nearest',\n        });\n\n        this.shader = device.createShaderModule({\n            code: SkyboxPass.code,\n            label,\n        });\n\n        this.pipelineLayout = device.createPipelineLayout({\n            label,\n            bindGroupLayouts: [\n                globals.bindGroupLayout,\n                this.bindgroupLayout,\n            ],\n        });\n\n        this.uniformBuffer = device.createBuffer({\n            label,\n            size: 32,\n            usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM,\n        });\n\n        this.targetFormat = targetFormat;\n        if (skybox != null) this.skyTexture = skybox;\n    }\n\n    render(pass: GPURenderPassEncoder) {\n        if (this.textureBindgroup == null || this.pipeline == null) return false;\n        pass.setPipeline(this.pipeline);\n        pass.setBindGroup(0, this.globals.bindgroup);\n        pass.setBindGroup(1, this.textureBindgroup);\n        pass.draw(3);\n        return true;\n    }\n\n    #updateBindgroup() {\n        if (this.#skyTexture == null || this.#depthTexture == null) return;\n\n        this.textureBindgroup = this.device.createBindGroup({\n            label,\n            layout: this.bindgroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: this.#skyTexture,\n                },\n                {\n                    binding: 1,\n                    resource: this.#depthTexture,\n                },\n                {\n                    binding: 2,\n                    resource: this.useNearestSample\n                        ? this.nearestSampler\n                        : this.linearSampler,\n                },\n                {\n                    binding: 3,\n                    resource: { buffer: this.uniformBuffer },\n                },\n            ],\n        });\n    }\n}\n","type TextureData = {\n    format: GPUTextureFormat,\n    name: string,\n    clearValue?: GPUColor,\n    texture?: GPUTexture,\n    view?: GPUTextureView,\n};\n\nexport const enum GBufferGroupIndices {\n    Normal = 0,\n    Albedo,\n    Emission,\n    MetallicRoughness,\n    Depth,\n}\n\nexport default class GBuffer {\n    static readonly code = (group: number) => /* wgsl */`\n        @group(${group}) @binding(${GBufferGroupIndices.Normal}) \n        var gBufferNormal: texture_2d<f32>;\n        \n        @group(${group}) @binding(${GBufferGroupIndices.Albedo}) \n        var gBufferAlbedo: texture_2d<f32>;\n        \n        @group(${group}) @binding(${GBufferGroupIndices.Emission}) \n        var gBufferEmission: texture_2d<f32>;\n\n        @group(${group}) @binding(${GBufferGroupIndices.MetallicRoughness}) \n        var gBufferMetallicRoughness: texture_2d<f32>;\n        \n        @group(${group}) @binding(${GBufferGroupIndices.Depth})  \n        var gBufferDepth: texture_depth_2d;\n    `;\n\n    static readonly layoutDescription: GPUBindGroupLayoutDescriptor = {\n        label: 'gbuffer bind group layout',\n        entries: [\n            {\n                binding: GBufferGroupIndices.Normal,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { sampleType: 'unfilterable-float' },\n            },\n            {\n                binding: GBufferGroupIndices.Albedo,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { sampleType: 'float' },\n            },\n            {\n                binding: GBufferGroupIndices.Emission,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { sampleType: 'float' },\n            },\n            {\n                binding: GBufferGroupIndices.MetallicRoughness,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { sampleType: 'unfilterable-float' },\n            },\n            {\n                binding: GBufferGroupIndices.Depth,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { sampleType: 'depth' },\n            },\n        ],\n    };\n\n    normal = this.createTexture({\n        format: 'rgba16float',\n        name: 'normal',\n        clearValue: { r: 0, g: 0, b: 1, a: 1 },\n    });\n\n    albedo = this.createTexture({\n        format: 'rgba8unorm',\n        name: 'albedo',\n        clearValue: { r: 0, g: 0, b: 0, a: 1 },\n    });\n\n    emission = this.createTexture({\n        format: 'rgba16float',\n        name: 'emission',\n        clearValue: { r: 0, g: 0, b: 0, a: 1 },\n    });\n\n    metallicRoughness = this.createTexture({\n        format: 'rg8unorm',\n        name: 'metallic roughness',\n        clearValue: { r: 0, g: 0, b: 0, a: 0 },\n    });\n\n    depth = this.createTexture({\n        format: 'depth32float',\n        name: 'depth',\n    });\n\n    textures = [\n        this.normal,\n        this.albedo,\n        this.emission,\n        this.metallicRoughness,\n        this.depth,\n    ];\n\n    targets = this.textures.slice(0, -1).map(({ format }) => ({ format }));\n\n    bindGroupLayout = this.device.createBindGroupLayout(GBuffer.layoutDescription);\n    bindgroup = this.updateBindgroup();\n    passDescriptor = this.updatePassDescriptor();\n\n    get size() { return this._size; }\n    set size(value: GPUExtent3D) {\n        this._size = value;\n\n        this.textures.forEach((tex) => { this.createTexture(tex); });\n        this.bindgroup = this.updateBindgroup();\n        this.passDescriptor = this.updatePassDescriptor();\n    }\n\n    constructor(\n        public readonly device: GPUDevice,\n        private _size: GPUExtent3D,\n    ) { }\n\n    updateBindgroup() {\n        const entries = this.textures.map(({ view }, idx) => ({\n            binding: idx,\n            resource: view,\n        }));\n\n        return this.device.createBindGroup({\n            label: 'gbuffer bind group',\n            layout: this.bindGroupLayout,\n            entries,\n        });\n    }\n\n    updatePassDescriptor() {\n        const colorAttachments = this.textures.slice(0, -1).map(({ view, clearValue }) => ({\n            view: view,\n            clearValue: clearValue,\n            loadOp: 'clear',\n            storeOp: 'store',\n        } satisfies GPURenderPassColorAttachment));\n\n        return {\n            label: 'forward pass encoder',\n            colorAttachments,\n            depthStencilAttachment: {\n                view: this.depth.view,\n                depthLoadOp: 'clear',\n                depthStoreOp: 'store',\n                depthClearValue: 1.0,\n            },\n        } satisfies GPURenderPassDescriptor;\n    }\n\n    createTexture(tex: TextureData) {\n        const label = `gbuffer ${tex.name}`;\n        tex.texture = this.device.createTexture({\n            label,\n            size: this._size,\n            format: tex.format,\n            usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING,\n        });\n        tex.view = tex.texture.createView({ label });\n        return tex as TextureData & Required<Pick<TextureData, 'texture' | 'view'>>;\n    }\n}\n","export default /* wgsl */`\n    fn hammersley(i: u32, N: u32) -> vec2f {\n        var bits = (i << 16u) | (i >> 16u);\n        bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n        bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n        bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n        bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n        let rdi = f32(bits) * 2.3283064365386963e-10; // / 0x100000000\n        return vec2(f32(i) / f32(N), rdi);\n    }\n\n    fn tangentSampleGGX(N: vec3f, Xi: vec2f, a2: f32) -> vec3f {\n        const PI = 3.14159265359;\n\n        let phi = 2.0 * PI * Xi.x;\n        let cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a2 - 1.0) * Xi.y));\n        let sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n        \n        var H: vec3f;\n        H.x = cos(phi) * sinTheta;\n        H.y = sin(phi) * sinTheta;\n        H.z = cosTheta;\n\n        let up = select(vec3(0.0, 0.0, 1.0), vec3(1.0, 0.0, 0.0), abs(N.z) >= 0.999);\n        let T = normalize(cross(up, N));\n        let B = cross(N, T);\n\n        let S = T * H.x + B * H.y + N * H.z;\n        return normalize(S);\n    }\n\n    fn vPartLambda(NoV: f32, a2: f32) -> f32 {\n        return sqrt(NoV * NoV * (1.0 - a2) + a2);\n    }\n\n    fn vCorrelatedGGX(NoV: f32, NoL: f32, a2: f32) -> f32 {\n        let GGXV = NoL * vPartLambda(NoV, a2);\n        let GGXL = NoV * vPartLambda(NoL, a2);\n        return 0.5 / (GGXV + GGXL);\n    }\n\n    fn dS2GGX(NoH: f32, a2: f32) -> f32 {\n        let s = (a2 - 1.0) * NoH * NoH + 1.0;\n        return s * s;\n    }\n\n    fn dGGX(NoH: f32, a2: f32) -> f32 {\n        const invPI = 1.0 / 3.14159265359;\n\n        let s2 = dS2GGX(NoH, a2);\n        return invPI * select(1, a2 / s2, a2 != s2);\n    }\n`;\n","import brdfs from '../../shaders/brdfs.shader';\nimport blit from '../../shaders/blit-vert.shader';\n\nconst code = /* wgsl */ `\noverride SAMPLE_COUNT: u32 = 1024u;\n\n${blit}\n${brdfs}\n\n@fragment\nfn fs(@location(0) uv: vec2f) -> @location(0) vec4f  {\n    let NoV = uv.x;\n    let roughness = uv.y;\n    let alpha = roughness * roughness;\n    let a2 = alpha * alpha;\n    let V = vec3(sqrt(1.0 - NoV * NoV), NoV, 0.0);\n    let N = vec3(0.0, 1.0, 0.0);\n\n    var brdf = vec2(0.0);\n\n    for (var i = 0u; i < SAMPLE_COUNT; i++) {\n        let Xi = hammersley(i, SAMPLE_COUNT);\n        let H = tangentSampleGGX(N, Xi, a2);\n        let L = normalize(2.0 * dot(V, H) * H - V);\n\n        let NoL = saturate(L.y);\n        let NoH = saturate(H.y);\n        let VoH = saturate(dot(V, H));\n\n        if (NoL > 0.0) {\n            let pdf = vCorrelatedGGX(NoV, NoL, a2) * VoH * NoL / NoH;\n            let Fc = pow(1.0 - VoH, 5.0);\n            brdf += vec2(1.0 - Fc, Fc) * pdf;\n        }\n    }\n\n    return vec4f(brdf * 4.0 / f32(SAMPLE_COUNT), 0.0, 1.0);\n}\n`;\n\nexport type BfrdLutDescriptor = {\n    device: GPUDevice,\n    label?: string,\n    width?: number,\n    height?: number,\n    format?: GPUTextureFormat,\n    sampleCount?: number,\n};\n\nexport function createBfrdLut({\n    device,\n    label,\n    sampleCount,\n    width = 1024,\n    height = 1024,\n    format = 'rg32float',\n}: BfrdLutDescriptor) {\n    const bfrdLut = device.createTexture({\n        label,\n        format,\n        dimension: '2d',\n        usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING,\n        size: { width, height },\n    });\n\n    const module = device.createShaderModule({ label: 'bfrdLut shader', code });\n\n    const pipeline = device.createRenderPipeline({\n        label: 'bfrd lut pipeline',\n        layout: 'auto',\n        vertex: {\n            entryPoint: 'vs',\n            module,\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format }],\n            constants: sampleCount ? { SAMPLE_COUNT: sampleCount } : undefined,\n            module,\n        },\n    });\n\n    const encoder = device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n        label: 'brdf lut render pass',\n        colorAttachments: [{\n            view: bfrdLut.createView(),\n            loadOp: 'clear',\n            storeOp: 'store',\n        }],\n    });\n\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n\n    device.queue.submit([encoder.finish()]);\n\n    return bfrdLut;\n}\n","import { toWorldDir } from '../../shaders/cubemap-sampling.shader';\nimport brdfs from '../../shaders/brdfs.shader';\nimport blit from '../../shaders/blit-vert.shader';\nimport { createAndCopyBuffer } from '../../utils/data-copy';\n\nconst code = /* wgsl */`\n    const PI = 3.14159265359;\n\n    override SAMPLES: u32 = 2048u;\n\n    struct Params {\n        face: u32,\n        size: u32,\n    }\n\n    @group(0) @binding(0) var environment: texture_cube<f32>;\n    @group(0) @binding(1) var environmentSampler: sampler;\n    @group(0) @binding(2) var<uniform> params: Params;\n\n    ${toWorldDir}\n    ${brdfs}\n    ${blit}\n\n    @fragment\n    fn fs(@builtin(position) pos: vec4f) -> @location(0) vec4f {\n        let coord = vec3u(vec2u(floor(pos.xy)), params.face);\n        let size = f32(textureDimensions(environment).x);\n        let lodFactor = 6.0 * size * size / f32(SAMPLES);\n\n        let N = toWorldDir(coord, params.size);\n        let right = normalize(cross(vec3(0.0, 1.0, 0.0), N));\n        let up = normalize(cross(N, right));\n        let TBN = mat3x3(right, up, N);\n        \n        var irradiance = vec3(0.0);\n        var samples = 0.0;\n\n        for (var i = 0u; i < SAMPLES; i += 1) {\n            let xi = hammersley(i, SAMPLES);\n            let cosTheta = sqrt(1.0 - xi.y);\n            let sinTheta = sqrt(xi.y);\n            let phi = 2.0 * PI * xi.x;\n            let invPdf = PI / cosTheta;\n            let localDir = normalize(vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta));\n            let worldDir = TBN * localDir;\n            let lod = 0.5 * log2(lodFactor * invPdf);\n            irradiance += textureSampleLevel(environment, environmentSampler, worldDir, lod).rgb;\n        }\n\n        return vec4(irradiance / f32(SAMPLES), 1.0);\n    }\n`;\n\nexport type IrradianceTextureDescriptor = {\n    device: GPUDevice,\n    texture: GPUTexture,\n    label?: string,\n    usage?: GPUTextureUsageFlags,\n    samples?: number,\n    outputWidth?: number,\n    outputFormat?: GPUTextureFormat,\n    outputTexture?: GPUTexture,\n};\n\nexport default function createIrradianceTexture({\n    device,\n    texture,\n    label = 'irradiance',\n    usage = 0,\n    samples = 2048,\n    outputWidth,\n    outputFormat,\n    outputTexture,\n}: IrradianceTextureDescriptor) {\n    const format = outputTexture?.format ?? outputFormat ?? texture.format;\n    const width = outputTexture?.width ?? outputWidth ?? 64;\n\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { viewDimension: 'cube' },\n            },\n            {\n                binding: 1,\n                visibility: GPUShaderStage.FRAGMENT,\n                sampler: {},\n            },\n            {\n                binding: 2,\n                visibility: GPUShaderStage.FRAGMENT,\n                buffer: { type: 'uniform' },\n            },\n        ],\n    });\n\n    const sampler = device.createSampler({ minFilter: 'linear', magFilter: 'linear', mipmapFilter: 'linear' });\n\n    const irradianceTexture = outputTexture?.depthOrArrayLayers === 6\n        ? outputTexture\n        : device.createTexture({\n                label,\n                format,\n                dimension: '2d',\n                usage: GPUTextureUsage.RENDER_ATTACHMENT | usage,\n                size: { width, height: width, depthOrArrayLayers: 6 },\n            });\n\n    const params = new Uint32Array([0, irradianceTexture.width]);\n    const paramBuffer = createAndCopyBuffer(\n        params,\n        GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM,\n        device,\n    );\n\n    const bindgroup = device.createBindGroup({\n        label,\n        layout: bindgroupLayout,\n        entries: [\n            {\n                binding: 0,\n                resource: texture.createView({ dimension: 'cube' }),\n            },\n            {\n                binding: 1,\n                resource: sampler,\n            },\n            {\n                binding: 2,\n                resource: { buffer: paramBuffer },\n            },\n        ],\n    });\n\n    const pipelineLayout = device.createPipelineLayout({\n        label,\n        bindGroupLayouts: [bindgroupLayout],\n    });\n\n    const module = device.createShaderModule({ label, code });\n\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            module,\n            entryPoint: 'vs',\n        },\n        fragment: {\n            entryPoint: 'fs',\n            constants: {\n                SAMPLES: samples,\n            },\n            module,\n            targets: [{ format }],\n        },\n    });\n\n    for (let i = 0; i < 6; i += 1) {\n        params[0] = i;\n        device.queue.writeBuffer(paramBuffer, 0, params, 0, 1);\n\n        const view = irradianceTexture.createView({\n            dimension: '2d',\n            arrayLayerCount: 1,\n            baseArrayLayer: i,\n        });\n\n        const encoder = device.createCommandEncoder();\n        const pass = encoder.beginRenderPass({\n            colorAttachments: [{\n                view,\n                loadOp: 'clear',\n                storeOp: 'store',\n            }],\n        });\n\n        pass.setPipeline(pipeline);\n        pass.setBindGroup(0, bindgroup);\n        pass.draw(3);\n        pass.end();\n        device.queue.submit([encoder.finish()]);\n    }\n\n    return irradianceTexture;\n}\n","import { toWorldDir } from '../../shaders/cubemap-sampling.shader';\nimport brdfs from '../../shaders/brdfs.shader';\nimport blit from '../../shaders/blit-vert.shader';\nimport { createAndCopyBuffer } from '../../utils/data-copy';\n\nconst code = /* wgsl */`\n    override SAMPLES: u32 = 1024u;\n\n    const PI = 3.14159265359;\n    const invPI = 1.0 / PI;\n\n    struct Params {\n        face: u32,\n        mipSize: u32,\n        invOmegaP: f32,\n        a2: f32,\n    }\n\n    @group(0) @binding(0) var environment: texture_cube<f32>;\n    @group(0) @binding(1) var environmentSampler: sampler;\n    @group(0) @binding(2) var<uniform> params: Params;\n\n    ${toWorldDir}\n    ${brdfs}\n    ${blit}\n\n    @fragment\n    fn fs(@location(0) uv: vec2f) -> @location(0) vec4f {\n        let N = toWorldDirF32(uv, params.face);\n\n        var radiance = vec3(0.0);\n        var totalWeight = 0.0;\n        \n        for (var i = 0u; i < SAMPLES; i += 1) {\n            let Xi = hammersley(i, SAMPLES);\n            let H = tangentSampleGGX(N, Xi, params.a2);\n            let HoV = saturate(dot(H, N));\n            let L = normalize(2.0 * HoV * H - N);\n            let NoL = saturate(dot(N, L));\n\n            if (NoL <= 0.0) { continue; }\n\n            let pdf = dGGX(HoV, params.a2) / 4.0 + 0.001;\n            let omegaS = 1.0 / (f32(SAMPLES) * pdf);\n            let mipLevel = 0.5 * log2(omegaS * params.invOmegaP) + params.a2;\n\n            radiance += textureSampleLevel(environment, environmentSampler, L, mipLevel).rgb * NoL;\n            totalWeight += NoL;\n        }\n    \n        return vec4(radiance / totalWeight, 1.0);\n    }\n`;\n\nexport type IrradianceTextureDescriptor = {\n    device: GPUDevice,\n    texture: GPUTexture,\n    label?: string,\n    usage?: GPUTextureUsageFlags,\n    targetFormat?: GPUTextureFormat,\n    outputTexture?: GPUTexture,\n    outputWidth?: number,\n    samples?: number,\n    inPlaceMips?: boolean,\n};\n\nexport default function createRadianceTexture({\n    device,\n    texture,\n    targetFormat,\n    usage = 0,\n    label = 'radiance',\n    samples = 1024,\n    outputWidth,\n    outputTexture,\n}: IrradianceTextureDescriptor) {\n    const format = outputTexture?.format ?? targetFormat ?? texture.format;\n    const width = outputTexture?.width ?? outputWidth ?? texture.width;\n\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                visibility: GPUShaderStage.FRAGMENT,\n                texture: { viewDimension: 'cube' },\n            },\n            {\n                binding: 1,\n                visibility: GPUShaderStage.FRAGMENT,\n                sampler: {},\n            },\n            {\n                binding: 2,\n                visibility: GPUShaderStage.FRAGMENT,\n                buffer: { type: 'uniform' },\n            },\n        ],\n    });\n\n    const sampler = device.createSampler({ minFilter: 'linear', magFilter: 'linear', mipmapFilter: 'linear' });\n    const paramArrayBuffer = new ArrayBuffer(4 * 4);\n    const uintParams = new Uint32Array(paramArrayBuffer, 0, 2);\n    const floatParams = new Float32Array(paramArrayBuffer, 2 * 4, 2);\n\n    const paramBuffer = createAndCopyBuffer(\n        paramArrayBuffer,\n        GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM,\n        device,\n    );\n\n    const radianceTexture = outputTexture?.depthOrArrayLayers === 6\n        ? outputTexture\n        : device.createTexture({\n                label,\n                format,\n                dimension: '2d',\n                usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_DST | usage,\n                size: { width, height: width, depthOrArrayLayers: 6 },\n                mipLevelCount: Math.max((Math.log2(width) | 0) - 2, 1),\n            });\n\n    const copyEncoder = device.createCommandEncoder({\n        label: `${label} copy encoder`,\n    });\n\n    copyEncoder.copyTextureToTexture(\n        { texture, mipLevel: 0 },\n        { texture: radianceTexture, mipLevel: 0 },\n        { width, height: width, depthOrArrayLayers: 6 },\n    );\n    device.queue.submit([copyEncoder.finish()]);\n\n    const pipelineLayout = device.createPipelineLayout({\n        label,\n        bindGroupLayouts: [bindgroupLayout],\n    });\n\n    const module = device.createShaderModule({ label, code });\n\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            module,\n            entryPoint: 'vs',\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format: radianceTexture.format }],\n            constants: {\n                SAMPLES: samples,\n            },\n            module,\n        },\n    });\n\n    floatParams[0] = (6 * texture.width * texture.width) / (4 * Math.PI);\n\n    void Promise.resolve().then(async () => {\n        const bindgroup = device.createBindGroup({\n            label,\n            layout: bindgroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: texture.createView({ dimension: 'cube' }),\n                },\n                {\n                    binding: 1,\n                    resource: sampler,\n                },\n                {\n                    binding: 2,\n                    resource: { buffer: paramBuffer },\n                },\n            ],\n        });\n\n        for (let mip = 1; mip < radianceTexture.mipLevelCount; mip += 1) {\n            const roughness = mip / (radianceTexture.mipLevelCount - 1);\n            floatParams[1] = roughness ** 4;\n            uintParams[1] = (radianceTexture.width >> mip) | 0;\n\n            for (let face = 0; face < 6; face += 1) {\n                await device.queue.onSubmittedWorkDone();\n                uintParams[0] = face;\n                device.queue.writeBuffer(paramBuffer, 0, paramArrayBuffer);\n\n                const view = radianceTexture.createView({\n                    dimension: '2d',\n                    arrayLayerCount: 1,\n                    baseArrayLayer: face,\n                    mipLevelCount: 1,\n                    baseMipLevel: mip,\n                });\n\n                const encoder = device.createCommandEncoder();\n                const pass = encoder.beginRenderPass({\n                    colorAttachments: [{\n                        view,\n                        loadOp: 'clear',\n                        storeOp: 'store',\n                    }],\n                });\n\n                pass.setPipeline(pipeline);\n                pass.setBindGroup(0, bindgroup);\n                pass.draw(3);\n                pass.end();\n                device.queue.submit([encoder.finish()]);\n            }\n        }\n    });\n\n    return radianceTexture;\n}\n","import GBuffer from './gbuffer';\nimport brdfs from '../shaders/brdfs.shader';\nimport blit from '../shaders/blit-vert.shader';\nimport GlobalUniforms from './global-uniforms';\nimport { createBfrdLut } from './ibl-textures/create-bfrd-lut';\nimport createIrradianceTexture from './ibl-textures/create-irradiance-texture';\nimport createRadianceTexture from './ibl-textures/create-radiance-texture';\n\nexport default class DeferredPass {\n    static readonly code = /* wgsl */`\n        ${GlobalUniforms.code(0)}\n        ${GBuffer.code(1)}\n\n        @group(2) @binding(0) var radianceTexture: texture_cube<f32>;\n        @group(2) @binding(1) var irradianceTexture: texture_cube<f32>;\n        @group(2) @binding(2) var brdfTexture: texture_2d<f32>;\n        @group(2) @binding(3) var generalSampler: sampler;\n\n        ${brdfs}\n        ${blit}\n\n        @fragment\n        fn fs(@builtin(position) pos: vec4f, @location(0) uv: vec2f) -> @location(0) vec4f {\n            let uvi = vec2<u32>(pos.xy);\n            let depth = textureLoad(gBufferDepth, uvi, 0);\n\n            if (depth >= 1.0) { discard; }\n\n            let uvClip = vec2(uv.x * 2.0 - 1.0, 1.0 - uv.y * 2.0);\n            let clipPos = vec4(uvClip, depth, 1.0);\n            let viewPos = globals.inverseViewToClip * clipPos;\n            let worldDir = globals.inverseWorldToView * vec4(viewPos.xyz / viewPos.w, 0.0);\n            let view = -normalize(worldDir.xyz);\n\n            let normal = textureLoad(gBufferNormal, uvi, 0).rgb;\n            let albedo = textureLoad(gBufferAlbedo, uvi, 0).rgb;\n            let emission = textureLoad(gBufferEmission, uvi, 0).rgb;\n            let metallicRoughnessSample = textureLoad(gBufferMetallicRoughness, uvi, 0);\n            let metallic = metallicRoughnessSample.r;\n            let roughness = metallicRoughnessSample.g;\n            let alpha = roughness * roughness;\n            let a2 = alpha * alpha;\n\n            let NoV = saturate(dot(normal, view));\n            let F0 = mix(vec3f(0.04), albedo, metallic);\n            let R = reflect(-view, normal);\n\n            let level = roughness * f32(textureNumLevels(radianceTexture) - 1u);\n            let radiance = textureSampleLevel(radianceTexture, generalSampler, R, level).rgb;\n            let irradiance = textureSample(irradianceTexture, generalSampler, normal).rgb;\n            let brdf = textureSample(brdfTexture, generalSampler, saturate(vec2f(NoV, roughness))).xy;\n\n            // Roughness dependent fresnel\n            let Fr = max(vec3f(1.0 - roughness), F0) - F0;\n            let kS = F0 + Fr * pow(1.0 - NoV, 5.0);\n            let FssEss = kS * brdf.x + brdf.y;\n\n            // Multiple scattering, originally proposed by Fdez-Aguera\n            // and here adapted from https://bruop.github.io/ibl\n            let Ems = 1.0 - (brdf.x + brdf.y);\n            let Favg = F0 + (1.0 - F0) / 21.0;\n            let FmsEms = Ems * FssEss * Favg / (1.0 - Favg * Ems);\n            let kD = albedo * (1.0 - 0.04) * (1.0 - metallic) * (1.0 - FssEss + FmsEms);\n\n            let specular = FssEss * radiance;\n            let diffuse = (FmsEms + kD) * irradiance;\n            let ambient = specular + diffuse + emission;\n\n            return vec4f(ambient, 1.0);\n        }\n    `;\n\n    target: GPURenderPassColorAttachment = {\n        view: undefined!, // eslint-disable-line @typescript-eslint/no-non-null-assertion\n        clearValue: { r: 0, g: 0, b: 0, a: 1 },\n        loadOp: 'clear',\n        storeOp: 'store',\n    };\n\n    bfrdLut = createBfrdLut({ device: this.device });\n    bfrdLutView = this.bfrdLut.createView();\n\n    irradianceTexture?: GPUTexture;\n    irradianceView?: GPUTextureView;\n    radianceTexture?: GPUTexture;\n    radianceView?: GPUTextureView;\n    bindgroup?: GPUBindGroup;\n\n    sampler: GPUSampler;\n    pipeline: GPURenderPipeline;\n    bindgroupLayout: GPUBindGroupLayout;\n\n    readonly passDescriptor: GPURenderPassDescriptor = { colorAttachments: [this.target] };\n\n    set skybox(texture: GPUTexture) {\n        this.irradianceTexture = createIrradianceTexture({\n            texture,\n            device: this.device,\n            usage: GPUTextureUsage.TEXTURE_BINDING,\n        });\n\n        this.radianceTexture = createRadianceTexture({\n            texture,\n            device: this.device,\n            usage: GPUTextureUsage.TEXTURE_BINDING,\n        });\n\n        this.irradianceView = this.irradianceTexture.createView({ dimension: 'cube' });\n        this.radianceView = this.radianceTexture.createView({ dimension: 'cube' });\n\n        this.bindgroup = this.device.createBindGroup({\n            layout: this.bindgroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: this.radianceView,\n                },\n                {\n                    binding: 1,\n                    resource: this.irradianceView,\n                },\n                {\n                    binding: 2,\n                    resource: this.bfrdLutView,\n                },\n                {\n                    binding: 3,\n                    resource: this.sampler,\n                },\n            ],\n        });\n    }\n\n    constructor(public device: GPUDevice, public globals: GlobalUniforms, public gbuffer: GBuffer, format: GPUTextureFormat, skybox?: GPUTexture) {\n        this.sampler = device.createSampler({ magFilter: 'linear', minFilter: 'linear', mipmapFilter: 'linear' });\n\n        if (skybox != null) this.skybox = skybox;\n\n        this.bindgroupLayout = device.createBindGroupLayout({\n            label: 'deferred pass',\n            entries: [\n                {\n                    binding: 0,\n                    visibility: GPUShaderStage.FRAGMENT,\n                    texture: { viewDimension: 'cube' },\n                },\n                {\n                    binding: 1,\n                    visibility: GPUShaderStage.FRAGMENT,\n                    texture: { viewDimension: 'cube' },\n                },\n                {\n                    binding: 2,\n                    visibility: GPUShaderStage.FRAGMENT,\n                    texture: { viewDimension: '2d' },\n                },\n                {\n                    binding: 3,\n                    visibility: GPUShaderStage.FRAGMENT,\n                    sampler: {},\n                },\n            ],\n        });\n\n        const layout = device.createPipelineLayout({\n            label: 'deferred pass bindgroup layout',\n            bindGroupLayouts: [\n                this.globals.bindGroupLayout,\n                this.gbuffer.bindGroupLayout,\n                this.bindgroupLayout,\n            ],\n        });\n\n        const module = device.createShaderModule({ code: DeferredPass.code, label: 'deferred pass shader' });\n\n        this.pipeline = device.createRenderPipeline({\n            layout,\n            vertex: {\n                entryPoint: 'vs',\n                module,\n            },\n            fragment: {\n                entryPoint: 'fs',\n                targets: [{ format }],\n                module,\n            },\n        });\n    }\n\n    render(pass: GPURenderPassEncoder) {\n        if (this.bindgroup == null) return;\n        pass.setPipeline(this.pipeline);\n        pass.setBindGroup(0, this.globals.bindgroup);\n        pass.setBindGroup(1, this.gbuffer.bindgroup);\n        pass.setBindGroup(2, this.bindgroup);\n        pass.draw(3);\n    }\n}\n","import Camera from './camera/camera';\nimport GlobalUniforms from './global-uniforms';\nimport TonemapPass from './tonemap-pass';\nimport SkyboxPass from './skybox-pass';\nimport GBuffer from './gbuffer';\nimport DeferredPass from './deferred-pass';\n\nimport { binaryInsert, debounce } from '../../utils/general';\n\nexport type ForwardPassParams = {\n    encoder: GPUCommandEncoder,\n    globals: GlobalUniforms,\n    gbuffer: GBuffer,\n};\n\nexport type ForwardPass = {\n    render: (params: ForwardPassParams) => void,\n    priority: number,\n};\n\nexport default class Renderer {\n    static readonly requiredFeatures: GPUFeatureName[] = ['float32-filterable'];\n    static readonly outputFormat: GPUTextureFormat = navigator.gpu.getPreferredCanvasFormat();\n    static readonly postProcessFormat: GPUTextureFormat = 'rgba32float';\n\n    colorAttachment: GPURenderPassColorAttachment = {\n        clearValue: { r: 0, g: 0, b: 0, a: 1 },\n        loadOp: 'clear',\n        storeOp: 'store',\n        view: undefined!, // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    };\n\n    passDescriptor: GPURenderPassDescriptor = { colorAttachments: [this.colorAttachment] };\n\n    context: GPUCanvasContext;\n    camera: Camera;\n    globals: GlobalUniforms;\n    gbuffer: GBuffer;\n\n    forwardPasses: ForwardPass[] = [];\n    deferredPass: DeferredPass;\n    skyboxPass: SkyboxPass;\n    tonemapPass: TonemapPass;\n\n    postprocessTarget!: GPUTexture;\n\n    set skybox(texture: GPUTexture) {\n        this.deferredPass.skybox = texture;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.skyboxPass.skyTexture = this.deferredPass.radianceView!;\n    }\n\n    constructor(\n        public readonly canvas: HTMLCanvasElement,\n        public readonly device: GPUDevice,\n    ) {\n        const size = { width: this.canvas.width, height: this.canvas.height };\n        this.camera = new Camera(size);\n        this.globals = new GlobalUniforms(this.device);\n        this.gbuffer = new GBuffer(device, size);\n        this.deferredPass = new DeferredPass(device, this.globals, this.gbuffer, Renderer.postProcessFormat);\n\n        this.skyboxPass = new SkyboxPass(\n            this.device,\n            this.globals,\n            Renderer.postProcessFormat,\n        );\n        this.tonemapPass = new TonemapPass(this.device, Renderer.outputFormat);\n\n        const context = this.canvas.getContext('webgpu');\n        if (context == null) throw new Error('renderer -- given canvas already initialized to non-webgpu context');\n\n        this.context = context as unknown as GPUCanvasContext;\n\n        this.context.configure({\n            device: this.device,\n            format: Renderer.outputFormat,\n            usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n            alphaMode: 'opaque',\n            colorSpace: 'srgb',\n        });\n\n        this.updateBackings(size);\n        this.#createResizeObserver();\n    }\n\n    static async CreateInitialized(canvas: HTMLCanvasElement): Promise<Renderer> {\n        const adapter = await navigator.gpu.requestAdapter();\n        if (adapter == null) {\n            throw new Error('Could not initialize GPU.');\n        }\n\n        const {\n            maxComputeWorkgroupSizeX,\n            maxComputeWorkgroupsPerDimension,\n            maxComputeInvocationsPerWorkgroup,\n        } = adapter.limits;\n\n        const device = await adapter.requestDevice({\n            label: 'main logical device',\n            requiredFeatures: Renderer.requiredFeatures,\n            requiredLimits: {\n                maxComputeWorkgroupSizeX,\n                maxComputeWorkgroupsPerDimension,\n                maxComputeInvocationsPerWorkgroup,\n            },\n        });\n\n        return new Renderer(canvas, device);\n    }\n\n    updateBackings(size: { width: number, height: number }) {\n        this.camera.updateParams(size);\n        this.postprocessTarget = this.device.createTexture({\n            dimension: '2d',\n            format: Renderer.postProcessFormat,\n            usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING,\n            size,\n        });\n\n        this.colorAttachment.view = this.postprocessTarget.createView();\n        this.tonemapPass.updateInput(this.colorAttachment.view);\n        this.gbuffer.size = size;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.skyboxPass.depthTexture = this.gbuffer.depth.view!;\n    }\n\n    #createResizeObserver() {\n        const resizeCanvas = debounce((rawWidth: number, rawHeight: number) => {\n            const width = Math.max(1, Math.min(rawWidth | 0, this.device.limits.maxTextureDimension2D));\n            const height = Math.max(1, Math.min(rawHeight | 0, this.device.limits.maxTextureDimension2D));\n            const dimensions = { width, height };\n            this.canvas.width = width;\n            this.canvas.height = height;\n            this.updateBackings(dimensions);\n        }, 20);\n\n        try {\n            const observer = new ResizeObserver((entries) => {\n                const [{ inlineSize, blockSize }] = entries[entries.length - 1].devicePixelContentBoxSize;\n                resizeCanvas(inlineSize, blockSize);\n            });\n            observer.observe(this.canvas, { box: 'device-pixel-content-box' });\n        } catch {\n            // Safari doesn't support device-pixel-content-box, so it would fail into this.\n            const observer = new ResizeObserver((entries) => {\n                const [{ inlineSize, blockSize }] = entries[entries.length - 1].contentBoxSize;\n                resizeCanvas(inlineSize * devicePixelRatio, blockSize * devicePixelRatio);\n            });\n            observer.observe(this.canvas, { box: 'content-box' });\n        }\n    }\n\n    addForwardPass(forwardPass: ForwardPass) {\n        binaryInsert(this.forwardPasses, forwardPass, (a, b) => a.priority - b.priority);\n    }\n\n    render = () => {\n        requestAnimationFrame(this.render);\n\n        this.globals.updateDeviceBuffer(this.device.queue, this.camera);\n\n        const encoder = this.device.createCommandEncoder({ label: 'main render encoder' });\n        const forwardPassParams = { encoder, globals: this.globals, gbuffer: this.gbuffer };\n\n        for (const forwardPass of this.forwardPasses) {\n            forwardPass.render(forwardPassParams);\n        }\n\n        const pass = encoder.beginRenderPass(this.passDescriptor);\n        this.deferredPass.render(pass);\n        this.skyboxPass.render(pass);\n        pass.end();\n\n        this.tonemapPass.render(encoder, this.context.getCurrentTexture());\n\n        this.device.queue.submit([encoder.finish()]);\n    };\n}\n","\n      import API from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./button.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./button.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import DistortComponent from 'react-distortion';\r\nimport { ComponentPropsWithoutRef, Ref } from 'react';\r\n\r\nimport './button.module.scss';\r\nimport { interactiveDisabledFilters } from '../distortion-styles';\r\n\r\nexport default function Button(props: ComponentPropsWithoutRef<'button'> & { forwardedRef?: Ref<HTMLButtonElement> }) {\r\n    return (\r\n        <DistortComponent\r\n            as=\"button\"\r\n            type=\"button\"\r\n            {...interactiveDisabledFilters}\r\n            {...props}\r\n        />\r\n    );\r\n};\r\n","\n      import API from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./select.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./select.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { CSSProperties } from 'react';\n\nimport './select.module.scss';\n\nexport type SelectProps<T extends object> = {\n    label: string,\n    items: T,\n    defaultSelected?: string,\n    style?: CSSProperties,\n    onChange?: (value: T[keyof T]) => void,\n};\n\nexport function Select<T extends Record<string, unknown>>({\n    label,\n    items,\n    onChange,\n    defaultSelected,\n    style,\n}: SelectProps<T>) {\n    return (\n        <select\n            style={style}\n            aria-label={label}\n            disabled={Object.keys(items).length <= 1}\n            onChange={(e) => { onChange?.(items[e.target.value] as T[keyof T]); }}\n        >\n            {Object.keys(items).map((key) => (\n                <option\n                    defaultChecked={key === defaultSelected}\n                    value={key}\n                    key={key}\n                >\n                    {key}\n                </option>\n            ))}\n        </select>\n    );\n}\n","import { useEffect, useRef, useState } from 'react';\r\n\r\nimport type { ValueKeyCallback } from '../../rendering/samples/settings/property-listener';\r\n\r\nimport Button from '../button/button';\r\nimport { Select } from '../select/select';\r\n\r\nexport type FileUploadProps<T> = {\r\n    label: string,\r\n    accept?: string,\r\n    buttonText?: string,\r\n    process: (file: File) => T,\r\n    onChange?: ((value: T) => void),\r\n    value?: string,\r\n    initialValues?: Record<string, T>,\r\n    callbacks?: Set<ValueKeyCallback<FileUploadProps<T>>>,\r\n};\r\n\r\nexport default function FileUpload<T>({\r\n    label,\r\n    process,\r\n    buttonText,\r\n    accept,\r\n    onChange,\r\n    value,\r\n    initialValues,\r\n    callbacks,\r\n}: FileUploadProps<T>) {\r\n    const inputRef = useRef<null | HTMLInputElement>(null);\r\n    const [files, setFiles] = useState(initialValues ?? {});\r\n\r\n    useEffect(() => {\r\n        if (value == null) return;\r\n        onChange?.(files[value]);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        function update<K extends keyof FileUploadProps<T>>(changed: FileUploadProps<T>[K], key: K) {\r\n            if (changed == null) return;\r\n            if (key === 'initialValues') {\r\n                const newValues = changed as NonNullable<FileUploadProps<T>['initialValues']>;\r\n                setFiles((files) => ({ ...files, ...newValues }));\r\n            }\r\n        };\r\n\r\n        callbacks?.add(update);\r\n        return () => { callbacks?.delete(update); };\r\n    }, [callbacks]);\r\n\r\n    return (\r\n        <>\r\n            <label style={{ gridRow: 'span 2' }}>{label}</label>\r\n            <Select\r\n                label={`${label} select`}\r\n                style={{ gridColumn: 'span 2' }}\r\n                items={files}\r\n                defaultSelected={value}\r\n                onChange={(value) => { onChange?.(value); }}\r\n            />\r\n            <Button\r\n                onClick={() => { inputRef.current?.click(); }}\r\n                style={{ fontStretch: '100%', gridColumn: 'span 2' }}\r\n            >\r\n                {buttonText ?? `Upload ${accept ?? 'file'}`}\r\n                <input\r\n                    type=\"file\"\r\n                    style={{ display: 'none' }}\r\n                    ref={inputRef}\r\n                    accept={accept}\r\n                    onInput={(e) => {\r\n                        const file = e.currentTarget.files?.[0];\r\n                        if (file == null) return;\r\n                        setFiles((files) => ({ ...files, [file.name]: process(file) }));\r\n                    }}\r\n                />\r\n            </Button>\r\n        </>\r\n    );\r\n}\r\n","import { useEffect, useRef, useState } from 'react';\nimport Distortion, { DistortHandle } from 'react-distortion';\n\nexport function useTooltip(content?: string, id?: string) {\n    const distortionRef = useRef<DistortHandle>(null);\n    const [shown, setShown] = useState(false);\n\n    const tooltip = content != null\n        ? (\n                <Distortion\n                    id={id}\n                    role=\"tooltip\"\n                    defaultFilter={{\n                        scale: 10,\n                        disable: true,\n                    }}\n                    ref={distortionRef}\n                >\n                    {content}\n                </Distortion>\n            )\n        : undefined;\n\n    const show = () => { setShown(true); };\n\n    const hide = () => {\n        setShown(false);\n        distortionRef.current?.refreshSeed();\n    };\n\n    return [shown ? tooltip : undefined, show, hide] as const;\n}\n\nexport function useRerenderEffect(fn: () => void, deps: unknown[]) {\n    const isMountingRef = useRef(false);\n\n    useEffect(() => { isMountingRef.current = true; }, []);\n\n    useEffect(() => {\n        if (!isMountingRef.current) {\n            fn();\n        } else {\n            isMountingRef.current = false;\n        }\n    }, deps);\n}\n","\n      import API from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./checkbox.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./checkbox.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { ChangeEvent, useState, useId, useEffect } from 'react';\r\nimport Distortion from 'react-distortion';\r\n\r\nimport type { ValueKeyCallback } from '../../rendering/samples/settings/property-listener';\r\nimport { useTooltip } from '../../utils/hooks';\r\n\r\nimport './checkbox.module.scss';\r\nimport { interactiveFilters } from '../distortion-styles';\r\n\r\nexport type CheckboxProps = {\r\n    label: string,\r\n    value?: boolean,\r\n    disabled?: boolean,\r\n    description?: string,\r\n    onChange?: (val: boolean) => void,\r\n    callbacks?: Pick<Set<ValueKeyCallback<CheckboxProps>>, 'add' | 'delete'>,\r\n};\r\n\r\nexport default function Checkbox({\r\n    label,\r\n    onChange: callback = () => {},\r\n    value: propVal,\r\n    disabled,\r\n    callbacks,\r\n    description,\r\n}: CheckboxProps) {\r\n    const id = useId();\r\n    const [value, setValue] = useState(propVal);\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setValue(e.target.checked);\r\n        callback(e.target.checked);\r\n    };\r\n\r\n    const update = (val: unknown) => {\r\n        if (typeof val === 'boolean' && val !== value) setValue(val);\r\n    };\r\n\r\n    useEffect(() => {\r\n        callbacks?.add(update);\r\n        return () => { callbacks?.delete(update); };\r\n    });\r\n\r\n    const [tooltip, show, hide] = useTooltip(description);\r\n\r\n    return (\r\n        <>\r\n            <label\r\n                style={{ position: 'relative' }}\r\n                htmlFor={id}\r\n                onMouseEnter={show}\r\n                onMouseLeave={hide}\r\n            >\r\n                {label}\r\n                {tooltip}\r\n            </label>\r\n            <Distortion\r\n                as=\"input\"\r\n                disabled={disabled}\r\n                type=\"checkbox\"\r\n                aria-label={label}\r\n                checked={value}\r\n                onChange={handleChange}\r\n                id={id}\r\n                {...(disabled ? {} : interactiveFilters)}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","\n      import API from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./slider.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./slider.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { ChangeEvent, useState, useId, useEffect, useRef, useCallback } from 'react';\r\n\r\nimport Distortion, { DistortHandle } from 'react-distortion';\r\nimport { useRerenderEffect, useTooltip } from '../../utils/hooks';\r\n\r\nimport { clamp } from '../../utils/general';\r\nimport { ValueKeyCallback } from '../../rendering/samples/settings/property-listener';\r\n\r\nimport './slider.module.scss';\r\nimport { interactiveFilters } from '../distortion-styles';\r\n\r\nexport type SliderState = {\r\n    min: number,\r\n    max: number,\r\n    step: number,\r\n    value: number,\r\n};\r\n\r\nexport type SliderProps = {\r\n    label: string,\r\n    onChange?: (val: number) => void,\r\n    callbacks?: Set<ValueKeyCallback<SliderProps>>,\r\n    description?: string,\r\n    disabled?: boolean,\r\n} & Partial<SliderState>;\r\n\r\nexport default function Slider({\r\n    label,\r\n    onChange: callback,\r\n    min = 0,\r\n    max = 10,\r\n    step = 1,\r\n    value = 5,\r\n    disabled,\r\n    description,\r\n    callbacks,\r\n}: SliderProps) {\r\n    const id = useId();\r\n    const [sliderState, setSliderState] = useState({ min, max, step, value });\r\n    const [tooltip, showTooltip, hideTooltip] = useTooltip(description);\r\n    const distortionRef = useRef<DistortHandle>(null);\r\n\r\n    const onChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        let newVal = e.target.value !== '' ? parseFloat(e.target.value) : sliderState.min;\r\n        newVal = clamp(newVal, sliderState.min, sliderState.max);\r\n\r\n        setSliderState((current) => newVal === current.value\r\n            ? current\r\n            : { ...current, value: newVal });\r\n    }, [sliderState.min, sliderState.max]);\r\n\r\n    useEffect(() => {\r\n        if (callbacks == null) return undefined;\r\n\r\n        function update<K extends keyof SliderProps>(val: SliderProps[K], key: K) {\r\n            if (key !== 'max' && key !== 'min' && key !== 'value' && key !== 'step') return;\r\n\r\n            setSliderState(\r\n                (current) => current[key as keyof SliderState] !== val\r\n                    ? { ...current, [key]: val }\r\n                    : current,\r\n            );\r\n        };\r\n\r\n        callbacks.add(update);\r\n        return () => { callbacks.delete(update); };\r\n    });\r\n\r\n    useRerenderEffect(() => {\r\n        callback?.(sliderState.value);\r\n        distortionRef.current?.refreshSeed();\r\n    }, [sliderState.value]);\r\n\r\n    return (\r\n        <>\r\n            <label\r\n                style={{ position: 'relative' }}\r\n                htmlFor={id}\r\n                onMouseEnter={showTooltip}\r\n                onMouseLeave={hideTooltip}\r\n            >\r\n                {label}\r\n                {tooltip}\r\n            </label>\r\n            <Distortion\r\n                as=\"input\"\r\n                type=\"range\"\r\n                aria-label={`${label}-slider`}\r\n                aria-description={description}\r\n                disabled={disabled}\r\n                onChange={onChange}\r\n                ref={distortionRef}\r\n                minRefresh={200}\r\n                {...(disabled ? {} : interactiveFilters)}\r\n                {...sliderState}\r\n            />\r\n            <Distortion\r\n                as=\"input\"\r\n                type=\"number\"\r\n                id={id}\r\n                aria-label={`${label}-text-input`}\r\n                aria-description={description}\r\n                disabled={disabled}\r\n                onChange={onChange}\r\n                defaultFilter={{\r\n                    scale: 7,\r\n                    disable: true,\r\n                }}\r\n                {...sliderState}\r\n            />\r\n        </>\r\n    );\r\n}\r\n","\n      import API from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./settings-panel.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./settings-panel.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { useId, useRef, useState } from 'react';\r\nimport Draggable from 'react-draggable';\r\n\r\nimport StyledButton from '../../button/button';\r\nimport Distortion, { DistortHandle } from 'react-distortion';\r\n\r\nimport styles from './settings-panel.module.scss';\r\n\r\nexport default function SettingsPanel({ children }: { children?: React.ReactNode }) {\r\n    const handleId = useId();\r\n    const nodeRef = useRef<HTMLDivElement>(null);\r\n    const distortionRef = useRef<DistortHandle>(null);\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n    const [isOpen, setIsOpen] = useState(true);\r\n\r\n    return (\r\n        <Draggable\r\n            handle={`#${CSS.escape(handleId)}`}\r\n            onDrag={() => distortionRef.current?.refreshSeed()}\r\n            bounds=\"parent\"\r\n            nodeRef={nodeRef as { current: NonNullable<typeof nodeRef.current> }}\r\n        >\r\n            <Distortion\r\n                ref={distortionRef}\r\n                forwardedRef={nodeRef}\r\n                className={`${styles['settings-panel']} ${isOpen ? '' : styles.disabled}`}\r\n                defaultFilter={{\r\n                    scale: 7,\r\n                    disable: true,\r\n                }}\r\n                minRefresh={600}\r\n            >\r\n                <svg id={handleId}>\r\n                    <defs>\r\n                        <pattern id=\"grab-handle\" patternUnits=\"userSpaceOnUse\"x=\"0\" y=\"0\" width=\"100%\" height=\"5\">\r\n                            <circle cx=\"33%\" cy=\"2.5\" r=\"2\"></circle>\r\n                            <circle cx=\"66%\" cy=\"2.5\" r=\"2\"></circle>\r\n                        </pattern>\r\n                    </defs>\r\n                    <rect x=\"0\" y=\"0\" fill=\"url(#grab-handle)\" width=\"100%\" height=\"100%\" />\r\n                </svg>\r\n                <StyledButton\r\n                    forwardedRef={buttonRef}\r\n                    style={{ gridColumn: 'span 3' }}\r\n                    onClick={() => { setIsOpen((open) => !open); }}\r\n                >\r\n                    {isOpen ? 'Hide Options' : 'Show Options'}\r\n                </StyledButton>\r\n                {children}\r\n            </Distortion>\r\n        </Draggable>\r\n    );\r\n}\r\n","import { ComponentProps, CSSProperties } from 'react';\r\n\r\nimport FileUpload, { FileUploadProps } from '../file-upload/file-upload';\r\nimport Checkbox, { CheckboxProps } from '../checkbox/checkbox';\r\nimport Slider, { SliderProps } from '../slider/slider';\r\nimport StyledButton from '../button/button';\r\n\r\nimport { ModelSetting } from '../../rendering/samples/settings/sample-spec';\r\nimport { ListenerSyms } from '../../rendering/samples/settings/property-listener';\r\nimport SettingsPanel from './settings-panel/settings-panel';\r\n\r\nexport default function ModelSettingsWidget(settings: Record<string, ModelSetting>) {\r\n    return (\r\n        <SettingsPanel>\r\n            {Object.entries(settings).map(([label, info]) => {\r\n                const {\r\n                    [ListenerSyms.$type]: type,\r\n                    [ListenerSyms.$listeners]: callbacks,\r\n                    ...rest\r\n                } = info;\r\n\r\n                const props = {\r\n                    ...rest,\r\n                    callbacks,\r\n                    label,\r\n                    onChange: (val: ModelSetting['value']) => { info.value = val; },\r\n                };\r\n\r\n                switch (type) {\r\n                    case 'button': return (\r\n                        <StyledButton\r\n                            key={label}\r\n                            style={{\r\n                                gridColumn: 'span 3',\r\n                                color: 'var(--accent-2)',\r\n                                '--border-color': 'var(--accent-2)',\r\n                            } as CSSProperties}\r\n                            {...rest as ComponentProps<typeof StyledButton>}\r\n                        >\r\n                            {label}\r\n                        </StyledButton>\r\n                    );\r\n                    case 'checkbox': return <Checkbox key={label} {...props as CheckboxProps} />;\r\n                    case 'slider': return <Slider key={label} {...props as SliderProps} />;\r\n                    case 'file': return <FileUpload key={label} {...props as FileUploadProps<unknown>} />;\r\n                    default: throw new Error();\r\n                }\r\n            })}\r\n        </SettingsPanel>\r\n    );\r\n}\r\n","\n      import API from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/.pnpm/style-loader@4.0.0_webpack@5.97.1/node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./fullscreen-button.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.97.1/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!../../../../node_modules/.pnpm/sass-loader@16.0.4_sass@1.83.4_webpack@5.97.1/node_modules/sass-loader/dist/cjs.js!./fullscreen-button.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { useEffect, useState, RefObject } from 'react';\r\nimport Distortion from 'react-distortion';\r\n\r\nimport styles from './fullscreen-button.module.scss';\r\nimport { interactiveConditionalFilters } from '../../distortion-styles';\r\n\r\nexport type FullscreenButtonProps = { element?: RefObject<HTMLElement | null> };\r\n\r\nconst ARROW_ID = 'arrow';\r\nconst ARROW_HREF = `#${ARROW_ID}`;\r\n\r\nconst ARROW_PATH = `\r\n    M 7.71 6.24 \r\n    L 4.42 2.97 \r\n    L 5.71 1.69 \r\n    A 1 1 0 0 0 5 -0.01 \r\n    H 1 \r\n    A 1 1 0 0 0 0 0.98 \r\n    V 4.95 \r\n    A 1 1 0 0 0 1.71 5.66 \r\n    L 3 4.38 \r\n    L 6.29 7.64 \r\n    A 1 1 0 0 0 7.71 6.23 \r\n    Z\r\n`.replaceAll(/\\s*([A-Z])\\s*/g, '$1');\r\n\r\nconst openArrows = (\r\n    <>\r\n        <use href={ARROW_HREF} transform=\"translate(10 10)\" />\r\n        <use href={ARROW_HREF} transform=\"rotate(90 -1 9)\" />\r\n        <use href={ARROW_HREF} transform=\"rotate(-90 9 -1)\" />\r\n        <use href={ARROW_HREF} transform=\"rotate(180 4 4)\" />\r\n    </>\r\n);\r\n\r\nconst closedArrows = (\r\n    <>\r\n        <use href={ARROW_HREF} />\r\n        <use href={ARROW_HREF} transform=\"rotate(90 9 9)\" />\r\n        <use href={ARROW_HREF} transform=\"rotate(180 9 9)\" />\r\n        <use href={ARROW_HREF} transform=\"rotate(-90 9 9)\" />\r\n    </>\r\n);\r\n\r\nconst isFullscreen = (element?: HTMLElement | null) => element && document.fullscreenElement === element;\r\n\r\nexport default function FullscreenButton({\r\n    element,\r\n    ...rest\r\n}: FullscreenButtonProps) {\r\n    const [open, setOpen] = useState(isFullscreen(element?.current));\r\n\r\n    useEffect(() => {\r\n        const listener = () => { setOpen(isFullscreen(element?.current)); };\r\n        document.addEventListener('fullscreenchange', listener, false);\r\n        return () => {\r\n            document.removeEventListener('fullscreenchange', listener);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <Distortion\r\n            as=\"button\"\r\n            type=\"button\"\r\n            className={styles['fullscreen-button']}\r\n            aria-label=\"fullscreen button\"\r\n            onClick={open\r\n                ? () => { void document.exitFullscreen(); }\r\n                : () => { void element?.current?.requestFullscreen(); }}\r\n            {...interactiveConditionalFilters}\r\n            {...rest}\r\n        >\r\n            <svg viewBox=\"0 0 19 19\">\r\n                <defs>\r\n                    <path id={ARROW_ID} d={ARROW_PATH} />\r\n                </defs>\r\n                {open ? openArrows : closedArrows}\r\n            </svg>\r\n        </Distortion>\r\n    );\r\n}\r\n","import { quat, Vec3, vec3 } from 'wgpu-matrix';\nimport Camera from './camera';\nimport { clamp } from '../../../utils/general';\n\nconst DEG_TO_RAD = Math.PI / 180;\n\nexport class OrbitCameraController {\n    xSensitivity = 0.2;\n    ySensitivity = 0.2;\n    panSpeed = 0.0005;\n\n    zoomSensitivity = 0.001;\n    minZoomSpeed = 0.1;\n    maxZoomSpeed = 5;\n    minZoom = 0;\n    maxZoom = 50;\n\n    phi = 0;\n    theta = 0;\n\n    focusPoint: Vec3;\n\n    constructor(\n        public camera: Camera,\n        focusPoint: [number, number, number] = [0, 0, 0],\n        public currentZoom = 2.5,\n    ) {\n        this.focusPoint = vec3.create(...focusPoint);\n        this.update();\n    }\n\n    rotate(x: number, y: number) {\n        this.phi -= x * this.xSensitivity;\n        this.phi = (this.phi + 360) % 360;\n\n        this.theta -= y * this.ySensitivity;\n        this.theta = clamp(this.theta, -90, 90);\n\n        quat.fromEuler(this.theta * DEG_TO_RAD, this.phi * DEG_TO_RAD, 0, 'zyx', this.camera.rotation);\n        this.update();\n    }\n\n    pan(x: number, y: number) {\n        const speed = this.panSpeed * Math.max(this.currentZoom, 0.1);\n        const delta = vec3.transformQuat([x * speed, y * speed, 0], this.camera.rotation);\n        vec3.add(delta, this.focusPoint, this.focusPoint);\n        this.update();\n    }\n\n    zoom(delta: number) {\n        const changeAbs = this.currentZoom * Math.abs(delta) * this.zoomSensitivity;\n        const changeScaled = Math.sign(delta) * clamp(changeAbs, this.minZoomSpeed, this.maxZoomSpeed);\n        this.currentZoom = clamp(this.currentZoom + changeScaled, this.minZoom, this.maxZoom);\n        this.update();\n    }\n\n    update() {\n        const rot = vec3.transformQuat([0, 0, this.currentZoom], this.camera.rotation, []);\n        vec3.add(rot, this.focusPoint, this.camera.location);\n    }\n}\n","import { disableBodyScroll, enableBodyScroll } from 'body-scroll-lock';\r\nimport { useRef, useEffect, useReducer } from 'react';\r\n\r\nimport type { WheelEvent, MouseEvent, MouseEventHandler, JSX, RefObject } from 'react';\r\nimport type { ModelConstructor } from '../../rendering/samples/settings/sample-spec';\r\n\r\nimport Renderer from '../../rendering/core/renderer';\r\nimport ModelSettingsWidget from './model-settings-gui';\r\nimport FullscreenButton from './fullscreen-button/fullscreen-button';\r\nimport { OrbitCameraController } from '../../rendering/core/camera/orbit-camera-controller';\r\n\r\nconst enum MoveState {\r\n    none = 0,\r\n    rotate = 1,\r\n    zoom = 2,\r\n    pan = 4,\r\n}\r\n\r\ntype ViewportState = {\r\n    controller?: OrbitCameraController,\r\n    focused: boolean,\r\n    canFocus: boolean,\r\n    moveState: MoveState,\r\n    settings?: JSX.Element,\r\n    mouseHandler?: MouseEventHandler,\r\n};\r\n\r\ntype ViewportAction =\r\n    ({ type: 'update' } & Partial<ViewportState>)\r\n    | { type: 'mouseMove', x: number, y: number };\r\n\r\nexport type ViewportProps = {\r\n    ModelConstructor: ModelConstructor,\r\n    viewportRef: RefObject<HTMLDivElement | null>,\r\n};\r\n\r\nfunction reducer(state: ViewportState, action: ViewportAction) {\r\n    switch (action.type) {\r\n        case 'update': {\r\n            const { type, ...rest } = action;\r\n            return { ...state, ...rest };\r\n        };\r\n        case 'mouseMove': {\r\n            const { x, y } = action;\r\n            if (state.moveState & MoveState.rotate) state.controller?.rotate(x, y);\r\n            if (state.moveState & MoveState.zoom) state.controller?.zoom(10 * y);\r\n            if (state.moveState & MoveState.pan) state.controller?.pan(-x, y);\r\n            return state;\r\n        }\r\n        default: return state;\r\n    }\r\n}\r\n\r\nexport default function Viewport({ ModelConstructor, viewportRef }: ViewportProps) {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    const [{ controller, focused, canFocus, settings }, dispatch] = useReducer(reducer, {\r\n        controller: undefined,\r\n        focused: false,\r\n        canFocus: true,\r\n        moveState: MoveState.none,\r\n        mouseHandler: undefined,\r\n    });\r\n\r\n    const onMouseDown = (e: MouseEvent) => {\r\n        if (!canFocus) return;\r\n\r\n        void canvasRef.current?.requestPointerLock();\r\n\r\n        dispatch({\r\n            type: 'update',\r\n            moveState: e.buttons & 0b111,\r\n            focused: true,\r\n        });\r\n    };\r\n\r\n    const onMouseUp = (e: MouseEvent) => {\r\n        const moveState = (e.buttons & 0b111) as MoveState;\r\n        const moving = moveState !== MoveState.none;\r\n\r\n        dispatch({\r\n            type: 'update',\r\n            focused: moving,\r\n            moveState,\r\n        });\r\n\r\n        if (!moving) {\r\n            document.exitPointerLock();\r\n        }\r\n    };\r\n\r\n    const onWheel = focused\r\n        ? (e: WheelEvent<HTMLCanvasElement>) => { controller?.zoom(e.deltaY); }\r\n        : undefined;\r\n\r\n    const unlock = () => {\r\n        if (canvasRef.current) {\r\n            canvasRef.current.blur();\r\n            enableBodyScroll(canvasRef.current);\r\n        }\r\n\r\n        if (focused) {\r\n            dispatch({ type: 'update', focused: false, canFocus: false });\r\n            setTimeout(() => { dispatch({ type: 'update', canFocus: true }); }, 1500);\r\n        }\r\n    };\r\n\r\n    const handleLockChange = () => {\r\n        if (document.pointerLockElement !== canvasRef.current) {\r\n            unlock();\r\n            return;\r\n        }\r\n\r\n        dispatch({ type: 'update', focused: true });\r\n\r\n        if (canvasRef.current) disableBodyScroll(canvasRef.current, { reserveScrollBarGap: true });\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (canvasRef.current == null) throw new Error('webgpu render -- canvas uninitialized');\r\n\r\n        Renderer.CreateInitialized(canvasRef.current).then((renderer) => {\r\n            const model = new ModelConstructor(renderer);\r\n\r\n            dispatch({\r\n                type: 'update',\r\n                controller: new OrbitCameraController(renderer.camera, [-0.5, 3.5, 0], 20),\r\n                settings: <ModelSettingsWidget {...model.settings} />,\r\n            });\r\n\r\n            requestAnimationFrame(renderer.render);\r\n        }).catch((e: unknown) => {\r\n            // eslint-disable-next-line @typescript-eslint/restrict-template-expressions, no-console\r\n            console.warn(`failed to initialize renderer:\\n${e}`);\r\n        });\r\n\r\n        document.addEventListener('pointerlockchange', handleLockChange, false);\r\n\r\n        return () => {\r\n            document.removeEventListener('pointerlockchange', handleLockChange);\r\n            unlock();\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <canvas\r\n                ref={canvasRef}\r\n                onMouseDown={onMouseDown}\r\n                onMouseUp={onMouseUp}\r\n                onMouseMove={({ movementX: x, movementY: y }) => {\r\n                    if (!focused) return;\r\n                    dispatch({ type: 'mouseMove', x, y });\r\n                }}\r\n                onWheel={onWheel}\r\n            />\r\n            {settings}\r\n            <FullscreenButton element={viewportRef} />\r\n        </>\r\n    );\r\n}\r\n","import { Vec3, Mat4, mat4, Quat } from 'wgpu-matrix';\r\nimport { TypeSizes } from '../constants';\r\n\r\nexport type CameraParams = {\r\n    nearPlane: number,\r\n    farPlane: number,\r\n    fov: number,\r\n    width: number,\r\n    height: number,\r\n    projection: 'perspective' | 'ortho',\r\n};\r\n\r\nexport default class Camera {\r\n    static readonly worldToViewOffset = 0;\r\n    static readonly viewToClipOffset = this.worldToViewOffset + TypeSizes.sizeofMat4x4f;\r\n    static readonly worldToClipOffset = this.viewToClipOffset + TypeSizes.sizeofMat4x4f;\r\n    static readonly viewToWorldOffset = this.worldToClipOffset + TypeSizes.sizeofMat4x4f;\r\n    static readonly clipToViewOffset = this.viewToWorldOffset + TypeSizes.sizeofMat4x4f;\r\n    static readonly clipToWorldOffset = this.clipToViewOffset + TypeSizes.sizeofMat4x4f;\r\n\r\n    static readonly bufferLength = this.clipToWorldOffset + TypeSizes.sizeofMat4x4f;\r\n\r\n    /**\r\n   *  An ArrayBuffer containing the camera's worldToView, viewToClip, worldToClip,\r\n   *  viewToWorld, clipToView, and clipToWorld matrices as Float32Arrays for\r\n   *  easier transfer. Ordered as listed above.\r\n   */\r\n    readonly buffer: ArrayBuffer = new ArrayBuffer(Camera.bufferLength);\r\n\r\n    readonly worldToView: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.worldToViewOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly viewToClip: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.viewToClipOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly worldToClip: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.worldToClipOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly viewToWorld: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.viewToWorldOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly clipToView: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.clipToViewOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly clipToWorld: Mat4 = new Float32Array(\r\n        this.buffer,\r\n        Camera.clipToWorldOffset,\r\n        TypeSizes.mat4x4Count,\r\n    );\r\n\r\n    readonly location: Vec3 = new Float32Array([0, 0, 0]);\r\n    readonly rotation: Quat = new Float32Array([0, 0, 0, 1]);\r\n\r\n    params: CameraParams = {\r\n        nearPlane: 0.01,\r\n        farPlane: 500.0,\r\n        fov: 40,\r\n        width: 1920,\r\n        height: 1080,\r\n        projection: 'perspective',\r\n    };\r\n\r\n    constructor(viewParams: Partial<CameraParams> = {}) {\r\n        this.updateParams(viewParams);\r\n    }\r\n\r\n    updateParams(val: Partial<CameraParams>) {\r\n        this.params = { ...this.params, ...val };\r\n        this.#cacheProjection();\r\n    }\r\n\r\n    cacheView(): void {\r\n        mat4.fromQuat(this.rotation, this.viewToWorld);\r\n        mat4.setTranslation(this.viewToWorld, this.location, this.viewToWorld);\r\n        mat4.invert(this.viewToWorld, this.worldToView);\r\n        mat4.mul(this.viewToClip, this.worldToView, this.worldToClip);\r\n        mat4.mul(this.viewToWorld, this.clipToView, this.clipToWorld);\r\n    }\r\n\r\n    #cacheProjection(): void {\r\n        if (this.params.projection === 'perspective') {\r\n            mat4.perspective(\r\n                this.params.fov * (Math.PI / 180),\r\n                this.params.width / this.params.height,\r\n                this.params.nearPlane,\r\n                this.params.farPlane,\r\n                this.viewToClip,\r\n            );\r\n        } else {\r\n            const x = this.params.width / 2;\r\n            const y = this.params.height / 2;\r\n\r\n            mat4.ortho(\r\n                -x,\r\n                x,\r\n                -y,\r\n                y,\r\n                this.params.nearPlane,\r\n                this.params.farPlane,\r\n                this.viewToClip,\r\n            );\r\n        }\r\n\r\n        mat4.invert(this.viewToClip, this.clipToView);\r\n    }\r\n}\r\n","import * as ktxp from 'ktx-parse';\r\n\r\nexport const TypeSizes = {\r\n    mat4x4Count: 16,\r\n    sizeofMat4x4f: 16 * Float32Array.BYTES_PER_ELEMENT,\r\n};\r\n\r\nexport const VkFormatToWebGPU: Record<number, GPUTextureFormat | undefined> = {\r\n    // 8-bit formats\r\n    [ktxp.VK_FORMAT_R8_UNORM]: 'r8unorm',\r\n    [ktxp.VK_FORMAT_R8_SNORM]: 'r8snorm',\r\n    [ktxp.VK_FORMAT_R8_UINT]: 'r8uint',\r\n    [ktxp.VK_FORMAT_R8_SINT]: 'r8sint',\r\n    // 16-bit formats\r\n    [ktxp.VK_FORMAT_R16_UINT]: 'r16uint',\r\n    [ktxp.VK_FORMAT_R16_SINT]: 'r16sint',\r\n    [ktxp.VK_FORMAT_R16_SFLOAT]: 'r16float',\r\n    [ktxp.VK_FORMAT_R8G8_UNORM]: 'rg8unorm',\r\n    [ktxp.VK_FORMAT_R8G8_SNORM]: 'rg8snorm',\r\n    [ktxp.VK_FORMAT_R8G8_UINT]: 'rg8uint',\r\n    [ktxp.VK_FORMAT_R8G8_SINT]: 'rg8sint',\r\n    // 32-bit formats\r\n    [ktxp.VK_FORMAT_R32_UINT]: 'r32uint',\r\n    [ktxp.VK_FORMAT_R32_SINT]: 'r32sint',\r\n    [ktxp.VK_FORMAT_R32_SFLOAT]: 'r32float',\r\n    [ktxp.VK_FORMAT_R16G16_UINT]: 'rg16uint',\r\n    [ktxp.VK_FORMAT_R16G16_SINT]: 'rg16sint',\r\n    [ktxp.VK_FORMAT_R16G16_SFLOAT]: 'rg16float',\r\n    [ktxp.VK_FORMAT_R8G8B8A8_UNORM]: 'rgba8unorm',\r\n    [ktxp.VK_FORMAT_R8G8B8A8_SRGB]: 'rgba8unorm-srgb',\r\n    [ktxp.VK_FORMAT_R8G8B8A8_SNORM]: 'rgba8snorm',\r\n    [ktxp.VK_FORMAT_R8G8B8A8_UINT]: 'rgba8uint',\r\n    [ktxp.VK_FORMAT_R8G8B8A8_SINT]: 'rgba8sint',\r\n    [ktxp.VK_FORMAT_B8G8R8A8_UNORM]: 'bgra8unorm',\r\n    [ktxp.VK_FORMAT_B8G8R8A8_SRGB]: 'bgra8unorm-srgb',\r\n    // Packed 32-bit formats\r\n    [ktxp.VK_FORMAT_E5B9G9R9_UFLOAT_PACK32]: 'rgb9e5ufloat',\r\n    [ktxp.VK_FORMAT_A2R10G10B10_UINT_PACK32]: 'rgb10a2uint',\r\n    [ktxp.VK_FORMAT_A2R10G10B10_UNORM_PACK32]: 'rgb10a2unorm',\r\n    [ktxp.VK_FORMAT_B10G11R11_UFLOAT_PACK32]: 'rg11b10ufloat',\r\n    // 64-bit formats\r\n    [ktxp.VK_FORMAT_R32G32_UINT]: 'rg32uint',\r\n    [ktxp.VK_FORMAT_R32G32_SINT]: 'rg32sint',\r\n    [ktxp.VK_FORMAT_R32G32_SFLOAT]: 'rg32float',\r\n    [ktxp.VK_FORMAT_R16G16B16A16_UINT]: 'rgba16uint',\r\n    [ktxp.VK_FORMAT_R16G16B16A16_SINT]: 'rgba16sint',\r\n    [ktxp.VK_FORMAT_R16G16B16A16_SFLOAT]: 'rgba16float',\r\n    // 128-bit formats\r\n    [ktxp.VK_FORMAT_R32G32B32A32_UINT]: 'rgba32uint',\r\n    [ktxp.VK_FORMAT_R32G32B32A32_SINT]: 'rgba32sint',\r\n    [ktxp.VK_FORMAT_R32G32B32A32_SFLOAT]: 'rgba32float',\r\n    // BC compressed formats usable if \"texture-compression-bc\" is both\r\n    // supported by the device/user agent and enabled in requestDevice.\r\n    [ktxp.VK_FORMAT_BC1_RGBA_UNORM_BLOCK]: 'bc1-rgba-unorm',\r\n    [ktxp.VK_FORMAT_BC1_RGBA_SRGB_BLOCK]: 'bc1-rgba-unorm-srgb',\r\n    [ktxp.VK_FORMAT_BC2_UNORM_BLOCK]: 'bc2-rgba-unorm',\r\n    [ktxp.VK_FORMAT_BC2_SRGB_BLOCK]: 'bc2-rgba-unorm-srgb',\r\n    [ktxp.VK_FORMAT_BC3_UNORM_BLOCK]: 'bc3-rgba-unorm',\r\n    [ktxp.VK_FORMAT_BC3_SRGB_BLOCK]: 'bc3-rgba-unorm-srgb',\r\n    [ktxp.VK_FORMAT_BC4_UNORM_BLOCK]: 'bc4-r-unorm',\r\n    [ktxp.VK_FORMAT_BC4_SNORM_BLOCK]: 'bc4-r-snorm',\r\n    [ktxp.VK_FORMAT_BC5_UNORM_BLOCK]: 'bc5-rg-unorm',\r\n    [ktxp.VK_FORMAT_BC5_SNORM_BLOCK]: 'bc5-rg-snorm',\r\n    [ktxp.VK_FORMAT_BC6H_UFLOAT_BLOCK]: 'bc6h-rgb-ufloat',\r\n    [ktxp.VK_FORMAT_BC6H_SFLOAT_BLOCK]: 'bc6h-rgb-float',\r\n    [ktxp.VK_FORMAT_BC7_UNORM_BLOCK]: 'bc7-rgba-unorm',\r\n    [ktxp.VK_FORMAT_BC7_SRGB_BLOCK]: 'bc7-rgba-unorm-srgb',\r\n    // Currently unsupported extension formats:\r\n    // ETC2 compressed formats usable if \"texture-compression-etc2\" is both\r\n    // supported by the device/user agent and enabled in requestDevice.\r\n    // \"etc2-rgb8unorm\",\r\n    // \"etc2-rgb8unorm-srgb\",\r\n    // \"etc2-rgb8a1unorm\",\r\n    // \"etc2-rgb8a1unorm-srgb\",\r\n    // \"etc2-rgba8unorm\",\r\n    // \"etc2-rgba8unorm-srgb\",\r\n    // \"eac-r11unorm\",\r\n    // \"eac-r11snorm\",\r\n    // \"eac-rg11unorm\",\r\n    // \"eac-rg11snorm\",\r\n    // ASTC compressed formats usable if \"texture-compression-astc\" is both\r\n    // supported by the device/user agent and enabled in requestDevice.\r\n    // \"astc-4x4-unorm\",\r\n    // \"astc-4x4-unorm-srgb\",\r\n    // \"astc-5x4-unorm\",\r\n    // \"astc-5x4-unorm-srgb\",\r\n    // \"astc-5x5-unorm\",\r\n    // \"astc-5x5-unorm-srgb\",\r\n    // \"astc-6x5-unorm\",\r\n    // \"astc-6x5-unorm-srgb\",\r\n    // \"astc-6x6-unorm\",\r\n    // \"astc-6x6-unorm-srgb\",\r\n    // \"astc-8x5-unorm\",\r\n    // \"astc-8x5-unorm-srgb\",\r\n    // \"astc-8x6-unorm\",\r\n    // \"astc-8x6-unorm-srgb\",\r\n    // \"astc-8x8-unorm\",\r\n    // \"astc-8x8-unorm-srgb\",\r\n    // \"astc-10x5-unorm\",\r\n    // \"astc-10x5-unorm-srgb\",\r\n    // \"astc-10x6-unorm\",\r\n    // \"astc-10x6-unorm-srgb\",\r\n    // \"astc-10x8-unorm\",\r\n    // \"astc-10x8-unorm-srgb\",\r\n    // \"astc-10x10-unorm\",\r\n    // \"astc-10x10-unorm-srgb\",\r\n    // \"astc-12x10-unorm\",\r\n    // \"astc-12x10-unorm-srgb\",\r\n    // \"astc-12x12-unorm\",\r\n};\r\n\r\nexport const TextureFormatToSize: Partial<Record<GPUTextureFormat, number>> = {\r\n    // 8-bit formats\r\n    r8unorm: 1,\r\n    r8snorm: 1,\r\n    r8uint: 1,\r\n    r8sint: 1,\r\n    // 16-bit formats\r\n    r16uint: 2,\r\n    r16sint: 2,\r\n    r16float: 2,\r\n    rg8unorm: 2,\r\n    rg8snorm: 2,\r\n    rg8uint: 2,\r\n    rg8sint: 2,\r\n    // 32-bit formats\r\n    r32uint: 4,\r\n    r32sint: 4,\r\n    r32float: 4,\r\n    rg16uint: 4,\r\n    rg16sint: 4,\r\n    rg16float: 4,\r\n    rgba8unorm: 4,\r\n    'rgba8unorm-srgb': 4,\r\n    rgba8snorm: 4,\r\n    rgba8uint: 4,\r\n    rgba8sint: 4,\r\n    bgra8unorm: 4,\r\n    'bgra8unorm-srgb': 4,\r\n    // Packed 32-bit formats\r\n    rgb9e5ufloat: 4,\r\n    rgb10a2uint: 4,\r\n    rgb10a2unorm: 4,\r\n    rg11b10ufloat: 4,\r\n    // 64-bit formats\r\n    rg32uint: 8,\r\n    rg32sint: 8,\r\n    rg32float: 8,\r\n    rgba16uint: 8,\r\n    rgba16sint: 8,\r\n    rgba16float: 8,\r\n    // 128-bit formats\r\n    rgba32uint: 16,\r\n    rgba32sint: 16,\r\n    rgba32float: 16,\r\n};\r\n\r\nexport const TextureFormatToChannelSize: Partial<Record<GPUTextureFormat, number>> = {\r\n    // 8-bit formats\r\n    r8unorm: 1,\r\n    r8snorm: 1,\r\n    r8uint: 1,\r\n    r8sint: 1,\r\n    // 16-bit formats\r\n    r16uint: 2,\r\n    r16sint: 2,\r\n    r16float: 2,\r\n    rg8unorm: 1,\r\n    rg8snorm: 1,\r\n    rg8uint: 1,\r\n    rg8sint: 1,\r\n    // 32-bit formats\r\n    r32uint: 4,\r\n    r32sint: 4,\r\n    r32float: 4,\r\n    rg16uint: 2,\r\n    rg16sint: 2,\r\n    rg16float: 2,\r\n    rgba8unorm: 1,\r\n    'rgba8unorm-srgb': 1,\r\n    rgba8snorm: 1,\r\n    rgba8uint: 1,\r\n    rgba8sint: 1,\r\n    bgra8unorm: 1,\r\n    'bgra8unorm-srgb': 1,\r\n    // Packed 32-bit formats\r\n    rgb9e5ufloat: 4,\r\n    rgb10a2uint: 4,\r\n    rgb10a2unorm: 4,\r\n    rg11b10ufloat: 4,\r\n    // 64-bit formats\r\n    rg32uint: 4,\r\n    rg32sint: 4,\r\n    rg32float: 4,\r\n    rgba16uint: 2,\r\n    rgba16sint: 2,\r\n    rgba16float: 2,\r\n    // 128-bit formats\r\n    rgba32uint: 4,\r\n    rgba32sint: 4,\r\n    rgba32float: 4,\r\n};\r\n\r\nexport const WebGPUToVkFormat = Object.fromEntries(\r\n    Object.entries(VkFormatToWebGPU).map(([vk, wgpu]) => [wgpu, parseInt(vk, 10)]),\r\n) as Record<GPUTextureFormat, ktxp.VKFormat>;\r\n\r\nexport const textureTypeToDimension: Record<string, GPUTextureViewDimension> = {\r\n    texture_cube: 'cube',\r\n    texture_3d: '3d',\r\n    texture_2d: '2d',\r\n};\r\n","import Camera from './camera/camera';\r\n\r\nconst label = 'global uniforms';\r\n\r\nexport default class GlobalUniforms {\r\n    static readonly code = (group: number) => /* wgsl */`\r\n        struct GlobalUniforms {\r\n            worldToView: mat4x4f,\r\n            viewToClip: mat4x4f,\r\n            worldToClip: mat4x4f,\r\n            inverseWorldToView: mat4x4f,\r\n            inverseViewToClip: mat4x4f,\r\n            inverseWorldToClip: mat4x4f,\r\n        }\r\n\r\n        @group(${group}) @binding(0) var<uniform> globals: GlobalUniforms;\r\n    `;\r\n\r\n    static readonly bufferSize = Camera.bufferLength;\r\n\r\n    static readonly layoutDescriptor: GPUBindGroupLayoutDescriptor = {\r\n        label,\r\n        entries: [\r\n            {\r\n                binding: 0,\r\n                buffer: { minBindingSize: GlobalUniforms.bufferSize },\r\n                visibility: GPUShaderStage.VERTEX | GPUShaderStage.FRAGMENT,\r\n            },\r\n        ],\r\n    };\r\n\r\n    static readonly bufferDescriptor: GPUBufferDescriptor = {\r\n        label,\r\n        size: GlobalUniforms.bufferSize,\r\n        usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\r\n    };\r\n\r\n    deviceBuffer: GPUBuffer;\r\n    bindGroupLayout: GPUBindGroupLayout;\r\n    bindGroupDescriptor!: GPUBindGroupDescriptor;\r\n    bindgroup!: GPUBindGroup;\r\n\r\n    constructor(device: GPUDevice) {\r\n        this.deviceBuffer = device.createBuffer(GlobalUniforms.bufferDescriptor);\r\n        this.bindGroupLayout = device.createBindGroupLayout(GlobalUniforms.layoutDescriptor);\r\n\r\n        this.bindGroupDescriptor = {\r\n            label,\r\n            layout: this.bindGroupLayout,\r\n            entries: [\r\n                {\r\n                    binding: 0,\r\n                    resource: {\r\n                        buffer: this.deviceBuffer,\r\n                        offset: 0,\r\n                        size: GlobalUniforms.bufferSize,\r\n                    },\r\n                },\r\n            ],\r\n        };\r\n\r\n        this.bindgroup = device.createBindGroup(this.bindGroupDescriptor);\r\n    }\r\n\r\n    updateDeviceBuffer(queue: GPUQueue, camera: Camera) {\r\n        camera.cacheView();\r\n        queue.writeBuffer(this.deviceBuffer, 0, camera.buffer);\r\n    }\r\n}\r\n","import { UnknownObject, mapValues } from '../../../utils/general';\n\n// Unique symbols to avoid naming collisions with underlying types\nconst $type = Symbol('PropertyListener -- Type');\nconst $callback = Symbol('PropertyListener -- Callback');\nconst $listeners = Symbol('PropertyListener -- Listeners');\nexport const ListenerSyms = Object.freeze({ $type, $callback, $listeners });\n\ntype Syms = typeof $type | typeof $callback | typeof $listeners;\nexport type ValueKeyCallback<T extends object> = <K extends keyof T, V extends T[K]>(value: V, key: K) => void;\n\nexport type GuiSetting<T extends object = object, Tag extends string = string> = {\n    [$type]: Tag,\n    [$callback]?: ValueKeyCallback<T>,\n    [$listeners]: Set<ValueKeyCallback<T>>,\n} & T;\n\nexport type ListenerSpec<T extends object = object, Tag extends string = string> =\n    Omit<GuiSetting<T, Tag>, typeof $listeners>;\n\ntype MapSpec<T extends Record<PropertyKey, ListenerSpec>> = {\n    [K in keyof T]: T[K] extends ListenerSpec<object, infer Tag> & infer Rest\n        ? Rest extends object\n            ? GuiSetting<Omit<Rest, Syms>, Tag> : never : never\n};\n\nfunction fastProxy(spec: GuiSetting<UnknownObject>, callback?: (value: unknown, key: string) => void) {\n    return Object.keys(spec)\n        .reduce((prev, key) => Object.defineProperty(prev, key, {\n            enumerable: true,\n            get() { return spec[key]; },\n            set(value: unknown) {\n                if (spec[key] !== value) {\n                    spec[key] = value;\n                    callback?.(value, key);\n                }\n            },\n        }), { [$type]: spec[$type], [$listeners]: spec[$listeners] });\n}\n\nexport default function propertyListener<T extends Record<PropertyKey, ListenerSpec<UnknownObject>>>(specs: T) {\n    for (const spec of Object.values(specs) as GuiSetting[]) {\n        spec[$listeners] = new Set();\n    }\n\n    return {\n        publicSettings: mapValues(specs, (spec) => {\n            const cast = spec as GuiSetting<UnknownObject>;\n            return fastProxy(cast, cast[$callback]);\n        }) as MapSpec<T>,\n        privateSettings: mapValues(specs, (spec) => {\n            const cast = spec as GuiSetting<UnknownObject>;\n            return fastProxy(cast, (value, key) => {\n                cast[$listeners].forEach((fn) => { fn(value, key); });\n            });\n        }) as MapSpec<T>,\n    };\n}\n","export default /* wgsl */`\r\n    struct VertOut {\r\n        @builtin(position) pos: vec4f,\r\n        @location(0) uv: vec2f,\r\n    }\r\n\r\n    @vertex\r\n    fn vs(@builtin(vertex_index) idx: u32) -> VertOut {\r\n        const pos = array(\r\n            vec2f(-1,  3),\r\n            vec2f(3, -1),\r\n            vec2f(-1, -1),\r\n        );\r\n        var res: VertOut;\r\n        res.pos = vec4f(pos[idx], 0.0, 1.0);\r\n        res.uv = pos[idx] * vec2f(0.5, -0.5) + 0.5;\r\n        return res;\r\n    }\r\n`;\r\n","export const toWorldDir: string = /* wgsl */`\n    fn toWorldDir(coord: vec3u, size: u32) -> vec3f {\n        let uv = (2.0 / f32(size)) * (vec2f(coord.xy) + 0.5) - 1.0;\n\n        var pos: vec3f;\n        switch (coord.z) {\n            case 0  { pos = vec3(  1.0, -uv.y, -uv.x); }\n            case 1  { pos = vec3( -1.0, -uv.y,  uv.x); }\n            case 2  { pos = vec3( uv.x,   1.0,  uv.y); }\n            case 3  { pos = vec3( uv.x,  -1.0, -uv.y); }\n            case 4  { pos = vec3( uv.x, -uv.y,   1.0); }\n            default { pos = vec3(-uv.x, -uv.y,  -1.0); }\n        }\n\n        return normalize(pos);\n    }\n\n    fn toWorldDirF32(coord: vec2f, face: u32) -> vec3f {\n        let uv = 2.0 * coord - 1.0;\n\n        var pos: vec3f;\n        switch (face) {\n            case 0  { pos = vec3(  1.0, -uv.y, -uv.x); }\n            case 1  { pos = vec3( -1.0, -uv.y,  uv.x); }\n            case 2  { pos = vec3( uv.x,   1.0,  uv.y); }\n            case 3  { pos = vec3( uv.x,  -1.0, -uv.y); }\n            case 4  { pos = vec3( uv.x, -uv.y,   1.0); }\n            default { pos = vec3(-uv.x, -uv.y,  -1.0); }\n        }\n\n        return normalize(pos);\n    }\n`;\n\n/**\n *  WGSL functions for sampling across adjacent faces of a cubemap\n */\nexport const cubemapSampleConversions: string = /* wgsl */`\n    const INVALID_FACE = 6;\n    const INVALID_IDX = 4294967295u; // max u32\n\n    fn cubeSampleCoord(coord: vec3i, w: u32) -> vec3u {\n        // a flattened matrix of destination faces based on\n        // starting face and direction\n        const dfaces = array(\n            //                               I  Up Down Left Right Invalid\n            0, 2, 3, 4, 5, INVALID_FACE, // +X  +Y   -Y   +Z   -Z   \n            1, 2, 3, 5, 4, INVALID_FACE, // -X  +Y   -Y   -Z   +Z \n            2, 5, 4, 1, 0, INVALID_FACE, // +Y  -Z   +Z   -X   +X \n            3, 4, 5, 1, 0, INVALID_FACE, // -Y  +Z   -Z   -X   +X \n            4, 2, 3, 1, 0, INVALID_FACE, // +Z  +Y   -Y   -X   +X \n            5, 2, 3, 0, 1, INVALID_FACE, // -Z  +Y   -Y   +X   -X \n        );\n\n        // a flattened matrix in the same form as dfaces\n        // giving the index of the dmat array containing \n        // the transformation from the starting face to \n        // the destination face\n        const dindices = array(\n            0, 1,  2,  3,  4,  0,\n            0, 5,  6,  3,  4,  0,\n            0, 7,  8,  9,  10, 0,\n            0, 11, 12, 13, 14, 0,\n            0, 11, 8,  3,  4,  0,\n            0, 7,  12, 3,  4,  0,\n        );\n\n        // 2x4 matrices transforming a coordinate vector <u, v, w, 1>\n        // from one face to another\n        const dmats = array(\n            array(// 0\n                vec4(1, 0, 0, 0),   // u = u\n                vec4(0, 1, 0, 0),   // v = v\n            ),\n            array(// 1\n                vec4(0, 1, 1, 0),   // u = v + w\n                vec4(-1, 0, 1, -1), // v = w - u - 1\n            ),\n            array(// 2\n                vec4(0, -1, 2, -1), // u = 2w - v - 1\n                vec4(1, 0, 0, 0),   // v = u\n            ),\n            array(// 3\n                vec4(1, 0, 1, 0),   // u = u + w\n                vec4(0, 1, 0, 0),   // v = v\n            ),\n            array(// 4\n                vec4(1, 0, -1, 0),  // u = u - w\n                vec4(0, 1, 0, 0),   // v = v\n            ),\n            array(// 5\n                vec4(0, -1, 0, -1), // u = -v - 1\n                vec4(1, 0, 0, 0),   // v = u\n            ),\n            array(// 6\n                vec4(0, 1, -1, 0),  // u = v - w\n                vec4(-1, 0, 1, -1), // v = w - u - 1\n            ),\n            array(// 7\n                vec4(-1, 0, 1, -1), // u = w - u - 1\n                vec4(0, -1, 0, -1), // v = -v - 1\n            ),\n            array(// 8\n                vec4(1, 0, 0, 0),   // u = u\n                vec4(0, 1, -1, 0),  // v = v - w\n            ),\n            array(// 9\n                vec4(0, 1, 0, 0),   // u = v\n                vec4(-1, 0, 0, -1), // v = -u - 1\n            ),\n            array(// 10\n                vec4(0, -1, 1, -1), // u = w - v - 1\n                vec4(1, 0, -1, 0),  // v = u - w\n            ),\n            array(// 11\n                vec4(1, 0, 0, 0),   // u = u\n                vec4(0, 1, 1, 0),   // v = v + w\n            ),\n            array(// 12\n                vec4(-1, 0, 1, -1), // u = w - u - 1\n                vec4(0, -1, 2, -1), // v = 2w - v - 1\n            ),\n            array(// 13\n                vec4(0, -1, 1, -1), // u = w - v - 1\n                vec4(1, 0, 1, 0),   // v = u + w\n            ),\n            array(// 14\n                vec4(0, 1, 0, 0),   // u = v\n                vec4(-1, 0, 2, -1), // v = 2w - u - 1\n            ),\n        );\n\n        let iw = i32(w);\n\n        var dir = 0;\n        if (\n            coord.y >= iw * 2 - 1 \n            || coord.y <= -iw \n            || coord.x >= iw * 2 - 1 \n            || coord.x <= -iw\n        ) {\n            dir = 5;\n        } else {\n            if (coord.y < 0) {\n                dir = 1;\n            } else if (coord.y >= iw) {\n                dir = 2;\n            }\n            if (coord.x < 0) {\n                dir = select(5, 3, dir == 0);\n            } else if (coord.x >= iw) {\n                dir = select(5, 4, dir == 0);\n            }\n        }\n\n        let idx = coord.z * 6 + dir;\n        let samp = vec4(coord.xy, iw, 1);\n        let dmat = dmats[dindices[idx]];\n        return vec3u(vec3(dot(dmat[0], samp), dot(dmat[1], samp), dfaces[idx]));\n    }\n\n    fn cubeCoordToIdx(coord: vec3u, w: u32) -> u32 {\n        return coord.x + coord.y * w + coord.z * w * w;\n    }\n\n    fn cubeIdxToCoord(idx: u32, w: u32) -> vec3u {\n        let w2 = w * w;\n        let fidx = idx % w2;\n        return vec3u(fidx % w, fidx / w, idx / w2);\n    }\n\n    fn cubeSampleIdx(uvf: vec3i, w: u32) -> u32 {\n        let coord = cubeSampleCoord(uvf, w);\n        return select(\n            cubeCoordToIdx(coord, w), \n            INVALID_IDX, \n            coord.z == INVALID_FACE,\n        );\n    }\n`;\n","import * as ktxparse from 'ktx-parse';\r\n\r\nimport { TextureFormatToSize, TextureFormatToChannelSize, WebGPUToVkFormat } from '../core/constants';\r\nimport { mapRange, padTemplate } from '../../utils/general';\r\n\r\nexport function createAndCopyBuffer(\r\n    arr: ArrayBuffer | ArrayBufferView,\r\n    usage: GPUFlagsConstant,\r\n    device: GPUDevice,\r\n    label?: string,\r\n    alignment = 4,\r\n): GPUBuffer {\r\n    const pad = alignment - 1;\r\n    const buffer = device.createBuffer({\r\n        label,\r\n        usage,\r\n        size: (arr.byteLength + pad) & ~pad,\r\n        mappedAtCreation: true,\r\n    } as GPUBufferDescriptor);\r\n\r\n    const writeArray = new Uint8Array(buffer.getMappedRange());\r\n    const readArray = arr instanceof ArrayBuffer\r\n        ? new Uint8Array(arr)\r\n        : new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\r\n\r\n    writeArray.set(readArray);\r\n    buffer.unmap();\r\n\r\n    return buffer;\r\n}\r\n\r\nexport function createAndCopyCubemap(\r\n    device: GPUDevice,\r\n    data: ArrayBuffer,\r\n    format: GPUTextureFormat,\r\n    usage: number,\r\n    label?: string,\r\n) {\r\n    const pixelSize = TextureFormatToSize[format];\r\n    if (pixelSize == null) {\r\n        throw new Error(`copy cubemap -- unsupported format: ${format}`);\r\n    }\r\n\r\n    const width = Math.sqrt(data.byteLength / (6 * pixelSize));\r\n    const size = { width, height: width, depthOrArrayLayers: 6 };\r\n\r\n    const texture = device.createTexture({\r\n        usage: usage | GPUTextureUsage.COPY_DST,\r\n        label,\r\n        format,\r\n        size,\r\n    });\r\n\r\n    device.queue.writeTexture(\r\n        { texture },\r\n        data,\r\n        { bytesPerRow: width * pixelSize, rowsPerImage: width },\r\n        size,\r\n    );\r\n\r\n    return texture;\r\n}\r\n\r\nexport type TextureToArrayBufferOptions = {\r\n    device: GPUDevice,\r\n    texture: GPUTexture,\r\n    mipLevel?: number,\r\n    resultBuffer?: Uint8Array,\r\n    storageBuffer?: GPUBuffer,\r\n    returnBuffer?: boolean,\r\n    description?: string,\r\n};\r\n\r\nexport async function textureToArrayBuffer(\r\n    options: Omit<TextureToArrayBufferOptions, 'returnBuffer'> & { returnBuffer?: false },\r\n): Promise<{ imageData: Uint8Array }>;\r\n\r\nexport async function textureToArrayBuffer(\r\n    options: Omit<TextureToArrayBufferOptions, 'returnBuffer'> & { returnBuffer: true },\r\n): Promise<{ imageData: Uint8Array, storageBuffer: GPUBuffer }>;\r\n\r\nexport async function textureToArrayBuffer({\r\n    device,\r\n    texture,\r\n    mipLevel = 0,\r\n    returnBuffer,\r\n    storageBuffer,\r\n    resultBuffer,\r\n    description,\r\n}: TextureToArrayBufferOptions) {\r\n    const pixelSize = TextureFormatToSize[texture.format];\r\n    const fullDescription = padTemplate`[textureToKTX${description ?? ''}${texture.label}] --`;\r\n\r\n    if (pixelSize == null) {\r\n        throw new Error(`${fullDescription} format ${texture.format} unsupported`);\r\n    }\r\n\r\n    const width = texture.width >> mipLevel;\r\n    const height = texture.height >> mipLevel;\r\n    const rawBytesPerRow = width * pixelSize;\r\n    const bytesPerRow = Math.max(rawBytesPerRow, 256);\r\n    const rowsPerImage = height;\r\n    const byteSize = rowsPerImage * bytesPerRow * texture.depthOrArrayLayers;\r\n    const resultSize = rawBytesPerRow * height * texture.depthOrArrayLayers;\r\n\r\n    if (resultBuffer != null && resultBuffer.byteLength < byteSize) {\r\n        throw new Error(`${fullDescription} given result array not large enough.\r\n${resultBuffer.byteLength} < ${byteSize}`);\r\n    }\r\n\r\n    if (storageBuffer != null && storageBuffer.size < byteSize) {\r\n        throw new Error(`${fullDescription} given storage buffer not large enough.\r\n${storageBuffer.size} < ${byteSize}`);\r\n    }\r\n\r\n    const requiredUsage = GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ;\r\n\r\n    if (storageBuffer != null && (storageBuffer.usage & requiredUsage) !== requiredUsage) {\r\n        throw new Error(`${fullDescription} given storage does not have correct usage flags.\r\nGiven: ${storageBuffer.usage}\r\nRequired: ${requiredUsage}`);\r\n    }\r\n\r\n    let imageData = resultBuffer ?? new Uint8Array(byteSize);\r\n    const storage = storageBuffer ?? device.createBuffer({\r\n        label: `${fullDescription} storage buffer`,\r\n        size: byteSize,\r\n        usage: requiredUsage,\r\n    });\r\n\r\n    const encoder = device.createCommandEncoder({ label: `${fullDescription} encoder` });\r\n    encoder.copyTextureToBuffer(\r\n        { texture, mipLevel },\r\n        { buffer: storage, rowsPerImage, bytesPerRow },\r\n        { width, height, depthOrArrayLayers: texture.depthOrArrayLayers },\r\n    );\r\n    device.queue.submit([encoder.finish()]);\r\n\r\n    await Promise.all([\r\n        storage.mapAsync(GPUMapMode.READ, 0, byteSize),\r\n        device.queue.onSubmittedWorkDone(),\r\n    ]);\r\n\r\n    const mapped = storage.getMappedRange(0, byteSize);\r\n    imageData.set(new Uint8Array(mapped));\r\n    storage.unmap();\r\n\r\n    if (bytesPerRow > rawBytesPerRow) {\r\n        for (let h = 0; h < height * texture.depthOrArrayLayers; h += 1) {\r\n            for (let w = 0; w < rawBytesPerRow; w += 1) {\r\n                imageData[w + h * rawBytesPerRow] = imageData[w + h * bytesPerRow];\r\n            }\r\n        }\r\n        imageData = imageData.slice(0, resultSize);\r\n    }\r\n\r\n    return {\r\n        imageData,\r\n        storageBuffer: returnBuffer ? storage : undefined,\r\n    };\r\n}\r\n\r\nexport async function textureToKTX(device: GPUDevice, texture: GPUTexture, cube = false) {\r\n    const pixelSize = TextureFormatToSize[texture.format];\r\n    const typeSize = TextureFormatToChannelSize[texture.format];\r\n\r\n    if (pixelSize == null || typeSize == null) {\r\n        throw new Error(`textureToKTX -- format ${texture.format} of ${texture.label} unsupported`);\r\n    }\r\n\r\n    const container = new ktxparse.KTX2Container();\r\n    container.pixelWidth = texture.width;\r\n    container.pixelHeight = texture.height;\r\n    container.vkFormat = WebGPUToVkFormat[texture.format];\r\n    container.typeSize = typeSize;\r\n    delete container.keyValue.KTXswizzle;\r\n\r\n    const dataFormat = container.dataFormatDescriptor[0];\r\n    dataFormat.colorModel = ktxparse.KHR_DF_MODEL_RGBSDA;\r\n    dataFormat.transferFunction = ktxparse.KHR_DF_TRANSFER_LINEAR;\r\n    dataFormat.bytesPlane[0] = pixelSize;\r\n\r\n    dataFormat.samples = mapRange(4, (i) => ({\r\n        channelType: [192, 193, 194, 207][i],\r\n        samplePosition: [0, 0, 0, 0],\r\n        bitLength: container.typeSize * 8 - 1,\r\n        bitOffset: container.typeSize * 8 * i,\r\n        sampleLower: -1082130432,\r\n        sampleUpper: 1065353216,\r\n    }));\r\n\r\n    if (texture.dimension === '3d') {\r\n        container.faceCount = 1;\r\n        container.pixelDepth = texture.depthOrArrayLayers;\r\n    } else if (cube) {\r\n        const cubeLayers = texture.depthOrArrayLayers / 6;\r\n        container.layerCount = cubeLayers === 1 ? 0 : cubeLayers;\r\n        container.faceCount = 6;\r\n    } else {\r\n        container.layerCount = texture.depthOrArrayLayers;\r\n        container.faceCount = 1;\r\n    }\r\n\r\n    let storageBuffer: GPUBuffer | undefined;\r\n    let imageData: Uint8Array;\r\n\r\n    for (let i = 0; i < texture.mipLevelCount; i += 1) {\r\n        ({ imageData, storageBuffer } = await textureToArrayBuffer({\r\n            mipLevel: i,\r\n            returnBuffer: true,\r\n            device,\r\n            texture,\r\n            storageBuffer,\r\n        }));\r\n\r\n        container.levels.push({\r\n            levelData: imageData,\r\n            uncompressedByteLength: imageData.byteLength,\r\n        });\r\n    }\r\n\r\n    return ktxparse.write(container);\r\n}\r\n","export type UnknownObject = Record<PropertyKey, unknown>;\r\n\r\nexport function mapValues<Input, ObjectType extends Partial<Record<keyof ObjectType, Input>>, Output>(\r\n    obj: ObjectType,\r\n    fn: (val: Input) => Output,\r\n) {\r\n    const entries = Object.entries(obj) as [keyof ObjectType, Input][];\r\n    const mapped = entries.map(([key, val]) => [key, fn(val)]);\r\n    return Object.fromEntries(mapped) as { [K in keyof ObjectType]: Output };\r\n}\r\n\r\nexport function clamp(num: number, min: number, max: number) {\r\n    return Math.max(min, Math.min(max, num));\r\n}\r\n\r\nexport function padCheck(str: string | undefined) {\r\n    return str == null || str === '' ? '' : ` ${str}`;\r\n}\r\n\r\nexport function padTemplate(strings: TemplateStringsArray, ...values: (string | undefined)[]) {\r\n    const result = [strings[0]];\r\n    values.forEach((key, i) => result.push(padCheck(key), strings[i + 1]));\r\n    return result.join('');\r\n}\r\n\r\nexport function range(n: number) {\r\n    return [...Array(n).keys()];\r\n}\r\n\r\nexport function mapRange<T>(n: number, fn: (i: number) => T) {\r\n    return range(n).map(fn);\r\n}\r\n\r\nexport function debounce<Args extends Array<unknown>>(callback: (...args: Args) => unknown, delay: number) {\r\n    let tid: ReturnType<typeof setTimeout> | undefined;\r\n    return function (...args: Args) {\r\n        const ctx = self;\r\n        if (tid != null) clearTimeout(tid);\r\n        tid = setTimeout(() => { callback.apply(ctx, args); }, delay);\r\n    };\r\n};\r\n\r\n// adapted from https://stackoverflow.com/a/60702475/17108769\r\nexport function binaryInsert<T>(\r\n    arr: T[],\r\n    element: T,\r\n    comparator: (a: T, b: T) => number,\r\n    left = 0,\r\n    right = arr.length - 1,\r\n) {\r\n    if (right - left <= 1) {\r\n        if (comparator(element, arr[left] ?? element) < 0) arr.splice(left, 0, element);\r\n        else if (comparator(element, arr[right] ?? element) > 0) arr.splice(right + 1, 0, element);\r\n        else arr.splice(right, 0, element);\r\n    } else {\r\n        const pivot = Math.floor((right - left) / 2) + left;\r\n        if (comparator(element, arr[pivot]) < 0) binaryInsert(arr, element, comparator, left, pivot);\r\n        else binaryInsert(arr, element, comparator, pivot, right);\r\n    }\r\n}\r\n\r\nexport function isObject(val: unknown): val is NonNullable<UnknownObject> {\r\n    return typeof val === 'object' && val != null;\r\n}\r\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","locals","label","TonemapPass","constructor","device","format","colorAttachment","loadOp","storeOp","view","undefined","passDescriptor","colorAttachments","this","renderTarget","bindgroupLayout","createBindGroupLayout","bindGroupLayoutDescriptor","createShaderModule","code","pipelineDescriptor","layout","createPipelineLayout","bindGroupLayouts","vertex","entryPoint","fragment","targets","pipeline","createRenderPipeline","updateInput","input","bindgroup","createBindGroup","entries","binding","resource","render","encoder","output","createView","dimension","pass","beginRenderPass","setPipeline","setBindGroup","draw","end","texture","sampleType","viewDimension","visibility","GPUShaderStage","FRAGMENT","SkyboxPass","mipLevel","uniformArray","val","queue","writeBuffer","uniformBuffer","useNearestSample","targetFormat","pipelineLayout","shader","skyTexture","skybox","depthTexture","globals","Float32Array","target","clearValue","r","g","b","a","VERTEX","sampler","buffer","type","linearSampler","createSampler","minFilter","magFilter","mipmapFilter","nearestSampler","bindGroupLayout","createBuffer","size","usage","GPUBufferUsage","COPY_DST","UNIFORM","textureBindgroup","GBuffer","_size","value","textures","forEach","tex","createTexture","updateBindgroup","updatePassDescriptor","normal","name","albedo","emission","metallicRoughness","depth","slice","map","layoutDescription","idx","depthStencilAttachment","depthLoadOp","depthStoreOp","depthClearValue","GPUTextureUsage","RENDER_ATTACHMENT","TEXTURE_BINDING","group","DeferredPass","irradianceTexture","samples","outputWidth","outputFormat","outputTexture","width","depthOrArrayLayers","height","params","Uint32Array","paramBuffer","constants","SAMPLES","i","arrayLayerCount","baseArrayLayer","createCommandEncoder","submit","finish","createIrradianceTexture","radianceTexture","paramArrayBuffer","ArrayBuffer","uintParams","floatParams","mipLevelCount","Math","max","log2","copyEncoder","copyTextureToTexture","PI","Promise","resolve","then","async","mip","roughness","face","onSubmittedWorkDone","baseMipLevel","createRadianceTexture","irradianceView","radianceView","bfrdLutView","gbuffer","bfrdLut","sampleCount","SAMPLE_COUNT","createBfrdLut","Renderer","deferredPass","skyboxPass","canvas","forwardPasses","requestAnimationFrame","updateDeviceBuffer","camera","forwardPassParams","forwardPass","tonemapPass","context","getCurrentTexture","postProcessFormat","getContext","Error","configure","COPY_SRC","alphaMode","colorSpace","updateBackings","CreateInitialized","adapter","navigator","gpu","requestAdapter","maxComputeWorkgroupSizeX","maxComputeWorkgroupsPerDimension","maxComputeInvocationsPerWorkgroup","limits","requestDevice","requiredFeatures","requiredLimits","updateParams","postprocessTarget","addForwardPass","priority","resizeCanvas","rawWidth","rawHeight","min","maxTextureDimension2D","dimensions","ResizeObserver","inlineSize","blockSize","length","devicePixelContentBoxSize","observe","box","contentBoxSize","devicePixelRatio","getPreferredCanvasFormat","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","Button","props","as","Select","items","onChange","defaultSelected","style","disabled","Object","keys","e","key","defaultChecked","FileUpload","process","buttonText","accept","initialValues","callbacks","inputRef","useRef","files","setFiles","useState","useEffect","update","changed","newValues","add","delete","gridRow","gridColumn","onClick","current","click","fontStretch","display","ref","onInput","file","currentTarget","useTooltip","content","distortionRef","shown","setShown","tooltip","role","defaultFilter","scale","disable","refreshSeed","Checkbox","callback","propVal","description","useId","setValue","show","hide","position","htmlFor","onMouseEnter","onMouseLeave","checked","Slider","step","sliderState","setSliderState","showTooltip","hideTooltip","useCallback","newVal","parseFloat","fn","deps","isMountingRef","useRerenderEffect","minRefresh","SettingsPanel","children","handleId","nodeRef","buttonRef","isOpen","setIsOpen","handle","CSS","escape","onDrag","bounds","forwardedRef","className","patternUnits","x","y","cx","cy","fill","open","ModelSettingsWidget","settings","info","$type","$listeners","rest","color","ARROW_ID","ARROW_HREF","ARROW_PATH","replaceAll","openArrows","href","transform","closedArrows","isFullscreen","element","document","fullscreenElement","FullscreenButton","setOpen","listener","addEventListener","removeEventListener","exitFullscreen","requestFullscreen","viewBox","d","DEG_TO_RAD","OrbitCameraController","focusPoint","currentZoom","xSensitivity","ySensitivity","panSpeed","zoomSensitivity","minZoomSpeed","maxZoomSpeed","minZoom","maxZoom","phi","theta","create","rotate","fromEuler","rotation","pan","speed","delta","transformQuat","zoom","changeAbs","abs","changeScaled","sign","rot","location","reducer","state","action","moveState","controller","Viewport","ModelConstructor","viewportRef","canvasRef","focused","canFocus","dispatch","useReducer","mouseHandler","onWheel","deltaY","unlock","blur","setTimeout","handleLockChange","pointerLockElement","reserveScrollBarGap","renderer","model","catch","console","warn","onMouseDown","requestPointerLock","buttons","onMouseUp","moving","exitPointerLock","onMouseMove","movementX","movementY","Camera","viewParams","bufferLength","worldToView","worldToViewOffset","mat4x4Count","viewToClip","viewToClipOffset","worldToClip","worldToClipOffset","viewToWorld","viewToWorldOffset","clipToView","clipToViewOffset","clipToWorld","clipToWorldOffset","nearPlane","farPlane","fov","projection","cacheView","fromQuat","setTranslation","invert","mul","perspective","ortho","sizeofMat4x4f","TypeSizes","BYTES_PER_ELEMENT","VkFormatToWebGPU","TextureFormatToSize","r8unorm","r8snorm","r8uint","r8sint","r16uint","r16sint","r16float","rg8unorm","rg8snorm","rg8uint","rg8sint","r32uint","r32sint","r32float","rg16uint","rg16sint","rg16float","rgba8unorm","rgba8snorm","rgba8uint","rgba8sint","bgra8unorm","rgb9e5ufloat","rgb10a2uint","rgb10a2unorm","rg11b10ufloat","rg32uint","rg32sint","rg32float","rgba16uint","rgba16sint","rgba16float","rgba32uint","rgba32sint","rgba32float","TextureFormatToChannelSize","WebGPUToVkFormat","fromEntries","vk","wgpu","parseInt","GlobalUniforms","deviceBuffer","bufferDescriptor","layoutDescriptor","bindGroupDescriptor","offset","bufferSize","minBindingSize","Symbol","$callback","ListenerSyms","freeze","fastProxy","spec","reduce","prev","defineProperty","enumerable","get","set","propertyListener","specs","values","Set","publicSettings","privateSettings","cast","toWorldDir","cubemapSampleConversions","createAndCopyBuffer","arr","alignment","pad","byteLength","mappedAtCreation","writeArray","Uint8Array","getMappedRange","readArray","byteOffset","unmap","textureToArrayBuffer","returnBuffer","storageBuffer","resultBuffer","pixelSize","fullDescription","rawBytesPerRow","bytesPerRow","rowsPerImage","byteSize","resultSize","requiredUsage","MAP_READ","imageData","storage","copyTextureToBuffer","all","mapAsync","GPUMapMode","READ","mapped","h","w","textureToKTX","cube","typeSize","container","pixelWidth","pixelHeight","vkFormat","keyValue","KTXswizzle","dataFormat","dataFormatDescriptor","colorModel","transferFunction","bytesPlane","channelType","samplePosition","bitLength","bitOffset","sampleLower","sampleUpper","faceCount","pixelDepth","cubeLayers","layerCount","levels","levelData","uncompressedByteLength","mapValues","obj","clamp","num","padTemplate","strings","result","str","join","mapRange","n","Array","range","debounce","delay","tid","args","ctx","self","clearTimeout","apply","binaryInsert","comparator","left","right","splice","pivot","floor","isObject"],"sourceRoot":""}