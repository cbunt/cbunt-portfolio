"use strict";(self.webpackChunkcbunt_portfolio=self.webpackChunkcbunt_portfolio||[]).push([[748],{1192:(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var native_file_system_adapter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8777);\n/* harmony import */ var _settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8545);\n/* harmony import */ var _settings_property_listener__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(1058);\n/* harmony import */ var _utils_data_copy__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6182);\n/* harmony import */ var _cubemap_guassian_pyramid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(7638);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__]);\n_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\nvar __classPrivateFieldGet = (undefined && undefined.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _CubemapBlurModel_settings;\n\n\n\n\n\nvar BlurState;\n(function (BlurState) {\n    BlurState[BlurState[\"IDLE\"] = 0] = \"IDLE\";\n    BlurState[BlurState[\"BLUR\"] = 1] = \"BLUR\";\n    BlurState[BlurState[\"WAIT\"] = 2] = \"WAIT\";\n})(BlurState || (BlurState = {}));\nclass CubemapBlurModel {\n    constructor(renderer) {\n        this.renderer = renderer;\n        this.state = BlurState.IDLE;\n        _CubemapBlurModel_settings.set(this, (0,_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* [\"default\"] */ .A)({\n            nearestSample: {\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$type]: 'checkbox',\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$callback]: (val) => {\n                    if (typeof val === 'boolean')\n                        this.renderer.skyboxPass.useNearestSample = val;\n                },\n                value: false,\n                description: 'Disables linear sampling in the viewer.',\n            },\n            mipLevel: {\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$type]: 'slider',\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$callback]: (value) => {\n                    if (typeof value === 'number')\n                        this.renderer.skyboxPass.mipLevel = value;\n                },\n                value: 0,\n                min: 0,\n                max: 1,\n                step: 0.1,\n                description: 'The mip level to display in the viewer. 0 is the original image, max is completely blurred with 1 pixel faces.',\n            },\n            filterDistance: {\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$type]: 'slider',\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$callback]: this.reblur.bind(this),\n                value: 2,\n                max: 64,\n                min: 0,\n                step: 0.1,\n                description: 'The number of pixels to blur from.',\n            },\n            skybox: (0,_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A)(this),\n            'Download Result': {\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_2__/* .ListenerSyms */ .t.$type]: 'button',\n                onClick: () => { void this.saveFile(); },\n            },\n        }));\n        this.settings = __classPrivateFieldGet(this, _CubemapBlurModel_settings, \"f\").publicSettings;\n        this.priority = 0;\n        renderer.addForwardPass(this);\n        this.device = renderer.device;\n    }\n    setSkybox(skybox) {\n        this.skybox = skybox;\n        __classPrivateFieldGet(this, _CubemapBlurModel_settings, \"f\").privateSettings.mipLevel.max = this.skybox.mipLevelCount - 1;\n        __classPrivateFieldGet(this, _CubemapBlurModel_settings, \"f\").privateSettings.mipLevel.value = 1;\n        this.renderer.skyboxPass.mipLevel = 1;\n        this.refresh();\n        void this.reblur();\n    }\n    resolve() {\n        this.refresh();\n        const lastState = this.state;\n        this.state = BlurState.IDLE;\n        if (lastState === BlurState.WAIT)\n            void this.reblur();\n    }\n    async reblur() {\n        if (this.skybox == null || this.state === BlurState.WAIT)\n            return;\n        if (this.state === BlurState.BLUR) {\n            this.state = BlurState.WAIT;\n            return;\n        }\n        this.state = BlurState.BLUR;\n        await (0,_cubemap_guassian_pyramid__WEBPACK_IMPORTED_MODULE_4__/* [\"default\"] */ .A)({\n            device: this.renderer.device,\n            texture: this.skybox,\n            steps: this.settings.filterDistance.value,\n            inPlace: true,\n            delayWork: requestAnimationFrame,\n        });\n        this.resolve();\n    }\n    refresh() {\n        if (this.skybox == null)\n            return;\n        this.renderer.skyboxPass.skyTexture = this.skybox.createView({ dimension: 'cube' });\n    }\n    async saveFile() {\n        if (this.skybox == null)\n            return;\n        try {\n            const proms = Promise.all([\n                (0,_utils_data_copy__WEBPACK_IMPORTED_MODULE_3__/* .textureToKTX */ .gU)(this.renderer.device, this.skybox, true)\n                    .then((ktx2) => new Blob([ktx2], { type: 'image/ktx2' })),\n                (0,native_file_system_adapter__WEBPACK_IMPORTED_MODULE_0__/* .showSaveFilePicker */ .H1)({\n                    types: [{ accept: { 'image/ktx2': ['.ktx2'] } }],\n                    suggestedName: 'blurred-skybox.ktx2',\n                }).then((handle) => handle.createWritable({ keepExistingData: false })),\n            ]);\n            const [blob, stream] = await proms;\n            await blob.stream().pipeTo(stream);\n        }\n        catch (e) {\n            console.warn(e);\n        }\n    }\n    render({ encoder, gbuffer }) {\n        encoder.beginRenderPass({\n            colorAttachments: [],\n            depthStencilAttachment: {\n                depthClearValue: 1,\n                depthLoadOp: 'clear',\n                depthStoreOp: 'store',\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                view: gbuffer.depth.view,\n            },\n        }).end();\n    }\n}\n_CubemapBlurModel_settings = new WeakMap();\nCubemapBlurModel.title = '';\nCubemapBlurModel.description = '';\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CubemapBlurModel);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWUsQ0FBQztZQUNwQixnQkFBZ0IsRUFBRSxFQUFFO1lBQ3BCLHNCQUFzQixFQUFFO2dCQUNwQixlQUFlLEVBQUUsQ0FBQztnQkFDbEIsV0FBVyxFQUFFLE9BQU87Z0JBQ3BCLFlBQVksRUFBRSxPQUFPO2dCQUNyQixvRUFBb0U7Z0JBQ3BFLElBQUksRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUk7YUFDM0I7U0FDSixDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDYixDQUFDOzs7QUE1SE0sc0JBQUssR0FBRyxFQUFFLENBQUM7QUFDWCw0QkFBVyxHQUFHLEVBQUUsQ0FBQztpRUFGUCxnQkFBZ0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvc2FtcGxlcy9jdWJlbWFwLWJsdXIvY3ViZW1hcC1ibHVyLXNhbXBsZS50cz80ZTI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNob3dTYXZlRmlsZVBpY2tlciB9IGZyb20gJ25hdGl2ZS1maWxlLXN5c3RlbS1hZGFwdGVyJztcblxuaW1wb3J0IGdldFNreWJveE9wdGlvbnMgZnJvbSAnLi4vc2V0dGluZ3Mvc2t5Ym94LW9wdGlvbnMnO1xuaW1wb3J0IHsgRnVsbFJlbmRlck1vZGVsIH0gZnJvbSAnLi4vc2V0dGluZ3Mvc2FtcGxlLXNwZWMnO1xuaW1wb3J0IHByb3BlcnR5TGlzdGVuZXIsIHsgTGlzdGVuZXJTeW1zIH0gZnJvbSAnLi4vc2V0dGluZ3MvcHJvcGVydHktbGlzdGVuZXInO1xuXG5pbXBvcnQgeyB0ZXh0dXJlVG9LVFggfSBmcm9tICcuLi8uLi91dGlscy9kYXRhLWNvcHknO1xuaW1wb3J0IFJlbmRlcmVyLCB7IEZvcndhcmRQYXNzUGFyYW1zIH0gZnJvbSAnLi4vLi4vcmVuZGVyaW5nL3JlbmRlcmVyJztcblxuaW1wb3J0IGN1YmVtYXBHdWFzc2lhblB5cmFtaWQgZnJvbSAnLi9jdWJlbWFwLWd1YXNzaWFuLXB5cmFtaWQnO1xuXG5lbnVtIEJsdXJTdGF0ZSB7IElETEUsIEJMVVIsIFdBSVQgfVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdWJlbWFwQmx1ck1vZGVsIGltcGxlbWVudHMgRnVsbFJlbmRlck1vZGVsIHtcbiAgICBzdGF0aWMgdGl0bGUgPSAnJztcbiAgICBzdGF0aWMgZGVzY3JpcHRpb24gPSAnJztcblxuICAgIHNreWJveD86IEdQVVRleHR1cmU7XG4gICAgc3RhdGU6IEJsdXJTdGF0ZSA9IEJsdXJTdGF0ZS5JRExFO1xuXG4gICAgcmVhZG9ubHkgI3NldHRpbmdzID0gcHJvcGVydHlMaXN0ZW5lcih7XG4gICAgICAgIG5lYXJlc3RTYW1wbGU6IHtcbiAgICAgICAgICAgIFtMaXN0ZW5lclN5bXMuJHR5cGVdOiAnY2hlY2tib3gnIGFzIGNvbnN0LFxuICAgICAgICAgICAgW0xpc3RlbmVyU3ltcy4kY2FsbGJhY2tdOiAodmFsOiB1bmtub3duKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdib29sZWFuJykgdGhpcy5yZW5kZXJlci5za3lib3hQYXNzLnVzZU5lYXJlc3RTYW1wbGUgPSB2YWw7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdEaXNhYmxlcyBsaW5lYXIgc2FtcGxpbmcgaW4gdGhlIHZpZXdlci4nLFxuICAgICAgICB9LFxuICAgICAgICBtaXBMZXZlbDoge1xuICAgICAgICAgICAgW0xpc3RlbmVyU3ltcy4kdHlwZV06ICdzbGlkZXInIGFzIGNvbnN0LFxuICAgICAgICAgICAgW0xpc3RlbmVyU3ltcy4kY2FsbGJhY2tdOiAodmFsdWU6IHVua25vd24pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgdGhpcy5yZW5kZXJlci5za3lib3hQYXNzLm1pcExldmVsID0gdmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgICBtYXg6IDEsXG4gICAgICAgICAgICBzdGVwOiAwLjEsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1RoZSBtaXAgbGV2ZWwgdG8gZGlzcGxheSBpbiB0aGUgdmlld2VyLiAwIGlzIHRoZSBvcmlnaW5hbCBpbWFnZSwgbWF4IGlzIGNvbXBsZXRlbHkgYmx1cnJlZCB3aXRoIDEgcGl4ZWwgZmFjZXMuJyxcbiAgICAgICAgfSxcbiAgICAgICAgZmlsdGVyRGlzdGFuY2U6IHtcbiAgICAgICAgICAgIFtMaXN0ZW5lclN5bXMuJHR5cGVdOiAnc2xpZGVyJyBhcyBjb25zdCxcbiAgICAgICAgICAgIFtMaXN0ZW5lclN5bXMuJGNhbGxiYWNrXTogdGhpcy5yZWJsdXIuYmluZCh0aGlzKSBhcyAoKSA9PiB2b2lkLFxuICAgICAgICAgICAgdmFsdWU6IDIsXG4gICAgICAgICAgICBtYXg6IDY0LFxuICAgICAgICAgICAgbWluOiAwLFxuICAgICAgICAgICAgc3RlcDogMC4xLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdUaGUgbnVtYmVyIG9mIHBpeGVscyB0byBibHVyIGZyb20uJyxcbiAgICAgICAgfSxcbiAgICAgICAgc2t5Ym94OiBnZXRTa3lib3hPcHRpb25zKHRoaXMpLFxuICAgICAgICAnRG93bmxvYWQgUmVzdWx0Jzoge1xuICAgICAgICAgICAgW0xpc3RlbmVyU3ltcy4kdHlwZV06ICdidXR0b24nIGFzIGNvbnN0LFxuICAgICAgICAgICAgb25DbGljazogKCkgPT4geyB2b2lkIHRoaXMuc2F2ZUZpbGUoKTsgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJlYWRvbmx5IHNldHRpbmdzID0gdGhpcy4jc2V0dGluZ3MucHVibGljU2V0dGluZ3M7XG4gICAgcmVhZG9ubHkgcHJpb3JpdHkgPSAwO1xuICAgIGRldmljZTogR1BVRGV2aWNlO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIHJlbmRlcmVyOiBSZW5kZXJlcikge1xuICAgICAgICByZW5kZXJlci5hZGRGb3J3YXJkUGFzcyh0aGlzKTtcbiAgICAgICAgdGhpcy5kZXZpY2UgPSByZW5kZXJlci5kZXZpY2U7XG4gICAgfVxuXG4gICAgc2V0U2t5Ym94KHNreWJveDogR1BVVGV4dHVyZSkge1xuICAgICAgICB0aGlzLnNreWJveCA9IHNreWJveDtcbiAgICAgICAgdGhpcy4jc2V0dGluZ3MucHJpdmF0ZVNldHRpbmdzLm1pcExldmVsLm1heCA9IHRoaXMuc2t5Ym94Lm1pcExldmVsQ291bnQgLSAxO1xuICAgICAgICB0aGlzLiNzZXR0aW5ncy5wcml2YXRlU2V0dGluZ3MubWlwTGV2ZWwudmFsdWUgPSAxO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNreWJveFBhc3MubWlwTGV2ZWwgPSAxO1xuXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB2b2lkIHRoaXMucmVibHVyKCk7XG4gICAgfVxuXG4gICAgcmVzb2x2ZSgpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIGNvbnN0IGxhc3RTdGF0ZSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBCbHVyU3RhdGUuSURMRTtcbiAgICAgICAgaWYgKGxhc3RTdGF0ZSA9PT0gQmx1clN0YXRlLldBSVQpIHZvaWQgdGhpcy5yZWJsdXIoKTtcbiAgICB9XG5cbiAgICBhc3luYyByZWJsdXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnNreWJveCA9PSBudWxsIHx8IHRoaXMuc3RhdGUgPT09IEJsdXJTdGF0ZS5XQUlUKSByZXR1cm47XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IEJsdXJTdGF0ZS5CTFVSKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gQmx1clN0YXRlLldBSVQ7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN0YXRlID0gQmx1clN0YXRlLkJMVVI7XG5cbiAgICAgICAgYXdhaXQgY3ViZW1hcEd1YXNzaWFuUHlyYW1pZCh7XG4gICAgICAgICAgICBkZXZpY2U6IHRoaXMucmVuZGVyZXIuZGV2aWNlLFxuICAgICAgICAgICAgdGV4dHVyZTogdGhpcy5za3lib3gsXG4gICAgICAgICAgICBzdGVwczogdGhpcy5zZXR0aW5ncy5maWx0ZXJEaXN0YW5jZS52YWx1ZSxcbiAgICAgICAgICAgIGluUGxhY2U6IHRydWUsXG4gICAgICAgICAgICBkZWxheVdvcms6IHJlcXVlc3RBbmltYXRpb25GcmFtZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgcmVmcmVzaCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2t5Ym94ID09IG51bGwpIHJldHVybjtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5za3lib3hQYXNzLnNreVRleHR1cmUgPSB0aGlzLnNreWJveC5jcmVhdGVWaWV3KHsgZGltZW5zaW9uOiAnY3ViZScgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZUZpbGUoKSB7XG4gICAgICAgIGlmICh0aGlzLnNreWJveCA9PSBudWxsKSByZXR1cm47XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm9tcyA9IFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICB0ZXh0dXJlVG9LVFgodGhpcy5yZW5kZXJlci5kZXZpY2UsIHRoaXMuc2t5Ym94LCB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigoa3R4MikgPT4gbmV3IEJsb2IoW2t0eDJdLCB7IHR5cGU6ICdpbWFnZS9rdHgyJyB9KSksXG4gICAgICAgICAgICAgICAgc2hvd1NhdmVGaWxlUGlja2VyKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZXM6IFt7IGFjY2VwdDogeyAnaW1hZ2Uva3R4Mic6IFsnLmt0eDInXSB9IH1dLFxuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0ZWROYW1lOiAnYmx1cnJlZC1za3lib3gua3R4MicsXG4gICAgICAgICAgICAgICAgfSkudGhlbigoaGFuZGxlKSA9PiBoYW5kbGUuY3JlYXRlV3JpdGFibGUoeyBrZWVwRXhpc3RpbmdEYXRhOiBmYWxzZSB9KSksXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3QgW2Jsb2IsIHN0cmVhbV0gPSBhd2FpdCBwcm9tcztcbiAgICAgICAgICAgIGF3YWl0IGJsb2Iuc3RyZWFtKCkucGlwZVRvKHN0cmVhbSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcih7IGVuY29kZXIsIGdidWZmZXIgfTogRm9yd2FyZFBhc3NQYXJhbXMpIHtcbiAgICAgICAgZW5jb2Rlci5iZWdpblJlbmRlclBhc3Moe1xuICAgICAgICAgICAgY29sb3JBdHRhY2htZW50czogW10sXG4gICAgICAgICAgICBkZXB0aFN0ZW5jaWxBdHRhY2htZW50OiB7XG4gICAgICAgICAgICAgICAgZGVwdGhDbGVhclZhbHVlOiAxLFxuICAgICAgICAgICAgICAgIGRlcHRoTG9hZE9wOiAnY2xlYXInLFxuICAgICAgICAgICAgICAgIGRlcHRoU3RvcmVPcDogJ3N0b3JlJyxcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgICAgIHZpZXc6IGdidWZmZXIuZGVwdGgudmlldyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pLmVuZCgpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1192\n")},6182:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Lr: () => (/* binding */ createAndCopyBuffer),\n/* harmony export */   gU: () => (/* binding */ textureToKTX)\n/* harmony export */ });\n/* unused harmony exports createAndCopyCubemap, ktx2ToTexture, textureToArrayBuffer */\n/* harmony import */ var ktx_parse__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(9253);\n/* harmony import */ var _rendering_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4176);\n/* harmony import */ var _general__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(80);\n\n\n\nfunction createAndCopyBuffer(arr, usage, device, label, alignment = 4) {\n    const pad = alignment - 1;\n    const buffer = device.createBuffer({\n        label,\n        usage,\n        size: (arr.byteLength + pad) & ~pad,\n        mappedAtCreation: true,\n    });\n    const writeArray = new Uint8Array(buffer.getMappedRange());\n    const readArray = arr instanceof ArrayBuffer\n        ? new Uint8Array(arr)\n        : new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n    writeArray.set(readArray);\n    buffer.unmap();\n    return buffer;\n}\nfunction createAndCopyCubemap(device, data, format, usage, label) {\n    const pixelSize = TextureFormatToSize[format];\n    if (pixelSize == null) {\n        throw new Error(`copy cubemap -- unsupported format: ${format}`);\n    }\n    const width = Math.sqrt(data.byteLength / (6 * pixelSize));\n    const size = { width, height: width, depthOrArrayLayers: 6 };\n    const texture = device.createTexture({\n        usage: usage | GPUTextureUsage.COPY_DST,\n        label,\n        format,\n        size,\n    });\n    device.queue.writeTexture({ texture }, data, { bytesPerRow: width * pixelSize, rowsPerImage: width }, size);\n    return texture;\n}\nfunction ktx2ToTexture(buffer, device, options) {\n    const arr = new Uint8Array(buffer);\n    const ktx = ktxparse.read(arr);\n    const format = VkFormatToWebGPU[ktx.vkFormat];\n    if (format == null) {\n        throw new Error(`ktx texture import -- unsupported format: ${ktx.vkFormat}\\n\\tCould not covert to webgpu`);\n    }\n    const pixelSize = TextureFormatToSize[format];\n    if (pixelSize == null) {\n        throw new Error(`ktx texture import -- unsupported format: ${ktx.vkFormat}\\n\\tCould not get pixel byte size`);\n    }\n    const size = {\n        width: ktx.pixelWidth,\n        height: ktx.pixelHeight,\n        depthOrArrayLayers: ktx.faceCount,\n    };\n    const maxMipCount = Math.ceil(Math.log2(Math.max(size.width, size.height))) + 1;\n    let mipLevelCount = ktx.levels.length;\n    if (options?.mipLevelCount === 'max') {\n        mipLevelCount = maxMipCount;\n    }\n    else if (typeof options?.mipLevelCount === 'number') {\n        mipLevelCount = Math.min(maxMipCount, options.mipLevelCount);\n    }\n    let usage = GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    if (options?.textureUsage)\n        usage |= options.textureUsage;\n    const texture = device.createTexture({\n        label: options?.label,\n        size,\n        mipLevelCount,\n        format,\n        usage,\n    });\n    const mipCopies = Math.min(ktx.levels.length, mipLevelCount) - 1;\n    for (let mipLevel = mipCopies; mipLevel >= 0; mipLevel -= 1) {\n        const width = size.width >> mipLevel;\n        const height = size.height >> mipLevel;\n        const { levelData } = ktx.levels[mipLevel];\n        const rawBytesPerRow = width * pixelSize;\n        const bytesPerRow = Math.max(rawBytesPerRow, 256);\n        const rowsPerImage = height;\n        const bytesPerImage = rowsPerImage * bytesPerRow;\n        let imageData = levelData;\n        if (bytesPerRow > rawBytesPerRow) {\n            imageData = new Uint8Array(bytesPerImage * texture.depthOrArrayLayers);\n            for (let h = 0; h < height * texture.depthOrArrayLayers; h += 1) {\n                for (let w = 0; w < rawBytesPerRow; w += 1) {\n                    imageData[w + h * bytesPerRow] = levelData[w + h * rawBytesPerRow];\n                }\n            }\n        }\n        const layerBatch = Math.min(Math.floor(device.limits.maxBufferSize / bytesPerImage), ktx.faceCount);\n        const layerCount = Math.ceil(ktx.faceCount / layerBatch);\n        for (let l = 0; l < layerCount; l += 1) {\n            const offset = l * layerBatch;\n            const count = Math.min(layerBatch, ktx.faceCount - offset);\n            const data = layerCount > 1\n                ? imageData.subarray(offset * bytesPerImage, (offset + count) * bytesPerImage)\n                : imageData;\n            device.queue.writeTexture({ mipLevel, texture, origin: [0, 0, offset] }, data, { bytesPerRow, rowsPerImage }, [width, height, count]);\n        }\n    }\n    return texture;\n}\nasync function textureToArrayBuffer({ device, texture, mipLevel = 0, returnBuffer, storageBuffer, resultBuffer, description, }) {\n    const pixelSize = _rendering_constants__WEBPACK_IMPORTED_MODULE_0__/* .TextureFormatToSize */ .T2[texture.format];\n    const fullDescription = (0,_general__WEBPACK_IMPORTED_MODULE_1__/* .padTemplate */ .OY) `[textureToKTX${description ?? ''}${texture.label}] --`;\n    if (pixelSize == null) {\n        throw new Error(`${fullDescription} format ${texture.format} unsupported`);\n    }\n    const width = texture.width >> mipLevel;\n    const height = texture.height >> mipLevel;\n    const rawBytesPerRow = width * pixelSize;\n    const bytesPerRow = Math.max(rawBytesPerRow, 256);\n    const rowsPerImage = height;\n    const byteSize = rowsPerImage * bytesPerRow * texture.depthOrArrayLayers;\n    const resultSize = rawBytesPerRow * height * texture.depthOrArrayLayers;\n    if (resultBuffer != null && resultBuffer.byteLength < byteSize) {\n        throw new Error(`${fullDescription} given result array not large enough.\r\n${resultBuffer.byteLength} < ${byteSize}`);\n    }\n    if (storageBuffer != null && storageBuffer.size < byteSize) {\n        throw new Error(`${fullDescription} given storage buffer not large enough.\r\n${storageBuffer.size} < ${byteSize}`);\n    }\n    const requiredUsage = GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ;\n    if (storageBuffer != null && (storageBuffer.usage & requiredUsage) !== requiredUsage) {\n        throw new Error(`${fullDescription} given storage does not have correct usage flags.\r\nGiven: ${storageBuffer.usage}\r\nRequired: ${requiredUsage}`);\n    }\n    let imageData = resultBuffer ?? new Uint8Array(byteSize);\n    const storage = storageBuffer ?? device.createBuffer({\n        label: `${fullDescription} storage buffer`,\n        size: byteSize,\n        usage: requiredUsage,\n    });\n    const encoder = device.createCommandEncoder({ label: `${fullDescription} encoder` });\n    encoder.copyTextureToBuffer({ texture, mipLevel }, { buffer: storage, rowsPerImage, bytesPerRow }, { width, height, depthOrArrayLayers: texture.depthOrArrayLayers });\n    device.queue.submit([encoder.finish()]);\n    await Promise.all([\n        storage.mapAsync(GPUMapMode.READ, 0, byteSize),\n        device.queue.onSubmittedWorkDone(),\n    ]);\n    const mapped = storage.getMappedRange(0, byteSize);\n    imageData.set(new Uint8Array(mapped));\n    storage.unmap();\n    if (bytesPerRow > rawBytesPerRow) {\n        for (let h = 0; h < height * texture.depthOrArrayLayers; h += 1) {\n            for (let w = 0; w < rawBytesPerRow; w += 1) {\n                imageData[w + h * rawBytesPerRow] = imageData[w + h * bytesPerRow];\n            }\n        }\n        imageData = imageData.slice(0, resultSize);\n    }\n    return {\n        imageData,\n        storageBuffer: returnBuffer ? storage : undefined,\n    };\n}\nasync function textureToKTX(device, texture, cube = false) {\n    const pixelSize = _rendering_constants__WEBPACK_IMPORTED_MODULE_0__/* .TextureFormatToSize */ .T2[texture.format];\n    const typeSize = _rendering_constants__WEBPACK_IMPORTED_MODULE_0__/* .TextureFormatToChannelSize */ .GE[texture.format];\n    if (pixelSize == null || typeSize == null) {\n        throw new Error(`textureToKTX -- format ${texture.format} of ${texture.label} unsupported`);\n    }\n    const container = new ktx_parse__WEBPACK_IMPORTED_MODULE_2__/* .KTX2Container */ .nYd();\n    container.pixelWidth = texture.width;\n    container.pixelHeight = texture.height;\n    container.vkFormat = _rendering_constants__WEBPACK_IMPORTED_MODULE_0__/* .WebGPUToVkFormat */ .KO[texture.format];\n    container.typeSize = typeSize;\n    delete container.keyValue.KTXswizzle;\n    const dataFormat = container.dataFormatDescriptor[0];\n    dataFormat.colorModel = ktx_parse__WEBPACK_IMPORTED_MODULE_2__/* .KHR_DF_MODEL_RGBSDA */ .Tre;\n    dataFormat.transferFunction = ktx_parse__WEBPACK_IMPORTED_MODULE_2__/* .KHR_DF_TRANSFER_LINEAR */ .T5j;\n    dataFormat.bytesPlane[0] = pixelSize;\n    dataFormat.samples = [0, 1, 2, 3].map((i) => ({\n        channelType: [192, 193, 194, 207][i],\n        samplePosition: [0, 0, 0, 0],\n        bitLength: container.typeSize * 8 - 1,\n        bitOffset: container.typeSize * 8 * i,\n        sampleLower: -1082130432,\n        sampleUpper: 1065353216,\n    }));\n    if (texture.dimension === '3d') {\n        container.faceCount = 1;\n        container.pixelDepth = texture.depthOrArrayLayers;\n    }\n    else if (cube) {\n        const cubeLayers = texture.depthOrArrayLayers / 6;\n        container.layerCount = cubeLayers === 1 ? 0 : cubeLayers;\n        container.faceCount = 6;\n    }\n    else {\n        container.layerCount = texture.depthOrArrayLayers;\n        container.faceCount = 1;\n    }\n    let storageBuffer;\n    let imageData;\n    for (let i = 0; i < texture.mipLevelCount; i += 1) {\n        // eslint-disable-next-line no-await-in-loop\n        ({ imageData, storageBuffer } = await textureToArrayBuffer({\n            mipLevel: i,\n            returnBuffer: true,\n            device,\n            texture,\n            storageBuffer,\n        }));\n        container.levels.push({\n            levelData: imageData,\n            uncompressedByteLength: imageData.byteLength,\n        });\n    }\n    return ktx_parse__WEBPACK_IMPORTED_MODULE_2__/* .write */ .M98(container);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUN2RCxRQUFRLEVBQUUsQ0FBQztZQUNYLFlBQVksRUFBRSxJQUFJO1lBQ2xCLE1BQU07WUFDTixPQUFPO1lBQ1AsYUFBYTtTQUNoQixDQUFDLENBQUMsQ0FBQztRQUVKLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ2xCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLHNCQUFzQixFQUFFLFNBQVMsQ0FBQyxVQUFVO1NBQy9DLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxPQUFPLHVEQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDckMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy91dGlscy9kYXRhLWNvcHkudHM/YmE1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBrdHhwYXJzZSBmcm9tICdrdHgtcGFyc2UnO1xyXG5cclxuaW1wb3J0IHsgVmtGb3JtYXRUb1dlYkdQVSwgVGV4dHVyZUZvcm1hdFRvU2l6ZSwgVGV4dHVyZUZvcm1hdFRvQ2hhbm5lbFNpemUsIFdlYkdQVVRvVmtGb3JtYXQgfSBmcm9tICcuLi9yZW5kZXJpbmcvY29uc3RhbnRzJztcclxuaW1wb3J0IHsgcGFkVGVtcGxhdGUgfSBmcm9tICcuL2dlbmVyYWwnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFuZENvcHlCdWZmZXIoXHJcbiAgICBhcnI6IEFycmF5QnVmZmVyIHwgVHlwZWRBcnJheUxpa2UsXHJcbiAgICB1c2FnZTogR1BVRmxhZ3NDb25zdGFudCxcclxuICAgIGRldmljZTogR1BVRGV2aWNlLFxyXG4gICAgbGFiZWw/OiBzdHJpbmcsXHJcbiAgICBhbGlnbm1lbnQgPSA0LFxyXG4pOiBHUFVCdWZmZXIge1xyXG4gICAgY29uc3QgcGFkID0gYWxpZ25tZW50IC0gMTtcclxuICAgIGNvbnN0IGJ1ZmZlciA9IGRldmljZS5jcmVhdGVCdWZmZXIoe1xyXG4gICAgICAgIGxhYmVsLFxyXG4gICAgICAgIHVzYWdlLFxyXG4gICAgICAgIHNpemU6IChhcnIuYnl0ZUxlbmd0aCArIHBhZCkgJiB+cGFkLFxyXG4gICAgICAgIG1hcHBlZEF0Q3JlYXRpb246IHRydWUsXHJcbiAgICB9IGFzIEdQVUJ1ZmZlckRlc2NyaXB0b3IpO1xyXG5cclxuICAgIGNvbnN0IHdyaXRlQXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXIuZ2V0TWFwcGVkUmFuZ2UoKSk7XHJcbiAgICBjb25zdCByZWFkQXJyYXkgPSBhcnIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlclxyXG4gICAgICAgID8gbmV3IFVpbnQ4QXJyYXkoYXJyKVxyXG4gICAgICAgIDogbmV3IFVpbnQ4QXJyYXkoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTtcclxuXHJcbiAgICB3cml0ZUFycmF5LnNldChyZWFkQXJyYXkpO1xyXG4gICAgYnVmZmVyLnVubWFwKCk7XHJcblxyXG4gICAgcmV0dXJuIGJ1ZmZlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFuZENvcHlDdWJlbWFwKFxyXG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXHJcbiAgICBkYXRhOiBBcnJheUJ1ZmZlcixcclxuICAgIGZvcm1hdDogR1BVVGV4dHVyZUZvcm1hdCxcclxuICAgIHVzYWdlOiBudW1iZXIsXHJcbiAgICBsYWJlbD86IHN0cmluZyxcclxuKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW2Zvcm1hdF07XHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGNvcHkgY3ViZW1hcCAtLSB1bnN1cHBvcnRlZCBmb3JtYXQ6ICR7Zm9ybWF0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHdpZHRoID0gTWF0aC5zcXJ0KGRhdGEuYnl0ZUxlbmd0aCAvICg2ICogcGl4ZWxTaXplKSk7XHJcbiAgICBjb25zdCBzaXplID0geyB3aWR0aCwgaGVpZ2h0OiB3aWR0aCwgZGVwdGhPckFycmF5TGF5ZXJzOiA2IH07XHJcblxyXG4gICAgY29uc3QgdGV4dHVyZSA9IGRldmljZS5jcmVhdGVUZXh0dXJlKHtcclxuICAgICAgICB1c2FnZTogdXNhZ2UgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9EU1QsXHJcbiAgICAgICAgbGFiZWwsXHJcbiAgICAgICAgZm9ybWF0LFxyXG4gICAgICAgIHNpemUsXHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXZpY2UucXVldWUud3JpdGVUZXh0dXJlKFxyXG4gICAgICAgIHsgdGV4dHVyZSB9LFxyXG4gICAgICAgIGRhdGEsXHJcbiAgICAgICAgeyBieXRlc1BlclJvdzogd2lkdGggKiBwaXhlbFNpemUsIHJvd3NQZXJJbWFnZTogd2lkdGggfSxcclxuICAgICAgICBzaXplLFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdGV4dHVyZTtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgS1RYSW1wb3J0T3B0aW9ucyA9IHtcclxuICAgIGxhYmVsPzogc3RyaW5nLFxyXG4gICAgbWlwTGV2ZWxDb3VudD86IG51bWJlciB8ICdtYXgnIHwgJ2RlZmF1bHQnLFxyXG4gICAgdGV4dHVyZVVzYWdlPzogbnVtYmVyLFxyXG4gICAgdmFsaWRhdGU/OiBib29sZWFuLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGt0eDJUb1RleHR1cmUoXHJcbiAgICBidWZmZXI6IEFycmF5QnVmZmVyLFxyXG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXHJcbiAgICBvcHRpb25zPzogS1RYSW1wb3J0T3B0aW9ucyxcclxuKSB7XHJcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xyXG4gICAgY29uc3Qga3R4ID0ga3R4cGFyc2UucmVhZChhcnIpO1xyXG4gICAgY29uc3QgZm9ybWF0ID0gVmtGb3JtYXRUb1dlYkdQVVtrdHgudmtGb3JtYXRdO1xyXG5cclxuICAgIGlmIChmb3JtYXQgPT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihga3R4IHRleHR1cmUgaW1wb3J0IC0tIHVuc3VwcG9ydGVkIGZvcm1hdDogJHtrdHgudmtGb3JtYXR9XFxuXFx0Q291bGQgbm90IGNvdmVydCB0byB3ZWJncHVgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW2Zvcm1hdF07XHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGt0eCB0ZXh0dXJlIGltcG9ydCAtLSB1bnN1cHBvcnRlZCBmb3JtYXQ6ICR7a3R4LnZrRm9ybWF0fVxcblxcdENvdWxkIG5vdCBnZXQgcGl4ZWwgYnl0ZSBzaXplYCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2l6ZSA9IHtcclxuICAgICAgICB3aWR0aDoga3R4LnBpeGVsV2lkdGgsXHJcbiAgICAgICAgaGVpZ2h0OiBrdHgucGl4ZWxIZWlnaHQsXHJcbiAgICAgICAgZGVwdGhPckFycmF5TGF5ZXJzOiBrdHguZmFjZUNvdW50LFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtYXhNaXBDb3VudCA9IE1hdGguY2VpbChNYXRoLmxvZzIoTWF0aC5tYXgoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpKSkgKyAxO1xyXG4gICAgbGV0IG1pcExldmVsQ291bnQgPSBrdHgubGV2ZWxzLmxlbmd0aDtcclxuICAgIGlmIChvcHRpb25zPy5taXBMZXZlbENvdW50ID09PSAnbWF4Jykge1xyXG4gICAgICAgIG1pcExldmVsQ291bnQgPSBtYXhNaXBDb3VudDtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnM/Lm1pcExldmVsQ291bnQgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgbWlwTGV2ZWxDb3VudCA9IE1hdGgubWluKG1heE1pcENvdW50LCBvcHRpb25zLm1pcExldmVsQ291bnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCB1c2FnZSA9IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9EU1Q7XHJcbiAgICBpZiAob3B0aW9ucz8udGV4dHVyZVVzYWdlKSB1c2FnZSB8PSBvcHRpb25zLnRleHR1cmVVc2FnZTtcclxuXHJcbiAgICBjb25zdCB0ZXh0dXJlID0gZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xyXG4gICAgICAgIGxhYmVsOiBvcHRpb25zPy5sYWJlbCxcclxuICAgICAgICBzaXplLFxyXG4gICAgICAgIG1pcExldmVsQ291bnQsXHJcbiAgICAgICAgZm9ybWF0LFxyXG4gICAgICAgIHVzYWdlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbWlwQ29waWVzID0gTWF0aC5taW4oa3R4LmxldmVscy5sZW5ndGgsIG1pcExldmVsQ291bnQpIC0gMTtcclxuXHJcbiAgICBmb3IgKGxldCBtaXBMZXZlbCA9IG1pcENvcGllczsgbWlwTGV2ZWwgPj0gMDsgbWlwTGV2ZWwgLT0gMSkge1xyXG4gICAgICAgIGNvbnN0IHdpZHRoID0gc2l6ZS53aWR0aCA+PiBtaXBMZXZlbDtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBzaXplLmhlaWdodCA+PiBtaXBMZXZlbDtcclxuICAgICAgICBjb25zdCB7IGxldmVsRGF0YSB9ID0ga3R4LmxldmVsc1ttaXBMZXZlbF07XHJcblxyXG4gICAgICAgIGNvbnN0IHJhd0J5dGVzUGVyUm93ID0gd2lkdGggKiBwaXhlbFNpemU7XHJcbiAgICAgICAgY29uc3QgYnl0ZXNQZXJSb3cgPSBNYXRoLm1heChyYXdCeXRlc1BlclJvdywgMjU2KTtcclxuICAgICAgICBjb25zdCByb3dzUGVySW1hZ2UgPSBoZWlnaHQ7XHJcbiAgICAgICAgY29uc3QgYnl0ZXNQZXJJbWFnZSA9IHJvd3NQZXJJbWFnZSAqIGJ5dGVzUGVyUm93O1xyXG5cclxuICAgICAgICBsZXQgaW1hZ2VEYXRhID0gbGV2ZWxEYXRhO1xyXG4gICAgICAgIGlmIChieXRlc1BlclJvdyA+IHJhd0J5dGVzUGVyUm93KSB7XHJcbiAgICAgICAgICAgIGltYWdlRGF0YSA9IG5ldyBVaW50OEFycmF5KGJ5dGVzUGVySW1hZ2UgKiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBoID0gMDsgaCA8IGhlaWdodCAqIHRleHR1cmUuZGVwdGhPckFycmF5TGF5ZXJzOyBoICs9IDEpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHcgPSAwOyB3IDwgcmF3Qnl0ZXNQZXJSb3c7IHcgKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVt3ICsgaCAqIGJ5dGVzUGVyUm93XSA9IGxldmVsRGF0YVt3ICsgaCAqIHJhd0J5dGVzUGVyUm93XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbGF5ZXJCYXRjaCA9IE1hdGgubWluKFxyXG4gICAgICAgICAgICBNYXRoLmZsb29yKGRldmljZS5saW1pdHMubWF4QnVmZmVyU2l6ZSAvIGJ5dGVzUGVySW1hZ2UpLFxyXG4gICAgICAgICAgICBrdHguZmFjZUNvdW50LFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgbGF5ZXJDb3VudCA9IE1hdGguY2VpbChrdHguZmFjZUNvdW50IC8gbGF5ZXJCYXRjaCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGwgPSAwOyBsIDwgbGF5ZXJDb3VudDsgbCArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGwgKiBsYXllckJhdGNoO1xyXG4gICAgICAgICAgICBjb25zdCBjb3VudCA9IE1hdGgubWluKGxheWVyQmF0Y2gsIGt0eC5mYWNlQ291bnQgLSBvZmZzZXQpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGxheWVyQ291bnQgPiAxXHJcbiAgICAgICAgICAgICAgICA/IGltYWdlRGF0YS5zdWJhcnJheShvZmZzZXQgKiBieXRlc1BlckltYWdlLCAob2Zmc2V0ICsgY291bnQpICogYnl0ZXNQZXJJbWFnZSlcclxuICAgICAgICAgICAgICAgIDogaW1hZ2VEYXRhO1xyXG5cclxuICAgICAgICAgICAgZGV2aWNlLnF1ZXVlLndyaXRlVGV4dHVyZShcclxuICAgICAgICAgICAgICAgIHsgbWlwTGV2ZWwsIHRleHR1cmUsIG9yaWdpbjogWzAsIDAsIG9mZnNldF0gfSxcclxuICAgICAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgICAgICB7IGJ5dGVzUGVyUm93LCByb3dzUGVySW1hZ2UgfSxcclxuICAgICAgICAgICAgICAgIFt3aWR0aCwgaGVpZ2h0LCBjb3VudF0sXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0ZXh0dXJlO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBUZXh0dXJlVG9BcnJheUJ1ZmZlck9wdGlvbnMgPSB7XHJcbiAgICBkZXZpY2U6IEdQVURldmljZSxcclxuICAgIHRleHR1cmU6IEdQVVRleHR1cmUsXHJcbiAgICBtaXBMZXZlbD86IG51bWJlcixcclxuICAgIHJlc3VsdEJ1ZmZlcj86IFVpbnQ4QXJyYXksXHJcbiAgICBzdG9yYWdlQnVmZmVyPzogR1BVQnVmZmVyLFxyXG4gICAgcmV0dXJuQnVmZmVyPzogYm9vbGVhbixcclxuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nLFxyXG59O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRleHR1cmVUb0FycmF5QnVmZmVyKFxyXG4gICAgb3B0aW9uczogT21pdDxUZXh0dXJlVG9BcnJheUJ1ZmZlck9wdGlvbnMsICdyZXR1cm5CdWZmZXInPiAmIHsgcmV0dXJuQnVmZmVyPzogZmFsc2UgfSxcclxuKTogUHJvbWlzZTx7IGltYWdlRGF0YTogVWludDhBcnJheSB9PjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXh0dXJlVG9BcnJheUJ1ZmZlcihcclxuICAgIG9wdGlvbnM6IE9taXQ8VGV4dHVyZVRvQXJyYXlCdWZmZXJPcHRpb25zLCAncmV0dXJuQnVmZmVyJz4gJiB7IHJldHVybkJ1ZmZlcjogdHJ1ZSB9LFxyXG4pOiBQcm9taXNlPHsgaW1hZ2VEYXRhOiBVaW50OEFycmF5LCBzdG9yYWdlQnVmZmVyOiBHUFVCdWZmZXIgfT47XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGV4dHVyZVRvQXJyYXlCdWZmZXIoe1xyXG4gICAgZGV2aWNlLFxyXG4gICAgdGV4dHVyZSxcclxuICAgIG1pcExldmVsID0gMCxcclxuICAgIHJldHVybkJ1ZmZlcixcclxuICAgIHN0b3JhZ2VCdWZmZXIsXHJcbiAgICByZXN1bHRCdWZmZXIsXHJcbiAgICBkZXNjcmlwdGlvbixcclxufTogVGV4dHVyZVRvQXJyYXlCdWZmZXJPcHRpb25zKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnN0IGZ1bGxEZXNjcmlwdGlvbiA9IHBhZFRlbXBsYXRlYFt0ZXh0dXJlVG9LVFgke2Rlc2NyaXB0aW9uID8/ICcnfSR7dGV4dHVyZS5sYWJlbH1dIC0tYDtcclxuXHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBmb3JtYXQgJHt0ZXh0dXJlLmZvcm1hdH0gdW5zdXBwb3J0ZWRgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB3aWR0aCA9IHRleHR1cmUud2lkdGggPj4gbWlwTGV2ZWw7XHJcbiAgICBjb25zdCBoZWlnaHQgPSB0ZXh0dXJlLmhlaWdodCA+PiBtaXBMZXZlbDtcclxuICAgIGNvbnN0IHJhd0J5dGVzUGVyUm93ID0gd2lkdGggKiBwaXhlbFNpemU7XHJcbiAgICBjb25zdCBieXRlc1BlclJvdyA9IE1hdGgubWF4KHJhd0J5dGVzUGVyUm93LCAyNTYpO1xyXG4gICAgY29uc3Qgcm93c1BlckltYWdlID0gaGVpZ2h0O1xyXG4gICAgY29uc3QgYnl0ZVNpemUgPSByb3dzUGVySW1hZ2UgKiBieXRlc1BlclJvdyAqIHRleHR1cmUuZGVwdGhPckFycmF5TGF5ZXJzO1xyXG4gICAgY29uc3QgcmVzdWx0U2l6ZSA9IHJhd0J5dGVzUGVyUm93ICogaGVpZ2h0ICogdGV4dHVyZS5kZXB0aE9yQXJyYXlMYXllcnM7XHJcblxyXG4gICAgaWYgKHJlc3VsdEJ1ZmZlciAhPSBudWxsICYmIHJlc3VsdEJ1ZmZlci5ieXRlTGVuZ3RoIDwgYnl0ZVNpemUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBnaXZlbiByZXN1bHQgYXJyYXkgbm90IGxhcmdlIGVub3VnaC5cclxuJHtyZXN1bHRCdWZmZXIuYnl0ZUxlbmd0aH0gPCAke2J5dGVTaXplfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdG9yYWdlQnVmZmVyICE9IG51bGwgJiYgc3RvcmFnZUJ1ZmZlci5zaXplIDwgYnl0ZVNpemUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBnaXZlbiBzdG9yYWdlIGJ1ZmZlciBub3QgbGFyZ2UgZW5vdWdoLlxyXG4ke3N0b3JhZ2VCdWZmZXIuc2l6ZX0gPCAke2J5dGVTaXplfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlcXVpcmVkVXNhZ2UgPSBHUFVCdWZmZXJVc2FnZS5DT1BZX0RTVCB8IEdQVUJ1ZmZlclVzYWdlLk1BUF9SRUFEO1xyXG5cclxuICAgIGlmIChzdG9yYWdlQnVmZmVyICE9IG51bGwgJiYgKHN0b3JhZ2VCdWZmZXIudXNhZ2UgJiByZXF1aXJlZFVzYWdlKSAhPT0gcmVxdWlyZWRVc2FnZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtmdWxsRGVzY3JpcHRpb259IGdpdmVuIHN0b3JhZ2UgZG9lcyBub3QgaGF2ZSBjb3JyZWN0IHVzYWdlIGZsYWdzLlxyXG5HaXZlbjogJHtzdG9yYWdlQnVmZmVyLnVzYWdlfVxyXG5SZXF1aXJlZDogJHtyZXF1aXJlZFVzYWdlfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBpbWFnZURhdGEgPSByZXN1bHRCdWZmZXIgPz8gbmV3IFVpbnQ4QXJyYXkoYnl0ZVNpemUpO1xyXG4gICAgY29uc3Qgc3RvcmFnZSA9IHN0b3JhZ2VCdWZmZXIgPz8gZGV2aWNlLmNyZWF0ZUJ1ZmZlcih7XHJcbiAgICAgICAgbGFiZWw6IGAke2Z1bGxEZXNjcmlwdGlvbn0gc3RvcmFnZSBidWZmZXJgLFxyXG4gICAgICAgIHNpemU6IGJ5dGVTaXplLFxyXG4gICAgICAgIHVzYWdlOiByZXF1aXJlZFVzYWdlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgZW5jb2RlciA9IGRldmljZS5jcmVhdGVDb21tYW5kRW5jb2Rlcih7IGxhYmVsOiBgJHtmdWxsRGVzY3JpcHRpb259IGVuY29kZXJgIH0pO1xyXG4gICAgZW5jb2Rlci5jb3B5VGV4dHVyZVRvQnVmZmVyKFxyXG4gICAgICAgIHsgdGV4dHVyZSwgbWlwTGV2ZWwgfSxcclxuICAgICAgICB7IGJ1ZmZlcjogc3RvcmFnZSwgcm93c1BlckltYWdlLCBieXRlc1BlclJvdyB9LFxyXG4gICAgICAgIHsgd2lkdGgsIGhlaWdodCwgZGVwdGhPckFycmF5TGF5ZXJzOiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyB9LFxyXG4gICAgKTtcclxuICAgIGRldmljZS5xdWV1ZS5zdWJtaXQoW2VuY29kZXIuZmluaXNoKCldKTtcclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgc3RvcmFnZS5tYXBBc3luYyhHUFVNYXBNb2RlLlJFQUQsIDAsIGJ5dGVTaXplKSxcclxuICAgICAgICBkZXZpY2UucXVldWUub25TdWJtaXR0ZWRXb3JrRG9uZSgpLFxyXG4gICAgXSk7XHJcblxyXG4gICAgY29uc3QgbWFwcGVkID0gc3RvcmFnZS5nZXRNYXBwZWRSYW5nZSgwLCBieXRlU2l6ZSk7XHJcbiAgICBpbWFnZURhdGEuc2V0KG5ldyBVaW50OEFycmF5KG1hcHBlZCkpO1xyXG4gICAgc3RvcmFnZS51bm1hcCgpO1xyXG5cclxuICAgIGlmIChieXRlc1BlclJvdyA+IHJhd0J5dGVzUGVyUm93KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaCA9IDA7IGggPCBoZWlnaHQgKiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVyczsgaCArPSAxKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHcgPSAwOyB3IDwgcmF3Qnl0ZXNQZXJSb3c7IHcgKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhW3cgKyBoICogcmF3Qnl0ZXNQZXJSb3ddID0gaW1hZ2VEYXRhW3cgKyBoICogYnl0ZXNQZXJSb3ddO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGltYWdlRGF0YSA9IGltYWdlRGF0YS5zbGljZSgwLCByZXN1bHRTaXplKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGltYWdlRGF0YSxcclxuICAgICAgICBzdG9yYWdlQnVmZmVyOiByZXR1cm5CdWZmZXIgPyBzdG9yYWdlIDogdW5kZWZpbmVkLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRleHR1cmVUb0tUWChkZXZpY2U6IEdQVURldmljZSwgdGV4dHVyZTogR1BVVGV4dHVyZSwgY3ViZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnN0IHR5cGVTaXplID0gVGV4dHVyZUZvcm1hdFRvQ2hhbm5lbFNpemVbdGV4dHVyZS5mb3JtYXRdO1xyXG5cclxuICAgIGlmIChwaXhlbFNpemUgPT0gbnVsbCB8fCB0eXBlU2l6ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB0ZXh0dXJlVG9LVFggLS0gZm9ybWF0ICR7dGV4dHVyZS5mb3JtYXR9IG9mICR7dGV4dHVyZS5sYWJlbH0gdW5zdXBwb3J0ZWRgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjb250YWluZXIgPSBuZXcga3R4cGFyc2UuS1RYMkNvbnRhaW5lcigpO1xyXG4gICAgY29udGFpbmVyLnBpeGVsV2lkdGggPSB0ZXh0dXJlLndpZHRoO1xyXG4gICAgY29udGFpbmVyLnBpeGVsSGVpZ2h0ID0gdGV4dHVyZS5oZWlnaHQ7XHJcbiAgICBjb250YWluZXIudmtGb3JtYXQgPSBXZWJHUFVUb1ZrRm9ybWF0W3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnRhaW5lci50eXBlU2l6ZSA9IHR5cGVTaXplO1xyXG4gICAgZGVsZXRlIGNvbnRhaW5lci5rZXlWYWx1ZS5LVFhzd2l6emxlO1xyXG5cclxuICAgIGNvbnN0IGRhdGFGb3JtYXQgPSBjb250YWluZXIuZGF0YUZvcm1hdERlc2NyaXB0b3JbMF07XHJcbiAgICBkYXRhRm9ybWF0LmNvbG9yTW9kZWwgPSBrdHhwYXJzZS5LSFJfREZfTU9ERUxfUkdCU0RBO1xyXG4gICAgZGF0YUZvcm1hdC50cmFuc2ZlckZ1bmN0aW9uID0ga3R4cGFyc2UuS0hSX0RGX1RSQU5TRkVSX0xJTkVBUjtcclxuICAgIGRhdGFGb3JtYXQuYnl0ZXNQbGFuZVswXSA9IHBpeGVsU2l6ZTtcclxuXHJcbiAgICBkYXRhRm9ybWF0LnNhbXBsZXMgPSBbMCwgMSwgMiwgM10ubWFwKChpKSA9PiAoe1xyXG4gICAgICAgIGNoYW5uZWxUeXBlOiBbMTkyLCAxOTMsIDE5NCwgMjA3XVtpXSxcclxuICAgICAgICBzYW1wbGVQb3NpdGlvbjogWzAsIDAsIDAsIDBdLFxyXG4gICAgICAgIGJpdExlbmd0aDogY29udGFpbmVyLnR5cGVTaXplICogOCAtIDEsXHJcbiAgICAgICAgYml0T2Zmc2V0OiBjb250YWluZXIudHlwZVNpemUgKiA4ICogaSxcclxuICAgICAgICBzYW1wbGVMb3dlcjogLTEwODIxMzA0MzIsXHJcbiAgICAgICAgc2FtcGxlVXBwZXI6IDEwNjUzNTMyMTYsXHJcbiAgICB9KSk7XHJcblxyXG4gICAgaWYgKHRleHR1cmUuZGltZW5zaW9uID09PSAnM2QnKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDE7XHJcbiAgICAgICAgY29udGFpbmVyLnBpeGVsRGVwdGggPSB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycztcclxuICAgIH0gZWxzZSBpZiAoY3ViZSkge1xyXG4gICAgICAgIGNvbnN0IGN1YmVMYXllcnMgPSB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyAvIDY7XHJcbiAgICAgICAgY29udGFpbmVyLmxheWVyQ291bnQgPSBjdWJlTGF5ZXJzID09PSAxID8gMCA6IGN1YmVMYXllcnM7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDY7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnRhaW5lci5sYXllckNvdW50ID0gdGV4dHVyZS5kZXB0aE9yQXJyYXlMYXllcnM7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHN0b3JhZ2VCdWZmZXI6IEdQVUJ1ZmZlciB8IHVuZGVmaW5lZDtcclxuICAgIGxldCBpbWFnZURhdGE6IFVpbnQ4QXJyYXk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0dXJlLm1pcExldmVsQ291bnQ7IGkgKz0gMSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29wXHJcbiAgICAgICAgKHsgaW1hZ2VEYXRhLCBzdG9yYWdlQnVmZmVyIH0gPSBhd2FpdCB0ZXh0dXJlVG9BcnJheUJ1ZmZlcih7XHJcbiAgICAgICAgICAgIG1pcExldmVsOiBpLFxyXG4gICAgICAgICAgICByZXR1cm5CdWZmZXI6IHRydWUsXHJcbiAgICAgICAgICAgIGRldmljZSxcclxuICAgICAgICAgICAgdGV4dHVyZSxcclxuICAgICAgICAgICAgc3RvcmFnZUJ1ZmZlcixcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lci5sZXZlbHMucHVzaCh7XHJcbiAgICAgICAgICAgIGxldmVsRGF0YTogaW1hZ2VEYXRhLFxyXG4gICAgICAgICAgICB1bmNvbXByZXNzZWRCeXRlTGVuZ3RoOiBpbWFnZURhdGEuYnl0ZUxlbmd0aCxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga3R4cGFyc2Uud3JpdGUoY29udGFpbmVyKTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///6182\n")},2253:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   y: () => (/* binding */ parseHDR)\n/* harmony export */ });\n/* unused harmony export imageToTexture */\n/* harmony import */ var _data_conversion__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4955);\n/* harmony import */ var _texture_processing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7335);\n\n\nasync function imageToTexture({ device, data, mimeType, usage = GPUTextureUsage.TEXTURE_BINDING, mips = true, format = 'rgba8unorm', colorSpace = 'srgb', label = '', srgbToLinear, }) {\n    const blob = new Blob([data], { type: mimeType });\n    const bitmap = await createImageBitmap(blob, { colorSpaceConversion: 'none' });\n    const size = { width: bitmap.width, height: bitmap.height };\n    const texture = device.createTexture({\n        label,\n        format,\n        size: size,\n        usage: usage | GPUTextureUsage.COPY_DST | GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n        mipLevelCount: mips ? 1 + (Math.log2(Math.max(bitmap.width, bitmap.height)) | 0) : 1,\n    });\n    device.queue.copyExternalImageToTexture({ source: bitmap }, { texture, colorSpace }, size);\n    if (srgbToLinear)\n        srgbTextureToLinear(device, texture);\n    if (mips)\n        void generateMips(device, texture);\n    return texture;\n}\nfunction parseHDR(inData) {\n    const decoder = new TextDecoder();\n    const buffer = inData instanceof Uint8Array ? inData : new Uint8Array(inData);\n    let pos = 0;\n    const getLine = (lineLimit = 1024) => {\n        const limit = Math.min(buffer.length, lineLimit + pos);\n        const sub = buffer.subarray(pos, limit);\n        const end = sub.indexOf(0x0A) + 1;\n        pos += end;\n        return end === 0 ? undefined : decoder.decode(sub.subarray(0, end));\n    };\n    const importError = (msg) => new Error('HDR Import Error: ' + msg);\n    // #region Read Header\n    const magicTokenRegex = /^#\\?(\\S+)/;\n    const magicTokenLine = getLine();\n    if (magicTokenLine == null)\n        throw importError('no header found');\n    if (!magicTokenRegex.test(magicTokenLine))\n        throw importError('bad initial token');\n    const headerRegs = [\n        /FORMAT=(?<format>\\S+)/, // format\n        /-Y\\s+(?<Y>\\d+)\\s+\\+X\\s+(?<X>\\d+)/, // size\n        /EXPOSURE\\s*=\\s*(?<exposure>\\d+(\\.\\d+)?)/, // exposure\n        /GAMMA\\s*=\\s*(?<gamma>\\d+(\\.\\d+)?)/, // gamma\n    ];\n    const headerReg = new RegExp(`^\\\\s*(${headerRegs.map(({ source }) => `(${source})`).join('|')})\\\\s*$`);\n    let noFormat = true;\n    let gamma = 1; /* a value of 1.0 in an image corresponds to <exposure> watts/steradian/m^2. defaults to 1.0 */\n    let exposure = 1; /* image has already been gamma corrected with given gamma. defaults to 1.0 (no correction) */\n    let width = undefined;\n    let height = undefined;\n    for (let line = getLine(); line != null; line = width == null ? getLine() : undefined) {\n        const groups = line.match(headerReg)?.groups;\n        if (groups == null)\n            continue;\n        if (groups.format != null) {\n            noFormat = false;\n        }\n        else if (groups.X != null && groups.Y != null) {\n            width = parseInt(groups.X);\n            height = parseInt(groups.Y);\n        }\n        else if (groups.gamma != null) {\n            gamma = parseFloat(groups.gamma);\n        }\n        else if (groups.exposure != null) {\n            exposure = parseFloat(groups.exposure);\n        }\n    }\n    if (noFormat)\n        throw importError('missing format specifier');\n    if (width == null || height == null)\n        throw importError('missing image size specifier');\n    // #endregion\n    // #region Read Scanline Data\n    let rawData;\n    const unencodable = width < 8 || width > 0x7fff;\n    const flatData = buffer[pos] !== 2 || buffer[pos + 1] !== 2 || (buffer[pos + 2] & 0x80) !== 0;\n    if (unencodable || flatData) {\n        rawData = buffer.subarray(pos);\n    }\n    else {\n        rawData = new Uint8Array(width * height * 4);\n        const end = 4 * width;\n        const scanline_buffer = new Uint8Array(end);\n        const len = buffer.byteLength;\n        for (let k = 0, offset = 0; k < height && pos < len; k++) {\n            if (pos + 4 > len)\n                throw importError('file ended durning scanline');\n            if ((2 != buffer[pos++]) || (2 != buffer[pos++]) || (((buffer[pos++] << 8) | buffer[pos++]) != width))\n                throw importError('bad rgbe scanline format');\n            let count;\n            for (let ptr = 0; ptr < end && pos < len; ptr += count) {\n                count = buffer[pos++];\n                const isEncodedRun = count > 128;\n                if (isEncodedRun)\n                    count -= 128;\n                if (count == 0 || ptr + count > end)\n                    throw importError('bad scanline data');\n                if (isEncodedRun) {\n                    scanline_buffer.fill(buffer[pos], ptr, ptr + count);\n                    pos += 1;\n                }\n                else {\n                    scanline_buffer.set(buffer.subarray(pos, pos + count), ptr);\n                    pos += count;\n                }\n            }\n            for (let i = 0; i < width; i++)\n                for (let j = 0; j < end; j += width)\n                    rawData[offset++] = scanline_buffer[i + j];\n        }\n    }\n    // #endregion\n    // #region Convert to Float16\n    const data = new Uint16Array(rawData.length);\n    const float16One = (0,_data_conversion__WEBPACK_IMPORTED_MODULE_0__/* .toFloat16Bytes */ .Q)(1);\n    for (let i = 0; i < width * height * 4; i += 4) {\n        const raw_e = rawData[i + 3];\n        const scale = Math.pow(2.0, raw_e - 128.0) / 255.0;\n        for (let j = 0; j < 3; j += 1) {\n            data[i + j] = (0,_data_conversion__WEBPACK_IMPORTED_MODULE_0__/* .toFloat16Bytes */ .Q)(Math.min(rawData[i + j] * scale, 65504));\n        }\n        data[i + 3] = float16One;\n    }\n    // #endregion\n    return { data, width, height, gamma, exposure };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7SUFDN0MsTUFBTSxVQUFVLEdBQUcseUVBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVyQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxHQUFHLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQzdDLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDN0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxHQUFHLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUVuRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLHlFQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFFLENBQUM7UUFDRCxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQztJQUM3QixDQUFDO0lBQ0QsYUFBYTtJQUViLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUM7QUFDcEQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy91dGlscy90ZXh0dXJlLWltcG9ydGluZy50cz80MjUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRvRmxvYXQxNkJ5dGVzIH0gZnJvbSAnLi9kYXRhLWNvbnZlcnNpb24nO1xuaW1wb3J0IHsgc3JnYlRleHR1cmVUb0xpbmVhciwgZ2VuZXJhdGVNaXBzIH0gZnJvbSAnLi90ZXh0dXJlLXByb2Nlc3NpbmcnO1xuXG5leHBvcnQgdHlwZSBpbWFnZVRvVGV4dHVyZURlc2NyaXB0b3IgPSB7XG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXG4gICAgZGF0YTogVWludDhBcnJheSxcbiAgICBtaW1lVHlwZT86IHN0cmluZyxcbiAgICBsYWJlbD86IHN0cmluZyxcbiAgICB1c2FnZT86IG51bWJlcixcbiAgICBmb3JtYXQ/OiBHUFVUZXh0dXJlRm9ybWF0LFxuICAgIG1pcHM/OiBib29sZWFuLFxuICAgIHNyZ2JUb0xpbmVhcj86IGJvb2xlYW4sXG4gICAgY29sb3JTcGFjZT86IFByZWRlZmluZWRDb2xvclNwYWNlLFxufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltYWdlVG9UZXh0dXJlKHtcbiAgICBkZXZpY2UsXG4gICAgZGF0YSxcbiAgICBtaW1lVHlwZSxcbiAgICB1c2FnZSA9IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcsXG4gICAgbWlwcyA9IHRydWUsXG4gICAgZm9ybWF0ID0gJ3JnYmE4dW5vcm0nLFxuICAgIGNvbG9yU3BhY2UgPSAnc3JnYicsXG4gICAgbGFiZWwgPSAnJyxcbiAgICBzcmdiVG9MaW5lYXIsXG59OiBpbWFnZVRvVGV4dHVyZURlc2NyaXB0b3IpIHtcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7IHR5cGU6IG1pbWVUeXBlIH0pO1xuICAgIGNvbnN0IGJpdG1hcCA9IGF3YWl0IGNyZWF0ZUltYWdlQml0bWFwKGJsb2IsIHsgY29sb3JTcGFjZUNvbnZlcnNpb246ICdub25lJyB9KTtcbiAgICBjb25zdCBzaXplID0geyB3aWR0aDogYml0bWFwLndpZHRoLCBoZWlnaHQ6IGJpdG1hcC5oZWlnaHQgfTtcblxuICAgIGNvbnN0IHRleHR1cmUgPSBkZXZpY2UuY3JlYXRlVGV4dHVyZSh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBmb3JtYXQsXG4gICAgICAgIHNpemU6IHNpemUsXG4gICAgICAgIHVzYWdlOiB1c2FnZSB8IEdQVVRleHR1cmVVc2FnZS5DT1BZX0RTVCB8IEdQVVRleHR1cmVVc2FnZS5DT1BZX1NSQyB8IEdQVVRleHR1cmVVc2FnZS5SRU5ERVJfQVRUQUNITUVOVCxcbiAgICAgICAgbWlwTGV2ZWxDb3VudDogbWlwcyA/IDEgKyAoTWF0aC5sb2cyKE1hdGgubWF4KGJpdG1hcC53aWR0aCwgYml0bWFwLmhlaWdodCkpIHwgMCkgOiAxLFxuICAgIH0pO1xuXG4gICAgZGV2aWNlLnF1ZXVlLmNvcHlFeHRlcm5hbEltYWdlVG9UZXh0dXJlKFxuICAgICAgICB7IHNvdXJjZTogYml0bWFwIH0sXG4gICAgICAgIHsgdGV4dHVyZSwgY29sb3JTcGFjZSB9LFxuICAgICAgICBzaXplLFxuICAgICk7XG5cbiAgICBpZiAoc3JnYlRvTGluZWFyKSBzcmdiVGV4dHVyZVRvTGluZWFyKGRldmljZSwgdGV4dHVyZSk7XG4gICAgaWYgKG1pcHMpIHZvaWQgZ2VuZXJhdGVNaXBzKGRldmljZSwgdGV4dHVyZSk7XG5cbiAgICByZXR1cm4gdGV4dHVyZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSERSKGluRGF0YTogVWludDhBcnJheSB8IEFycmF5QnVmZmVyKSB7XG4gICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgIGNvbnN0IGJ1ZmZlciA9IGluRGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkgPyBpbkRhdGEgOiBuZXcgVWludDhBcnJheShpbkRhdGEpO1xuICAgIGxldCBwb3MgPSAwO1xuXG4gICAgY29uc3QgZ2V0TGluZSA9IChsaW5lTGltaXQgPSAxMDI0KSA9PiB7XG4gICAgICAgIGNvbnN0IGxpbWl0ID0gTWF0aC5taW4oYnVmZmVyLmxlbmd0aCwgbGluZUxpbWl0ICsgcG9zKTtcbiAgICAgICAgY29uc3Qgc3ViID0gYnVmZmVyLnN1YmFycmF5KHBvcywgbGltaXQpO1xuICAgICAgICBjb25zdCBlbmQgPSBzdWIuaW5kZXhPZigweDBBKSArIDE7XG4gICAgICAgIHBvcyArPSBlbmQ7XG4gICAgICAgIHJldHVybiBlbmQgPT09IDAgPyB1bmRlZmluZWQgOiBkZWNvZGVyLmRlY29kZShzdWIuc3ViYXJyYXkoMCwgZW5kKSk7XG4gICAgfTtcblxuICAgIGNvbnN0IGltcG9ydEVycm9yID0gKG1zZzogc3RyaW5nKSA9PiBuZXcgRXJyb3IoJ0hEUiBJbXBvcnQgRXJyb3I6ICcgKyBtc2cpO1xuXG4gICAgLy8gI3JlZ2lvbiBSZWFkIEhlYWRlclxuICAgIGNvbnN0IG1hZ2ljVG9rZW5SZWdleCA9IC9eI1xcPyhcXFMrKS87XG4gICAgY29uc3QgbWFnaWNUb2tlbkxpbmUgPSBnZXRMaW5lKCk7XG5cbiAgICBpZiAobWFnaWNUb2tlbkxpbmUgPT0gbnVsbCkgdGhyb3cgaW1wb3J0RXJyb3IoJ25vIGhlYWRlciBmb3VuZCcpO1xuICAgIGlmICghbWFnaWNUb2tlblJlZ2V4LnRlc3QobWFnaWNUb2tlbkxpbmUpKSB0aHJvdyBpbXBvcnRFcnJvcignYmFkIGluaXRpYWwgdG9rZW4nKTtcblxuICAgIGNvbnN0IGhlYWRlclJlZ3MgPSBbXG4gICAgICAgIC9GT1JNQVQ9KD88Zm9ybWF0PlxcUyspLywgLy8gZm9ybWF0XG4gICAgICAgIC8tWVxccysoPzxZPlxcZCspXFxzK1xcK1hcXHMrKD88WD5cXGQrKS8sIC8vIHNpemVcbiAgICAgICAgL0VYUE9TVVJFXFxzKj1cXHMqKD88ZXhwb3N1cmU+XFxkKyhcXC5cXGQrKT8pLywgLy8gZXhwb3N1cmVcbiAgICAgICAgL0dBTU1BXFxzKj1cXHMqKD88Z2FtbWE+XFxkKyhcXC5cXGQrKT8pLywgLy8gZ2FtbWFcbiAgICBdO1xuXG4gICAgY29uc3QgaGVhZGVyUmVnID0gbmV3IFJlZ0V4cChgXlxcXFxzKigke1xuICAgICAgICBoZWFkZXJSZWdzLm1hcCgoeyBzb3VyY2UgfSkgPT4gYCgke3NvdXJjZX0pYCkuam9pbignfCcpXG4gICAgfSlcXFxccyokYCk7XG5cbiAgICBsZXQgbm9Gb3JtYXQgPSB0cnVlO1xuICAgIGxldCBnYW1tYSA9IDE7IC8qIGEgdmFsdWUgb2YgMS4wIGluIGFuIGltYWdlIGNvcnJlc3BvbmRzIHRvIDxleHBvc3VyZT4gd2F0dHMvc3RlcmFkaWFuL21eMi4gZGVmYXVsdHMgdG8gMS4wICovXG4gICAgbGV0IGV4cG9zdXJlID0gMTsgLyogaW1hZ2UgaGFzIGFscmVhZHkgYmVlbiBnYW1tYSBjb3JyZWN0ZWQgd2l0aCBnaXZlbiBnYW1tYS4gZGVmYXVsdHMgdG8gMS4wIChubyBjb3JyZWN0aW9uKSAqL1xuICAgIGxldCB3aWR0aDogbnVtYmVyIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgIGxldCBoZWlnaHQ6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICAgIGZvciAobGV0IGxpbmUgPSBnZXRMaW5lKCk7IGxpbmUgIT0gbnVsbDsgbGluZSA9IHdpZHRoID09IG51bGwgPyBnZXRMaW5lKCkgOiB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gbGluZS5tYXRjaChoZWFkZXJSZWcpPy5ncm91cHMgYXMgUGFydGlhbDxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+PiB8IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGdyb3VwcyA9PSBudWxsKSBjb250aW51ZTtcblxuICAgICAgICBpZiAoZ3JvdXBzLmZvcm1hdCAhPSBudWxsKSB7XG4gICAgICAgICAgICBub0Zvcm1hdCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKGdyb3Vwcy5YICE9IG51bGwgJiYgZ3JvdXBzLlkgIT0gbnVsbCkge1xuICAgICAgICAgICAgd2lkdGggPSBwYXJzZUludChncm91cHMuWCk7XG4gICAgICAgICAgICBoZWlnaHQgPSBwYXJzZUludChncm91cHMuWSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZ3JvdXBzLmdhbW1hICE9IG51bGwpIHtcbiAgICAgICAgICAgIGdhbW1hID0gcGFyc2VGbG9hdChncm91cHMuZ2FtbWEpO1xuICAgICAgICB9IGVsc2UgaWYgKGdyb3Vwcy5leHBvc3VyZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBleHBvc3VyZSA9IHBhcnNlRmxvYXQoZ3JvdXBzLmV4cG9zdXJlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChub0Zvcm1hdCkgdGhyb3cgaW1wb3J0RXJyb3IoJ21pc3NpbmcgZm9ybWF0IHNwZWNpZmllcicpO1xuICAgIGlmICh3aWR0aCA9PSBudWxsIHx8IGhlaWdodCA9PSBudWxsKSB0aHJvdyBpbXBvcnRFcnJvcignbWlzc2luZyBpbWFnZSBzaXplIHNwZWNpZmllcicpO1xuICAgIC8vICNlbmRyZWdpb25cblxuICAgIC8vICNyZWdpb24gUmVhZCBTY2FubGluZSBEYXRhXG4gICAgbGV0IHJhd0RhdGE6IFVpbnQ4QXJyYXk7XG4gICAgY29uc3QgdW5lbmNvZGFibGUgPSB3aWR0aCA8IDggfHwgd2lkdGggPiAweDdmZmY7XG4gICAgY29uc3QgZmxhdERhdGEgPSBidWZmZXJbcG9zXSAhPT0gMiB8fCBidWZmZXJbcG9zICsgMV0gIT09IDIgfHwgKGJ1ZmZlcltwb3MgKyAyXSAmIDB4ODApICE9PSAwO1xuXG4gICAgaWYgKHVuZW5jb2RhYmxlIHx8IGZsYXREYXRhKSB7XG4gICAgICAgIHJhd0RhdGEgPSBidWZmZXIuc3ViYXJyYXkocG9zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByYXdEYXRhID0gbmV3IFVpbnQ4QXJyYXkod2lkdGggKiBoZWlnaHQgKiA0KTtcbiAgICAgICAgY29uc3QgZW5kID0gNCAqIHdpZHRoO1xuICAgICAgICBjb25zdCBzY2FubGluZV9idWZmZXIgPSBuZXcgVWludDhBcnJheShlbmQpO1xuICAgICAgICBjb25zdCBsZW4gPSBidWZmZXIuYnl0ZUxlbmd0aDtcblxuICAgICAgICBmb3IgKGxldCBrID0gMCwgb2Zmc2V0ID0gMDsgayA8IGhlaWdodCAmJiBwb3MgPCBsZW47IGsrKykge1xuICAgICAgICAgICAgaWYgKHBvcyArIDQgPiBsZW4pXG4gICAgICAgICAgICAgICAgdGhyb3cgaW1wb3J0RXJyb3IoJ2ZpbGUgZW5kZWQgZHVybmluZyBzY2FubGluZScpO1xuXG4gICAgICAgICAgICBpZiAoKDIgIT0gYnVmZmVyW3BvcysrXSkgfHwgKDIgIT0gYnVmZmVyW3BvcysrXSkgfHwgKCgoYnVmZmVyW3BvcysrXSA8PCA4KSB8IGJ1ZmZlcltwb3MrK10pICE9IHdpZHRoKSlcbiAgICAgICAgICAgICAgICB0aHJvdyBpbXBvcnRFcnJvcignYmFkIHJnYmUgc2NhbmxpbmUgZm9ybWF0Jyk7XG5cbiAgICAgICAgICAgIGxldCBjb3VudDtcbiAgICAgICAgICAgIGZvciAobGV0IHB0ciA9IDA7IHB0ciA8IGVuZCAmJiBwb3MgPCBsZW47IHB0ciArPSBjb3VudCkge1xuICAgICAgICAgICAgICAgIGNvdW50ID0gYnVmZmVyW3BvcysrXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0VuY29kZWRSdW4gPSBjb3VudCA+IDEyODtcbiAgICAgICAgICAgICAgICBpZiAoaXNFbmNvZGVkUnVuKSBjb3VudCAtPSAxMjg7XG5cbiAgICAgICAgICAgICAgICBpZiAoY291bnQgPT0gMCB8fCBwdHIgKyBjb3VudCA+IGVuZClcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgaW1wb3J0RXJyb3IoJ2JhZCBzY2FubGluZSBkYXRhJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNFbmNvZGVkUnVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYW5saW5lX2J1ZmZlci5maWxsKGJ1ZmZlcltwb3NdLCBwdHIsIHB0ciArIGNvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgcG9zICs9IDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbmxpbmVfYnVmZmVyLnNldChidWZmZXIuc3ViYXJyYXkocG9zLCBwb3MgKyBjb3VudCksIHB0cik7XG4gICAgICAgICAgICAgICAgICAgIHBvcyArPSBjb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2lkdGg7IGkrKylcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGVuZDsgaiArPSB3aWR0aClcbiAgICAgICAgICAgICAgICAgICAgcmF3RGF0YVtvZmZzZXQrK10gPSBzY2FubGluZV9idWZmZXJbaSArIGpdO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vICNlbmRyZWdpb25cblxuICAgIC8vICNyZWdpb24gQ29udmVydCB0byBGbG9hdDE2XG4gICAgY29uc3QgZGF0YSA9IG5ldyBVaW50MTZBcnJheShyYXdEYXRhLmxlbmd0aCk7XG4gICAgY29uc3QgZmxvYXQxNk9uZSA9IHRvRmxvYXQxNkJ5dGVzKDEpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3aWR0aCAqIGhlaWdodCAqIDQ7IGkgKz0gNCkge1xuICAgICAgICBjb25zdCByYXdfZSA9IHJhd0RhdGFbaSArIDNdO1xuICAgICAgICBjb25zdCBzY2FsZSA9IE1hdGgucG93KDIuMCwgcmF3X2UgLSAxMjguMCkgLyAyNTUuMDtcblxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGogKz0gMSkge1xuICAgICAgICAgICAgZGF0YVtpICsgal0gPSB0b0Zsb2F0MTZCeXRlcyhNYXRoLm1pbihyYXdEYXRhW2kgKyBqXSAqIHNjYWxlLCA2NTUwNCkpO1xuICAgICAgICB9XG4gICAgICAgIGRhdGFbaSArIDNdID0gZmxvYXQxNk9uZTtcbiAgICB9XG4gICAgLy8gI2VuZHJlZ2lvblxuXG4gICAgcmV0dXJuIHsgZGF0YSwgd2lkdGgsIGhlaWdodCwgZ2FtbWEsIGV4cG9zdXJlIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2253\n")},7335:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   l3: () => (/* binding */ equirectangularToCubemap)\n/* harmony export */ });\n/* unused harmony exports generateMips, srgbTextureToLinear */\n/* harmony import */ var _shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7959);\n/* harmony import */ var _shaders_cubemap_sampling_shader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(423);\n/* harmony import */ var _data_copy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6182);\n/* harmony import */ var _general__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(80);\n\n\n\n\nasync function equirectangularToCubemap(device, { data, width, height, gamma = 1, exposure = 1 }, outputDescriptor) {\n    const code = /* wgsl */ `\n        override EXPOSURE: f32 = 1.0;\n        override GAMMA: f32 = 1.0;\n        override FLIP_Y: bool = false;\n\n        @group(0) @binding(0) var equirectangularMap: texture_2d<f32>;\n        @group(0) @binding(1) var mapSampler: sampler;\n        @group(0) @binding(2) var<uniform> face: u32;\n\n        fn sampleSphericalMap(v: vec3f) -> vec2f {\n            const invAtan = vec2(0.1591, 0.3183);\n\n            var uv = vec2(atan2(v.z, v.x), asin(v.y));\n            uv *= invAtan;\n            uv += 0.5;\n            return uv;\n        }\n \n        ${_shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A}\n        ${_shaders_cubemap_sampling_shader__WEBPACK_IMPORTED_MODULE_2__/* .toWorldDir */ .V}\n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f {\n            var dir = toWorldDirF32(uv, face);\n            dir = vec3(dir.z, dir.y, -dir.x);\n            var coord = sampleSphericalMap(dir);\n            if (FLIP_Y) { coord.y = 1 - coord.y; }\n\n            var color = textureSample(equirectangularMap, mapSampler, coord).rgb;\n            if (GAMMA != 1.0) { color = pow(color, vec3(1.0 / GAMMA)); }\n            if (EXPOSURE != 1.0) { color /= EXPOSURE; }\n            return vec4(color, 1.0);\n        }\n    `;\n    let FLIP_Y = 0;\n    let equirectangular;\n    if (data instanceof GPUTexture) {\n        equirectangular = data;\n    }\n    else {\n        FLIP_Y = 1;\n        equirectangular = device.createTexture({\n            label: `${outputDescriptor.label} equirectangular`,\n            dimension: '2d',\n            format: 'rgba16float',\n            size: { width, height },\n            usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n        });\n        device.queue.writeTexture({ texture: equirectangular, mipLevel: 0 }, data, { bytesPerRow: width * 2 * 4 }, { width, height, depthOrArrayLayers: 1 });\n        await device.queue.onSubmittedWorkDone();\n    }\n    const faceSize = equirectangular.height >> 1;\n    const cubemapDescriptor = outputDescriptor;\n    cubemapDescriptor.mipLevelCount ??= Math.log2(faceSize) | 0;\n    cubemapDescriptor.size = { width: faceSize, height: faceSize, depthOrArrayLayers: 6 };\n    cubemapDescriptor.dimension = '2d';\n    cubemapDescriptor.usage |= GPUTextureUsage.RENDER_ATTACHMENT;\n    const cubemap = device.createTexture(cubemapDescriptor);\n    const label = (0,_general__WEBPACK_IMPORTED_MODULE_3__/* .padTemplate */ .OY) `hdr copy${outputDescriptor.label}`;\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 2,\n                buffer: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const module = device.createShaderModule({ label, code });\n    const sampler = device.createSampler({ label, minFilter: 'linear', magFilter: 'linear' });\n    const params = new Uint32Array(1);\n    const paramBuffer = (0,_data_copy__WEBPACK_IMPORTED_MODULE_0__/* .createAndCopyBuffer */ .Lr)(params, GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM, device, label);\n    const bindgroup = device.createBindGroup({\n        label,\n        layout: bindgroupLayout,\n        entries: [\n            { binding: 0, resource: equirectangular.createView() },\n            { binding: 1, resource: sampler },\n            { binding: 2, resource: { buffer: paramBuffer } },\n        ],\n    });\n    const pipelineLayout = device.createPipelineLayout({\n        label,\n        bindGroupLayouts: [bindgroupLayout],\n    });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: { module },\n        fragment: {\n            module,\n            targets: [{ format: cubemap.format }],\n            constants: {\n                GAMMA: gamma,\n                EXPOSURE: exposure,\n                FLIP_Y,\n            },\n        },\n    });\n    for (let i = 0; i < 6; i += 1) {\n        params[0] = i;\n        device.queue.writeBuffer(paramBuffer, 0, params, 0, 1);\n        const view = cubemap.createView({\n            dimension: '2d',\n            arrayLayerCount: 1,\n            baseArrayLayer: i,\n            mipLevelCount: 1,\n        });\n        const encoder = device.createCommandEncoder();\n        const pass = encoder.beginRenderPass({\n            label,\n            colorAttachments: [{\n                    view,\n                    loadOp: 'clear',\n                    storeOp: 'store',\n                }],\n        });\n        pass.setPipeline(pipeline);\n        pass.setBindGroup(0, bindgroup);\n        pass.draw(3);\n        pass.end();\n        device.queue.submit([encoder.finish()]);\n    }\n    return cubemap;\n}\nasync function generateMips(device, texture) {\n    const code = /* wgsl */ `\n        @group(0) @binding(0) var image: texture_2d<f32>;\n        @group(0) @binding(1) var mipSampler: sampler;\n\n        ${blit}\n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f {\n            return textureSample(image, mipSampler, uv);\n        }\n    `;\n    const label = padTemplate `mip generation${texture.label}`;\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: { viewDimension: '2d', sampleType: 'float' },\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const colorAttachment = {\n        view: undefined,\n        loadOp: 'clear',\n        storeOp: 'store',\n    };\n    const sampler = device.createSampler({\n        minFilter: 'linear',\n        magFilter: 'linear',\n    });\n    const module = device.createShaderModule({ label, code });\n    const pipelineLayout = device.createPipelineLayout({ label, bindGroupLayouts: [bindgroupLayout] });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            entryPoint: 'vs',\n            module,\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format: texture.format }],\n            module,\n        },\n    });\n    colorAttachment.view = texture.createView({ mipLevelCount: 1, baseMipLevel: 0 });\n    await device.queue.onSubmittedWorkDone();\n    for (let i = 1; i < texture.mipLevelCount; i += 1) {\n        const bindgroup = device.createBindGroup({\n            label,\n            layout: bindgroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: colorAttachment.view,\n                },\n                {\n                    binding: 1,\n                    resource: sampler,\n                },\n            ],\n        });\n        colorAttachment.view = texture.createView({ mipLevelCount: 1, baseMipLevel: i });\n        const encoder = device.createCommandEncoder();\n        const pass = encoder.beginRenderPass({\n            label,\n            colorAttachments: [colorAttachment],\n        });\n        pass.setPipeline(pipeline);\n        pass.setBindGroup(0, bindgroup);\n        pass.draw(3);\n        pass.end();\n        device.queue.submit([encoder.finish()]);\n        await device.queue.onSubmittedWorkDone();\n    }\n}\nfunction srgbTextureToLinear(device, texture) {\n    const code = /* wgsl */ `\n        @group(0) @binding(0) var image: texture_2d<f32>;\n        @group(0) @binding(1) var imageSampler: sampler;\n\n        ${blit}\n\n        fn sRGBToLinear(color: vec3f) -> vec3f {\n            return select( \n                pow(color * 0.9478672986 + 0.0521327014, vec3(2.4)), \n                color * 0.0773993808, \n                color <= vec3(0.04045), \n            );\n        }  \n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f  {\n            let sample = textureSample(image, imageSampler, uv);\n            let color = sRGBToLinear(sample.rgb);\n            return vec4(color, sample.a);\n        }\n    `;\n    const label = padTemplate `srgb to linear${texture.label}`;\n    const size = { width: texture.width, height: texture.height };\n    const tempTexture = device.createTexture({\n        format: texture.format,\n        usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n        size,\n    });\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const sampler = device.createSampler({\n        minFilter: 'linear',\n        magFilter: 'linear',\n    });\n    const module = device.createShaderModule({ label, code: code });\n    const pipelineLayout = device.createPipelineLayout({ label, bindGroupLayouts: [bindgroupLayout] });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            entryPoint: 'vs',\n            module,\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format: texture.format }],\n            module,\n        },\n    });\n    const bindgroup = device.createBindGroup({\n        label,\n        layout: bindgroupLayout,\n        entries: [\n            {\n                binding: 0,\n                resource: tempTexture.createView(),\n            },\n            {\n                binding: 1,\n                resource: sampler,\n            },\n        ],\n    });\n    const encoder = device.createCommandEncoder();\n    encoder.copyTextureToTexture({ texture }, { texture: tempTexture }, size);\n    const pass = encoder.beginRenderPass({\n        label,\n        colorAttachments: [{\n                view: texture.createView({ mipLevelCount: 1, baseMipLevel: 0 }),\n                loadOp: 'clear',\n                storeOp: 'store',\n            }],\n    });\n    pass.setPipeline(pipeline);\n    pass.setBindGroup(0, bindgroup);\n    pass.draw(3);\n    pass.end();\n    device.queue.submit([encoder.finish()]);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LG9CQUFvQixDQUN4QixFQUFFLE9BQU8sRUFBRSxFQUNYLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxFQUN4QixJQUFJLENBQ1AsQ0FBQztJQUVGLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUM7UUFDakMsS0FBSztRQUNMLGdCQUFnQixFQUFFLENBQUM7Z0JBQ2YsSUFBSSxFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxhQUFhLEVBQUUsQ0FBQyxFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsQ0FBQztnQkFDL0QsTUFBTSxFQUFFLE9BQU87Z0JBQ2YsT0FBTyxFQUFFLE9BQU87YUFDbkIsQ0FBQztLQUNMLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDM0IsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDaEMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNiLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUVYLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQztBQUM1QyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2J1bnQtcG9ydGZvbGlvLy4vc3JjL3V0aWxzL3RleHR1cmUtcHJvY2Vzc2luZy50cz83NjQ4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBibGl0IGZyb20gJy4uL3NoYWRlcnMvYmxpdC12ZXJ0LnNoYWRlcic7XG5pbXBvcnQgeyB0b1dvcmxkRGlyIH0gZnJvbSAnLi4vc2hhZGVycy9jdWJlbWFwLXNhbXBsaW5nLnNoYWRlcic7XG5pbXBvcnQgeyBjcmVhdGVBbmRDb3B5QnVmZmVyIH0gZnJvbSAnLi9kYXRhLWNvcHknO1xuaW1wb3J0IHsgcGFkVGVtcGxhdGUgfSBmcm9tICcuL2dlbmVyYWwnO1xuXG50eXBlIEVxdWlyZWN0YW5ndWxhckRlc2NyaXB0b3IgPSB7XG4gICAgZGF0YTogU2hhcmVkQXJyYXlCdWZmZXIgfCBCdWZmZXJTb3VyY2UgfCBHUFVUZXh0dXJlLFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgZ2FtbWE/OiBudW1iZXIsXG4gICAgZXhwb3N1cmU/OiBudW1iZXIsXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXF1aXJlY3Rhbmd1bGFyVG9DdWJlbWFwKFxuICAgIGRldmljZTogR1BVRGV2aWNlLFxuICAgIHsgZGF0YSwgd2lkdGgsIGhlaWdodCwgZ2FtbWEgPSAxLCBleHBvc3VyZSA9IDEgfTogRXF1aXJlY3Rhbmd1bGFyRGVzY3JpcHRvcixcbiAgICBvdXRwdXREZXNjcmlwdG9yOiBPbWl0PEdQVVRleHR1cmVEZXNjcmlwdG9yLCAnZGltZW5zaW9uJyB8ICdzaXplJz4sXG4pIHtcbiAgICBjb25zdCBjb2RlID0gLyogd2dzbCAqLyBgXG4gICAgICAgIG92ZXJyaWRlIEVYUE9TVVJFOiBmMzIgPSAxLjA7XG4gICAgICAgIG92ZXJyaWRlIEdBTU1BOiBmMzIgPSAxLjA7XG4gICAgICAgIG92ZXJyaWRlIEZMSVBfWTogYm9vbCA9IGZhbHNlO1xuXG4gICAgICAgIEBncm91cCgwKSBAYmluZGluZygwKSB2YXIgZXF1aXJlY3Rhbmd1bGFyTWFwOiB0ZXh0dXJlXzJkPGYzMj47XG4gICAgICAgIEBncm91cCgwKSBAYmluZGluZygxKSB2YXIgbWFwU2FtcGxlcjogc2FtcGxlcjtcbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDIpIHZhcjx1bmlmb3JtPiBmYWNlOiB1MzI7XG5cbiAgICAgICAgZm4gc2FtcGxlU3BoZXJpY2FsTWFwKHY6IHZlYzNmKSAtPiB2ZWMyZiB7XG4gICAgICAgICAgICBjb25zdCBpbnZBdGFuID0gdmVjMigwLjE1OTEsIDAuMzE4Myk7XG5cbiAgICAgICAgICAgIHZhciB1diA9IHZlYzIoYXRhbjIodi56LCB2LngpLCBhc2luKHYueSkpO1xuICAgICAgICAgICAgdXYgKj0gaW52QXRhbjtcbiAgICAgICAgICAgIHV2ICs9IDAuNTtcbiAgICAgICAgICAgIHJldHVybiB1djtcbiAgICAgICAgfVxuIFxuICAgICAgICAke2JsaXR9XG4gICAgICAgICR7dG9Xb3JsZERpcn1cblxuICAgICAgICBAZnJhZ21lbnRcbiAgICAgICAgZm4gZnMoQGxvY2F0aW9uKDApIHV2OiB2ZWMyZikgLT4gQGxvY2F0aW9uKDApIHZlYzRmIHtcbiAgICAgICAgICAgIHZhciBkaXIgPSB0b1dvcmxkRGlyRjMyKHV2LCBmYWNlKTtcbiAgICAgICAgICAgIGRpciA9IHZlYzMoZGlyLnosIGRpci55LCAtZGlyLngpO1xuICAgICAgICAgICAgdmFyIGNvb3JkID0gc2FtcGxlU3BoZXJpY2FsTWFwKGRpcik7XG4gICAgICAgICAgICBpZiAoRkxJUF9ZKSB7IGNvb3JkLnkgPSAxIC0gY29vcmQueTsgfVxuXG4gICAgICAgICAgICB2YXIgY29sb3IgPSB0ZXh0dXJlU2FtcGxlKGVxdWlyZWN0YW5ndWxhck1hcCwgbWFwU2FtcGxlciwgY29vcmQpLnJnYjtcbiAgICAgICAgICAgIGlmIChHQU1NQSAhPSAxLjApIHsgY29sb3IgPSBwb3coY29sb3IsIHZlYzMoMS4wIC8gR0FNTUEpKTsgfVxuICAgICAgICAgICAgaWYgKEVYUE9TVVJFICE9IDEuMCkgeyBjb2xvciAvPSBFWFBPU1VSRTsgfVxuICAgICAgICAgICAgcmV0dXJuIHZlYzQoY29sb3IsIDEuMCk7XG4gICAgICAgIH1cbiAgICBgO1xuXG4gICAgbGV0IEZMSVBfWSA9IDA7XG4gICAgbGV0IGVxdWlyZWN0YW5ndWxhcjogR1BVVGV4dHVyZTtcbiAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEdQVVRleHR1cmUpIHtcbiAgICAgICAgZXF1aXJlY3Rhbmd1bGFyID0gZGF0YTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBGTElQX1kgPSAxO1xuICAgICAgICBlcXVpcmVjdGFuZ3VsYXIgPSBkZXZpY2UuY3JlYXRlVGV4dHVyZSh7XG4gICAgICAgICAgICBsYWJlbDogYCR7b3V0cHV0RGVzY3JpcHRvci5sYWJlbH0gZXF1aXJlY3Rhbmd1bGFyYCxcbiAgICAgICAgICAgIGRpbWVuc2lvbjogJzJkJyxcbiAgICAgICAgICAgIGZvcm1hdDogJ3JnYmExNmZsb2F0JyxcbiAgICAgICAgICAgIHNpemU6IHsgd2lkdGgsIGhlaWdodCB9LFxuICAgICAgICAgICAgdXNhZ2U6IEdQVVRleHR1cmVVc2FnZS5DT1BZX0RTVCB8IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRldmljZS5xdWV1ZS53cml0ZVRleHR1cmUoXG4gICAgICAgICAgICB7IHRleHR1cmU6IGVxdWlyZWN0YW5ndWxhciwgbWlwTGV2ZWw6IDAgfSxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICB7IGJ5dGVzUGVyUm93OiB3aWR0aCAqIDIgKiA0IH0sXG4gICAgICAgICAgICB7IHdpZHRoLCBoZWlnaHQsIGRlcHRoT3JBcnJheUxheWVyczogMSB9LFxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBkZXZpY2UucXVldWUub25TdWJtaXR0ZWRXb3JrRG9uZSgpO1xuICAgIH1cblxuICAgIGNvbnN0IGZhY2VTaXplID0gZXF1aXJlY3Rhbmd1bGFyLmhlaWdodCA+PiAxO1xuICAgIGNvbnN0IGN1YmVtYXBEZXNjcmlwdG9yID0gb3V0cHV0RGVzY3JpcHRvciBhcyBHUFVUZXh0dXJlRGVzY3JpcHRvcjtcbiAgICBjdWJlbWFwRGVzY3JpcHRvci5taXBMZXZlbENvdW50ID8/PSBNYXRoLmxvZzIoZmFjZVNpemUpIHwgMDtcbiAgICBjdWJlbWFwRGVzY3JpcHRvci5zaXplID0geyB3aWR0aDogZmFjZVNpemUsIGhlaWdodDogZmFjZVNpemUsIGRlcHRoT3JBcnJheUxheWVyczogNiB9O1xuICAgIGN1YmVtYXBEZXNjcmlwdG9yLmRpbWVuc2lvbiA9ICcyZCc7XG4gICAgY3ViZW1hcERlc2NyaXB0b3IudXNhZ2UgfD0gR1BVVGV4dHVyZVVzYWdlLlJFTkRFUl9BVFRBQ0hNRU5UO1xuICAgIGNvbnN0IGN1YmVtYXAgPSBkZXZpY2UuY3JlYXRlVGV4dHVyZShjdWJlbWFwRGVzY3JpcHRvcik7XG5cbiAgICBjb25zdCBsYWJlbCA9IHBhZFRlbXBsYXRlYGhkciBjb3B5JHtvdXRwdXREZXNjcmlwdG9yLmxhYmVsfWA7XG4gICAgY29uc3QgYmluZGdyb3VwTGF5b3V0ID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cExheW91dCh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBlbnRyaWVzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMCxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiB7fSxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBHUFVTaGFkZXJTdGFnZS5GUkFHTUVOVCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMSxcbiAgICAgICAgICAgICAgICBzYW1wbGVyOiB7fSxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBHUFVTaGFkZXJTdGFnZS5GUkFHTUVOVCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMixcbiAgICAgICAgICAgICAgICBidWZmZXI6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZHVsZSA9IGRldmljZS5jcmVhdGVTaGFkZXJNb2R1bGUoeyBsYWJlbCwgY29kZSB9KTtcbiAgICBjb25zdCBzYW1wbGVyID0gZGV2aWNlLmNyZWF0ZVNhbXBsZXIoeyBsYWJlbCwgbWluRmlsdGVyOiAnbGluZWFyJywgbWFnRmlsdGVyOiAnbGluZWFyJyB9KTtcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVWludDMyQXJyYXkoMSk7XG4gICAgY29uc3QgcGFyYW1CdWZmZXIgPSBjcmVhdGVBbmRDb3B5QnVmZmVyKHBhcmFtcywgR1BVQnVmZmVyVXNhZ2UuQ09QWV9EU1QgfCBHUFVCdWZmZXJVc2FnZS5VTklGT1JNLCBkZXZpY2UsIGxhYmVsKTtcblxuICAgIGNvbnN0IGJpbmRncm91cCA9IGRldmljZS5jcmVhdGVCaW5kR3JvdXAoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgbGF5b3V0OiBiaW5kZ3JvdXBMYXlvdXQsXG4gICAgICAgIGVudHJpZXM6IFtcbiAgICAgICAgICAgIHsgYmluZGluZzogMCwgcmVzb3VyY2U6IGVxdWlyZWN0YW5ndWxhci5jcmVhdGVWaWV3KCkgfSxcbiAgICAgICAgICAgIHsgYmluZGluZzogMSwgcmVzb3VyY2U6IHNhbXBsZXIgfSxcbiAgICAgICAgICAgIHsgYmluZGluZzogMiwgcmVzb3VyY2U6IHsgYnVmZmVyOiBwYXJhbUJ1ZmZlciB9IH0sXG4gICAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBwaXBlbGluZUxheW91dCA9IGRldmljZS5jcmVhdGVQaXBlbGluZUxheW91dCh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBiaW5kR3JvdXBMYXlvdXRzOiBbYmluZGdyb3VwTGF5b3V0XSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHBpcGVsaW5lID0gZGV2aWNlLmNyZWF0ZVJlbmRlclBpcGVsaW5lKHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGxheW91dDogcGlwZWxpbmVMYXlvdXQsXG4gICAgICAgIHZlcnRleDogeyBtb2R1bGUgfSxcbiAgICAgICAgZnJhZ21lbnQ6IHtcbiAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgICAgIHRhcmdldHM6IFt7IGZvcm1hdDogY3ViZW1hcC5mb3JtYXQgfV0sXG4gICAgICAgICAgICBjb25zdGFudHM6IHtcbiAgICAgICAgICAgICAgICBHQU1NQTogZ2FtbWEsXG4gICAgICAgICAgICAgICAgRVhQT1NVUkU6IGV4cG9zdXJlLFxuICAgICAgICAgICAgICAgIEZMSVBfWSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkgKz0gMSkge1xuICAgICAgICBwYXJhbXNbMF0gPSBpO1xuICAgICAgICBkZXZpY2UucXVldWUud3JpdGVCdWZmZXIocGFyYW1CdWZmZXIsIDAsIHBhcmFtcywgMCwgMSk7XG5cbiAgICAgICAgY29uc3QgdmlldyA9IGN1YmVtYXAuY3JlYXRlVmlldyh7XG4gICAgICAgICAgICBkaW1lbnNpb246ICcyZCcsXG4gICAgICAgICAgICBhcnJheUxheWVyQ291bnQ6IDEsXG4gICAgICAgICAgICBiYXNlQXJyYXlMYXllcjogaSxcbiAgICAgICAgICAgIG1pcExldmVsQ291bnQ6IDEsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGVuY29kZXIgPSBkZXZpY2UuY3JlYXRlQ29tbWFuZEVuY29kZXIoKTtcbiAgICAgICAgY29uc3QgcGFzcyA9IGVuY29kZXIuYmVnaW5SZW5kZXJQYXNzKHtcbiAgICAgICAgICAgIGxhYmVsLFxuICAgICAgICAgICAgY29sb3JBdHRhY2htZW50czogW3tcbiAgICAgICAgICAgICAgICB2aWV3LFxuICAgICAgICAgICAgICAgIGxvYWRPcDogJ2NsZWFyJyxcbiAgICAgICAgICAgICAgICBzdG9yZU9wOiAnc3RvcmUnLFxuICAgICAgICAgICAgfV0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHBhc3Muc2V0UGlwZWxpbmUocGlwZWxpbmUpO1xuICAgICAgICBwYXNzLnNldEJpbmRHcm91cCgwLCBiaW5kZ3JvdXApO1xuICAgICAgICBwYXNzLmRyYXcoMyk7XG4gICAgICAgIHBhc3MuZW5kKCk7XG4gICAgICAgIGRldmljZS5xdWV1ZS5zdWJtaXQoW2VuY29kZXIuZmluaXNoKCldKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3ViZW1hcDtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZU1pcHMoZGV2aWNlOiBHUFVEZXZpY2UsIHRleHR1cmU6IEdQVVRleHR1cmUpIHtcbiAgICBjb25zdCBjb2RlID0gLyogd2dzbCAqLyBgXG4gICAgICAgIEBncm91cCgwKSBAYmluZGluZygwKSB2YXIgaW1hZ2U6IHRleHR1cmVfMmQ8ZjMyPjtcbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDEpIHZhciBtaXBTYW1wbGVyOiBzYW1wbGVyO1xuXG4gICAgICAgICR7YmxpdH1cblxuICAgICAgICBAZnJhZ21lbnRcbiAgICAgICAgZm4gZnMoQGxvY2F0aW9uKDApIHV2OiB2ZWMyZikgLT4gQGxvY2F0aW9uKDApIHZlYzRmIHtcbiAgICAgICAgICAgIHJldHVybiB0ZXh0dXJlU2FtcGxlKGltYWdlLCBtaXBTYW1wbGVyLCB1dik7XG4gICAgICAgIH1cbiAgICBgO1xuXG4gICAgY29uc3QgbGFiZWwgPSBwYWRUZW1wbGF0ZWBtaXAgZ2VuZXJhdGlvbiR7dGV4dHVyZS5sYWJlbH1gO1xuXG4gICAgY29uc3QgYmluZGdyb3VwTGF5b3V0ID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cExheW91dCh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBlbnRyaWVzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMCxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiB7IHZpZXdEaW1lbnNpb246ICcyZCcsIHNhbXBsZVR5cGU6ICdmbG9hdCcgfSxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBHUFVTaGFkZXJTdGFnZS5GUkFHTUVOVCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMSxcbiAgICAgICAgICAgICAgICBzYW1wbGVyOiB7fSxcbiAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiBHUFVTaGFkZXJTdGFnZS5GUkFHTUVOVCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb2xvckF0dGFjaG1lbnQgPSB7XG4gICAgICAgIHZpZXc6IHVuZGVmaW5lZCBhcyBHUFVUZXh0dXJlVmlldyB8IHVuZGVmaW5lZCxcbiAgICAgICAgbG9hZE9wOiAnY2xlYXInLFxuICAgICAgICBzdG9yZU9wOiAnc3RvcmUnLFxuICAgIH07XG5cbiAgICBjb25zdCBzYW1wbGVyID0gZGV2aWNlLmNyZWF0ZVNhbXBsZXIoe1xuICAgICAgICBtaW5GaWx0ZXI6ICdsaW5lYXInLFxuICAgICAgICBtYWdGaWx0ZXI6ICdsaW5lYXInLFxuICAgIH0pO1xuICAgIGNvbnN0IG1vZHVsZSA9IGRldmljZS5jcmVhdGVTaGFkZXJNb2R1bGUoeyBsYWJlbCwgY29kZSB9KTtcbiAgICBjb25zdCBwaXBlbGluZUxheW91dCA9IGRldmljZS5jcmVhdGVQaXBlbGluZUxheW91dCh7IGxhYmVsLCBiaW5kR3JvdXBMYXlvdXRzOiBbYmluZGdyb3VwTGF5b3V0XSB9KTtcblxuICAgIGNvbnN0IHBpcGVsaW5lID0gZGV2aWNlLmNyZWF0ZVJlbmRlclBpcGVsaW5lKHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGxheW91dDogcGlwZWxpbmVMYXlvdXQsXG4gICAgICAgIHZlcnRleDoge1xuICAgICAgICAgICAgZW50cnlQb2ludDogJ3ZzJyxcbiAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgfSxcbiAgICAgICAgZnJhZ21lbnQ6IHtcbiAgICAgICAgICAgIGVudHJ5UG9pbnQ6ICdmcycsXG4gICAgICAgICAgICB0YXJnZXRzOiBbeyBmb3JtYXQ6IHRleHR1cmUuZm9ybWF0IH1dLFxuICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29sb3JBdHRhY2htZW50LnZpZXcgPSB0ZXh0dXJlLmNyZWF0ZVZpZXcoeyBtaXBMZXZlbENvdW50OiAxLCBiYXNlTWlwTGV2ZWw6IDAgfSk7XG4gICAgYXdhaXQgZGV2aWNlLnF1ZXVlLm9uU3VibWl0dGVkV29ya0RvbmUoKTtcblxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGV4dHVyZS5taXBMZXZlbENvdW50OyBpICs9IDEpIHtcbiAgICAgICAgY29uc3QgYmluZGdyb3VwID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cCh7XG4gICAgICAgICAgICBsYWJlbCxcbiAgICAgICAgICAgIGxheW91dDogYmluZGdyb3VwTGF5b3V0LFxuICAgICAgICAgICAgZW50cmllczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYmluZGluZzogMCxcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2U6IGNvbG9yQXR0YWNobWVudC52aWV3LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBiaW5kaW5nOiAxLFxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZTogc2FtcGxlcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29sb3JBdHRhY2htZW50LnZpZXcgPSB0ZXh0dXJlLmNyZWF0ZVZpZXcoeyBtaXBMZXZlbENvdW50OiAxLCBiYXNlTWlwTGV2ZWw6IGkgfSk7XG4gICAgICAgIGNvbnN0IGVuY29kZXIgPSBkZXZpY2UuY3JlYXRlQ29tbWFuZEVuY29kZXIoKTtcbiAgICAgICAgY29uc3QgcGFzcyA9IGVuY29kZXIuYmVnaW5SZW5kZXJQYXNzKHtcbiAgICAgICAgICAgIGxhYmVsLFxuICAgICAgICAgICAgY29sb3JBdHRhY2htZW50czogW2NvbG9yQXR0YWNobWVudCBhcyBHUFVSZW5kZXJQYXNzQ29sb3JBdHRhY2htZW50XSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcGFzcy5zZXRQaXBlbGluZShwaXBlbGluZSk7XG4gICAgICAgIHBhc3Muc2V0QmluZEdyb3VwKDAsIGJpbmRncm91cCk7XG4gICAgICAgIHBhc3MuZHJhdygzKTtcbiAgICAgICAgcGFzcy5lbmQoKTtcblxuICAgICAgICBkZXZpY2UucXVldWUuc3VibWl0KFtlbmNvZGVyLmZpbmlzaCgpXSk7XG4gICAgICAgIGF3YWl0IGRldmljZS5xdWV1ZS5vblN1Ym1pdHRlZFdvcmtEb25lKCk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc3JnYlRleHR1cmVUb0xpbmVhcihkZXZpY2U6IEdQVURldmljZSwgdGV4dHVyZTogR1BVVGV4dHVyZSkge1xuICAgIGNvbnN0IGNvZGUgPSAvKiB3Z3NsICovIGBcbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDApIHZhciBpbWFnZTogdGV4dHVyZV8yZDxmMzI+O1xuICAgICAgICBAZ3JvdXAoMCkgQGJpbmRpbmcoMSkgdmFyIGltYWdlU2FtcGxlcjogc2FtcGxlcjtcblxuICAgICAgICAke2JsaXR9XG5cbiAgICAgICAgZm4gc1JHQlRvTGluZWFyKGNvbG9yOiB2ZWMzZikgLT4gdmVjM2Yge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdCggXG4gICAgICAgICAgICAgICAgcG93KGNvbG9yICogMC45NDc4NjcyOTg2ICsgMC4wNTIxMzI3MDE0LCB2ZWMzKDIuNCkpLCBcbiAgICAgICAgICAgICAgICBjb2xvciAqIDAuMDc3Mzk5MzgwOCwgXG4gICAgICAgICAgICAgICAgY29sb3IgPD0gdmVjMygwLjA0MDQ1KSwgXG4gICAgICAgICAgICApO1xuICAgICAgICB9ICBcblxuICAgICAgICBAZnJhZ21lbnRcbiAgICAgICAgZm4gZnMoQGxvY2F0aW9uKDApIHV2OiB2ZWMyZikgLT4gQGxvY2F0aW9uKDApIHZlYzRmICB7XG4gICAgICAgICAgICBsZXQgc2FtcGxlID0gdGV4dHVyZVNhbXBsZShpbWFnZSwgaW1hZ2VTYW1wbGVyLCB1dik7XG4gICAgICAgICAgICBsZXQgY29sb3IgPSBzUkdCVG9MaW5lYXIoc2FtcGxlLnJnYik7XG4gICAgICAgICAgICByZXR1cm4gdmVjNChjb2xvciwgc2FtcGxlLmEpO1xuICAgICAgICB9XG4gICAgYDtcblxuICAgIGNvbnN0IGxhYmVsID0gcGFkVGVtcGxhdGVgc3JnYiB0byBsaW5lYXIke3RleHR1cmUubGFiZWx9YDtcblxuICAgIGNvbnN0IHNpemUgPSB7IHdpZHRoOiB0ZXh0dXJlLndpZHRoLCBoZWlnaHQ6IHRleHR1cmUuaGVpZ2h0IH07XG5cbiAgICBjb25zdCB0ZW1wVGV4dHVyZSA9IGRldmljZS5jcmVhdGVUZXh0dXJlKHtcbiAgICAgICAgZm9ybWF0OiB0ZXh0dXJlLmZvcm1hdCxcbiAgICAgICAgdXNhZ2U6IEdQVVRleHR1cmVVc2FnZS5DT1BZX0RTVCB8IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcsXG4gICAgICAgIHNpemUsXG4gICAgfSk7XG5cbiAgICBjb25zdCBiaW5kZ3JvdXBMYXlvdXQgPSBkZXZpY2UuY3JlYXRlQmluZEdyb3VwTGF5b3V0KHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGVudHJpZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgICAgIHRleHR1cmU6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAxLFxuICAgICAgICAgICAgICAgIHNhbXBsZXI6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHNhbXBsZXIgPSBkZXZpY2UuY3JlYXRlU2FtcGxlcih7XG4gICAgICAgIG1pbkZpbHRlcjogJ2xpbmVhcicsXG4gICAgICAgIG1hZ0ZpbHRlcjogJ2xpbmVhcicsXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2R1bGUgPSBkZXZpY2UuY3JlYXRlU2hhZGVyTW9kdWxlKHsgbGFiZWwsIGNvZGU6IGNvZGUgfSk7XG4gICAgY29uc3QgcGlwZWxpbmVMYXlvdXQgPSBkZXZpY2UuY3JlYXRlUGlwZWxpbmVMYXlvdXQoeyBsYWJlbCwgYmluZEdyb3VwTGF5b3V0czogW2JpbmRncm91cExheW91dF0gfSk7XG5cbiAgICBjb25zdCBwaXBlbGluZSA9IGRldmljZS5jcmVhdGVSZW5kZXJQaXBlbGluZSh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBsYXlvdXQ6IHBpcGVsaW5lTGF5b3V0LFxuICAgICAgICB2ZXJ0ZXg6IHtcbiAgICAgICAgICAgIGVudHJ5UG9pbnQ6ICd2cycsXG4gICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgIH0sXG4gICAgICAgIGZyYWdtZW50OiB7XG4gICAgICAgICAgICBlbnRyeVBvaW50OiAnZnMnLFxuICAgICAgICAgICAgdGFyZ2V0czogW3sgZm9ybWF0OiB0ZXh0dXJlLmZvcm1hdCB9XSxcbiAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGJpbmRncm91cCA9IGRldmljZS5jcmVhdGVCaW5kR3JvdXAoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgbGF5b3V0OiBiaW5kZ3JvdXBMYXlvdXQsXG4gICAgICAgIGVudHJpZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgICAgIHJlc291cmNlOiB0ZW1wVGV4dHVyZS5jcmVhdGVWaWV3KCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDEsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2U6IHNhbXBsZXIsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0pO1xuXG4gICAgY29uc3QgZW5jb2RlciA9IGRldmljZS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuICAgIGVuY29kZXIuY29weVRleHR1cmVUb1RleHR1cmUoXG4gICAgICAgIHsgdGV4dHVyZSB9LFxuICAgICAgICB7IHRleHR1cmU6IHRlbXBUZXh0dXJlIH0sXG4gICAgICAgIHNpemUsXG4gICAgKTtcblxuICAgIGNvbnN0IHBhc3MgPSBlbmNvZGVyLmJlZ2luUmVuZGVyUGFzcyh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBjb2xvckF0dGFjaG1lbnRzOiBbe1xuICAgICAgICAgICAgdmlldzogdGV4dHVyZS5jcmVhdGVWaWV3KHsgbWlwTGV2ZWxDb3VudDogMSwgYmFzZU1pcExldmVsOiAwIH0pLFxuICAgICAgICAgICAgbG9hZE9wOiAnY2xlYXInLFxuICAgICAgICAgICAgc3RvcmVPcDogJ3N0b3JlJyxcbiAgICAgICAgfV0sXG4gICAgfSk7XG5cbiAgICBwYXNzLnNldFBpcGVsaW5lKHBpcGVsaW5lKTtcbiAgICBwYXNzLnNldEJpbmRHcm91cCgwLCBiaW5kZ3JvdXApO1xuICAgIHBhc3MuZHJhdygzKTtcbiAgICBwYXNzLmVuZCgpO1xuXG4gICAgZGV2aWNlLnF1ZXVlLnN1Ym1pdChbZW5jb2Rlci5maW5pc2goKV0pO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///7335\n")}}]);