"use strict";(self.webpackChunkcbunt_portfolio=self.webpackChunkcbunt_portfolio||[]).push([[164],{291:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  A: () => (/* binding */ descriptor_map)\n});\n\n// EXTERNAL MODULE: ./src/rendering/default-forward-pass/pipeline-feature-flags.ts\nvar pipeline_feature_flags = __webpack_require__(8452);\n;// CONCATENATED MODULE: ./src/utils/shader.ts\nfunction resolveBranch(branch) {\n    return typeof branch === 'string' ? branch : branch();\n}\nclass PreprocessorStatement {\n    constructor(cond, branch) {\n        this.else = (branch) => this.res ?? resolveBranch(branch);\n        this.toString = () => this.res ?? '';\n        if (cond)\n            this.res = resolveBranch(branch);\n    }\n    elif(cond, branch) {\n        if (cond)\n            this.res ??= resolveBranch(branch);\n        return this;\n    }\n    get [Symbol.toStringTag]() { return this.toString(); }\n}\nfunction preprocessors(flags) {\n    return {\n        ifdef(sym, branch) {\n            return new PreprocessorStatement((flags & sym) === sym, branch);\n        },\n        ifndef(sym, branch) {\n            return new PreprocessorStatement((flags & sym) !== sym, branch);\n        },\n    };\n}\nfunction wrapWithIncrement(fn, start = 0) {\n    return () => fn(start++);\n}\n\n// EXTERNAL MODULE: ./src/rendering/global-uniforms.ts\nvar global_uniforms = __webpack_require__(2462);\n;// CONCATENATED MODULE: ./src/shaders/forward.shader.ts\n/* eslint-disable @typescript-eslint/indent */\n/* eslint-disable @typescript-eslint/restrict-template-expressions */\n\n\n\nfunction getBindgroupInfo(flags) {\n    const entries = [];\n    function pushItem(item) {\n        entries.push({ ...item, binding: entries.length, visibility: GPUShaderStage.FRAGMENT | GPUShaderStage.VERTEX });\n    }\n    pushItem({ buffer: { type: 'uniform' } });\n    pushItem({ sampler: {} });\n    pushItem({ texture: { viewDimension: '2d' } });\n    pushItem({ sampler: {} });\n    pushItem({ texture: { viewDimension: '2d' } });\n    pushItem({ sampler: {} });\n    pushItem({ texture: { viewDimension: '2d' } });\n    if (flags & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Emissive) {\n        pushItem({ sampler: {} });\n        pushItem({ texture: { viewDimension: '2d' } });\n    }\n    return { label: (0,pipeline_feature_flags/* featureFlagsToString */.UZ)(flags), entries };\n}\n/**\n * @param flags A flag enum containing the features this code should be generated for\n * @returns A string containing preprocessed wgsl shader code for the given features\n */\nfunction include(flags) {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const { ifdef } = preprocessors(flags);\n    const vertexInLocation = wrapWithIncrement((idx) => /* wgsl */ `@location(${idx})`);\n    const varyingsLocation = wrapWithIncrement((idx) => /* wgsl */ `@location(${idx})`);\n    const materialBinding = wrapWithIncrement((idx) => /* wgsl */ `\n        @group(1) @binding(${idx})\n    `);\n    const varyings = /* wgsl */ `\n        ${varyingsLocation()} pos: vec3f,\n        ${varyingsLocation()} camPos: vec3f,\n        ${varyingsLocation()} uv: vec2f,\n\n        ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals, () => /* wgsl */ `\n            ${varyingsLocation()} tangent: vec4f,\n            ${varyingsLocation()} normal: vec3f,\n        `)}\n\n        ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors, () => /* wgsl */ `\n            ${varyingsLocation()} color: vec4f,\n        `)}\n    `;\n    return /* wgsl */ `\n        ${global_uniforms/* default */.A.code(0)}\n\n        struct ForwardOut {\n            @location(${0 /* GBufferGroupIndices.Normal */}) normal: vec4f,\n            @location(${1 /* GBufferGroupIndices.Albedo */}) albedo: vec4f,\n            @location(${2 /* GBufferGroupIndices.Emission */}) emission: vec4f,\n            @location(${3 /* GBufferGroupIndices.MetallicRoughness */}) metallicRoughness: vec4f,\n        }\n\n        struct MaterialProperties {\n            baseColorFactor: vec4f,\n            metallicFactor: f32,\n            roughnessFactor: f32,\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.AlphaCutoff, 'alphaCutoff: f32,')}\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Emissive, 'emissiveFactor: vec3f,')}\n        }\n\n        ${materialBinding()} var<uniform> material: MaterialProperties;\n\n        ${materialBinding()} var baseColorSampler: sampler;\n        ${materialBinding()} var baseColorTexture: texture_2d<f32>;\n\n        ${materialBinding()} var normalSampler: sampler;\n        ${materialBinding()} var normalTexture: texture_2d<f32>;\n\n        ${materialBinding()} var metallicRoughnessSampler: sampler;\n        ${materialBinding()} var metallicRoughnessTexture: texture_2d<f32>;\n\n        ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Emissive, () => /* wgsl */ `\n            ${materialBinding()} var emissionSampler: sampler;\n            ${materialBinding()} var emissionTexture: texture_2d<f32>;\n        `)}\n\n        struct ModelProperties {\n            modelToWorldMatrix: mat4x4f,\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals, 'normalMatrix: mat3x3f,')}\n        }\n\n        @group(2) @binding(0) var<storage, read> instances : array<ModelProperties>;\n\n        struct VertIn {\n            @builtin(instance_index) instance: u32,\n            ${vertexInLocation()} pos: vec3f,\n            ${vertexInLocation()} uv: vec2f,\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals, () => /* wgsl */ `\n                ${vertexInLocation()} tangent: vec4f,\n                ${vertexInLocation()} normal: vec3f,\n            `)}\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors, () => /* wgsl */ `\n                ${vertexInLocation()} color: vec4f,\n            `)}\n        }\n\n        struct VertOut {\n            ${varyings}\n            @builtin(position) Position: vec4f,\n        }\n\n        struct FragIn {\n            ${varyings}\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals | pipeline_feature_flags/* PipelineFeatureFlags */.Ot.DoubleSided, /* wgsl */ `\n                @builtin(front_facing) front_facing: bool,\n            `)}\n        }\n\n        fn sRGBToLinear(color: vec3f) -> vec3f {\n            return select( \n                pow(color * 0.9478672986 + 0.0521327014, vec3(2.4)), \n                color * 0.0773993808, \n                color <= vec3(0.04045), \n            );\n        }  \n\n        @vertex \n        fn vs(inData: VertIn) -> VertOut {\n            var vsOut: VertOut;\n            let instance = instances[inData.instance];\n            let worldPos = instance.modelToWorldMatrix * vec4f(inData.pos, 1);\n            vsOut.pos = worldPos.xyz;\n            vsOut.Position = globals.worldToClip * worldPos;\n            vsOut.camPos = globals.inverseWorldToView[3].xyz;\n            vsOut.uv = inData.uv;\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals, /* wgsl */ `\n                vsOut.normal = normalize(instance.normalMatrix * inData.normal);\n                let wsTangent = normalize((instance.modelToWorldMatrix * vec4(inData.tangent.xyz, 0.0)).xyz);\n                vsOut.tangent = vec4(wsTangent, inData.tangent.w);\n            `)}\n\n            return vsOut;\n        }\n\n        // much of this code is adapted from https://learnopengl.com/PBR\n        @fragment\n        fn fs(inData: FragIn) -> ForwardOut {\n            var out: ForwardOut;\n            let rawColor: vec4f = textureSample(baseColorTexture, baseColorSampler, inData.uv);\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.AlphaCutoff, /* wgsl */ `\n                var alpha = rawColor.a * material.baseColorFactor.a;\n\n                ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors, /* wgsl */ `\n                    alpha *= inData.color.a;\n                `)}\n\n                if (alpha <= material.alphaCutoff) { \n                    discard;\n                }\n            `)}\n\n            out.albedo = vec4f(rawColor.rgb * material.baseColorFactor.rgb, 1);\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors, /* wgsl */ `\n                out.albedo *= vec4f(inData.color.rgb, 1);\n            `)}\n\n            let metallicRoughness = textureSample(metallicRoughnessTexture, metallicRoughnessSampler, inData.uv);\n            out.metallicRoughness.r = saturate(metallicRoughness.b * material.metallicFactor);\n            out.metallicRoughness.g = saturate(metallicRoughness.g * material.roughnessFactor);\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals, /* wgsl */ `\n                let normalSample = textureSample(normalTexture, normalSampler, inData.uv).xyz;\n                let tangentNormal = normalize(normalSample * 2.0 - 1.0);\n                let bitangent =inData.tangent.w * cross(inData.normal, inData.tangent.xyz);\n                let tbn = mat3x3f(normalize(inData.tangent.xyz), bitangent, normalize(inData.normal));\n                var normal = normalize(tbn * tangentNormal);\n\n                ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.DoubleSided, /* wgsl */ `\n                    if (!inData.front_facing) { normal *= -1.0; }\n                `)}\n            `).else(/* wgsl */ `\n                let fdx = dpdx(inData.pos);\n                let fdy = dpdy(inData.pos);\n                let normal = normalize(cross(fdx, fdy));\n            `)}\n\n            out.normal = vec4f(normal, 1);\n\n            ${ifdef(pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Emissive, /* wgsl */ `\n                let emission = textureSample(emissionTexture, emissionSampler, inData.uv).rgb;\n                out.emission = vec4f(emission, 1);\n            `)}\n\n            return out;\n        }\n    `;\n}\n\n;// CONCATENATED MODULE: ./src/rendering/default-forward-pass/descriptor-map.ts\n\n\n\nclass DescriptorMap {\n    constructor(device, gbuffer, globals) {\n        this.device = device;\n        this.gbuffer = gbuffer;\n        this.globals = globals;\n        this.pipelineLayouts = {};\n        this.primitiveStates = {};\n        this.vertexLayouts = {};\n        this.shaderModules = {};\n        this.bindgroupLayouts = {};\n        this.samplers = {};\n        this.forwardBindgroupLayout = this.device.createBindGroupLayout({\n            label: `forward material`,\n            entries: [{\n                    binding: 0,\n                    visibility: GPUShaderStage.VERTEX | GPUShaderStage.FRAGMENT,\n                    buffer: { type: 'read-only-storage' },\n                }],\n        });\n    }\n    getSampler(descriptor) {\n        const key = JSON.stringify(descriptor);\n        this.samplers[key] ??= this.device.createSampler(descriptor);\n        return this.samplers[key];\n    }\n    getVertexLayout(flags) {\n        const masked = flags & pipeline_feature_flags/* VertexBufferLayoutMask */.V3;\n        if (this.vertexLayouts[masked] == null) {\n            const attributes = [\n                { shaderLocation: 0, offset: 0, format: 'float32x3' }, // position\n                { shaderLocation: 1, offset: 12, format: 'float32x2' }, // uv\n            ];\n            let arrayStride = 20;\n            let shaderLocation = 2;\n            if (masked & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals) {\n                attributes.push({ shaderLocation, offset: arrayStride, format: 'float32x4' }); // tangent\n                attributes.push({ shaderLocation: shaderLocation + 1, offset: arrayStride + 16, format: 'float32x3' }); // normal\n                shaderLocation += 2;\n                arrayStride += 28;\n            }\n            if (masked & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors) {\n                attributes.push({ shaderLocation, offset: arrayStride, format: 'float32x4' }); // color\n                arrayStride += 16;\n            }\n            this.vertexLayouts[masked] = { attributes, arrayStride, stepMode: 'vertex' };\n        }\n        return this.vertexLayouts[masked];\n    }\n    getForwardPipelineLayout(flags) {\n        const masked = flags & pipeline_feature_flags/* PipelineLayoutMask */.FO;\n        this.pipelineLayouts[masked] ??= this.device.createPipelineLayout({\n            label: pipeline_feature_flags/* featureFlagsToString */.UZ(masked),\n            bindGroupLayouts: [\n                this.globals.bindGroupLayout,\n                this.getMaterialBindGroup(flags),\n                this.forwardBindgroupLayout,\n            ],\n        });\n        return this.pipelineLayouts[masked];\n    }\n    getShaderModule(flags) {\n        const masked = flags & pipeline_feature_flags/* CodeMask */.Q7;\n        this.shaderModules[masked] ??= this.device.createShaderModule({\n            label: pipeline_feature_flags/* featureFlagsToString */.UZ(masked),\n            code: include(masked),\n        });\n        return this.shaderModules[masked];\n    }\n    getPrimitiveState(flags) {\n        const masked = flags & pipeline_feature_flags/* PrimitiveStateMask */.XY;\n        this.primitiveStates[masked] ??= {\n            topology: DescriptorMap.flagToTopology[(flags & pipeline_feature_flags/* TopologyFormatMask */.Py)],\n            cullMode: masked & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.DoubleSided ? 'none' : 'back',\n            frontFace: masked & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.ClockwiseWinding ? 'cw' : 'ccw',\n        };\n        return this.primitiveStates[masked];\n    }\n    getMaterialBindGroup(flags) {\n        const masked = flags & pipeline_feature_flags/* MaterialBindgroupLayoutMask */.Wq;\n        this.bindgroupLayouts[masked] ??= this.device.createBindGroupLayout(getBindgroupInfo(masked));\n        return this.bindgroupLayouts[masked];\n    }\n}\nDescriptorMap.flagToTopology = {\n    [pipeline_feature_flags/* PipelineFeatureFlags */.Ot.TriangleList]: 'triangle-list',\n    [pipeline_feature_flags/* PipelineFeatureFlags */.Ot.TriangleStrip]: 'triangle-strip',\n    [pipeline_feature_flags/* PipelineFeatureFlags */.Ot.PointList]: 'point-list',\n    [pipeline_feature_flags/* PipelineFeatureFlags */.Ot.LineList]: 'line-list',\n    [pipeline_feature_flags/* PipelineFeatureFlags */.Ot.LineStrip]: 'line-strip',\n};\n/* harmony default export */ const descriptor_map = (DescriptorMap);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjLEdBQWdFO0lBQzFGLENBQUMsbURBQW9CLENBQUMsWUFBWSxDQUFDLEVBQUUsZUFBZTtJQUNwRCxDQUFDLG1EQUFvQixDQUFDLGFBQWEsQ0FBQyxFQUFFLGdCQUFnQjtJQUN0RCxDQUFDLG1EQUFvQixDQUFDLFNBQVMsQ0FBQyxFQUFFLFlBQVk7SUFDOUMsQ0FBQyxtREFBb0IsQ0FBQyxRQUFRLENBQUMsRUFBRSxXQUFXO0lBQzVDLENBQUMsbURBQW9CLENBQUMsU0FBUyxDQUFDLEVBQUUsWUFBWTtDQUNqRCxDQUFDO3FEQVBlLGFBQWEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvdXRpbHMvc2hhZGVyLnRzP2ExYzAiLCJ3ZWJwYWNrOi8vY2J1bnQtcG9ydGZvbGlvLy4vc3JjL3NoYWRlcnMvZm9yd2FyZC5zaGFkZXIudHM/MjI1YyIsIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL2Rlc2NyaXB0b3ItbWFwLnRzPzJmZjciXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHR5cGUgQnJhbmNoID0gc3RyaW5nIHwgKCgpID0+IHN0cmluZyk7XHJcblxyXG5mdW5jdGlvbiByZXNvbHZlQnJhbmNoKGJyYW5jaDogQnJhbmNoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIGJyYW5jaCA9PT0gJ3N0cmluZycgPyBicmFuY2ggOiBicmFuY2goKTtcclxufVxyXG5cclxuY2xhc3MgUHJlcHJvY2Vzc29yU3RhdGVtZW50IHtcclxuICAgIHJlcz86IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb25kOiBib29sZWFuLCBicmFuY2g6IEJyYW5jaCkge1xyXG4gICAgICAgIGlmIChjb25kKSB0aGlzLnJlcyA9IHJlc29sdmVCcmFuY2goYnJhbmNoKTtcclxuICAgIH1cclxuXHJcbiAgICBlbGlmKGNvbmQ6IGJvb2xlYW4sIGJyYW5jaDogQnJhbmNoKSB7XHJcbiAgICAgICAgaWYgKGNvbmQpIHRoaXMucmVzID8/PSByZXNvbHZlQnJhbmNoKGJyYW5jaCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSA9IChicmFuY2g6IEJyYW5jaCkgPT4gdGhpcy5yZXMgPz8gcmVzb2x2ZUJyYW5jaChicmFuY2gpO1xyXG5cclxuICAgIHRvU3RyaW5nID0gKCkgPT4gdGhpcy5yZXMgPz8gJyc7XHJcblxyXG4gICAgZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCkgeyByZXR1cm4gdGhpcy50b1N0cmluZygpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVwcm9jZXNzb3JzKGZsYWdzOiBudW1iZXIpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaWZkZWYoc3ltOiBudW1iZXIsIGJyYW5jaDogQnJhbmNoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJlcHJvY2Vzc29yU3RhdGVtZW50KChmbGFncyAmIHN5bSkgPT09IHN5bSwgYnJhbmNoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGlmbmRlZihzeW06IG51bWJlciwgYnJhbmNoOiBCcmFuY2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcmVwcm9jZXNzb3JTdGF0ZW1lbnQoKGZsYWdzICYgc3ltKSAhPT0gc3ltLCBicmFuY2gpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gd3JhcFdpdGhJbmNyZW1lbnQ8VD4oZm46IChjb3VudGVyOiBudW1iZXIpID0+IFQsIHN0YXJ0ID0gMCk6ICgpID0+IFQge1xyXG4gICAgcmV0dXJuICgpID0+IGZuKHN0YXJ0KyspO1xyXG59XHJcbiIsIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9pbmRlbnQgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9yZXN0cmljdC10ZW1wbGF0ZS1leHByZXNzaW9ucyAqL1xuXG5pbXBvcnQgeyBQaXBlbGluZUZlYXR1cmVGbGFncywgZmVhdHVyZUZsYWdzVG9TdHJpbmcgfSBmcm9tICcuLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvcGlwZWxpbmUtZmVhdHVyZS1mbGFncyc7XG5pbXBvcnQgeyBwcmVwcm9jZXNzb3JzLCB3cmFwV2l0aEluY3JlbWVudCB9IGZyb20gJy4uL3V0aWxzL3NoYWRlcic7XG5pbXBvcnQgR2xvYmFsVW5pZm9ybXMgZnJvbSAnLi4vcmVuZGVyaW5nL2dsb2JhbC11bmlmb3Jtcyc7XG5pbXBvcnQgeyBHQnVmZmVyR3JvdXBJbmRpY2VzIH0gZnJvbSAnLi4vcmVuZGVyaW5nL2didWZmZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmluZGdyb3VwSW5mbyhmbGFnczogUGlwZWxpbmVGZWF0dXJlRmxhZ3MpOiBHUFVCaW5kR3JvdXBMYXlvdXREZXNjcmlwdG9yIHtcbiAgICBjb25zdCBlbnRyaWVzOiBHUFVCaW5kR3JvdXBMYXlvdXRFbnRyeVtdID0gW107XG5cbiAgICBmdW5jdGlvbiBwdXNoSXRlbShpdGVtOiBPbWl0PEdQVUJpbmRHcm91cExheW91dEVudHJ5LCAnYmluZGluZycgfCAndmlzaWJpbGl0eSc+KSB7XG4gICAgICAgIGVudHJpZXMucHVzaCh7IC4uLml0ZW0sIGJpbmRpbmc6IGVudHJpZXMubGVuZ3RoLCB2aXNpYmlsaXR5OiBHUFVTaGFkZXJTdGFnZS5GUkFHTUVOVCB8IEdQVVNoYWRlclN0YWdlLlZFUlRFWCB9KTtcbiAgICB9XG5cbiAgICBwdXNoSXRlbSh7IGJ1ZmZlcjogeyB0eXBlOiAndW5pZm9ybScgfSB9KTtcblxuICAgIHB1c2hJdGVtKHsgc2FtcGxlcjoge30gfSk7XG4gICAgcHVzaEl0ZW0oeyB0ZXh0dXJlOiB7IHZpZXdEaW1lbnNpb246ICcyZCcgfSB9KTtcblxuICAgIHB1c2hJdGVtKHsgc2FtcGxlcjoge30gfSk7XG4gICAgcHVzaEl0ZW0oeyB0ZXh0dXJlOiB7IHZpZXdEaW1lbnNpb246ICcyZCcgfSB9KTtcblxuICAgIHB1c2hJdGVtKHsgc2FtcGxlcjoge30gfSk7XG4gICAgcHVzaEl0ZW0oeyB0ZXh0dXJlOiB7IHZpZXdEaW1lbnNpb246ICcyZCcgfSB9KTtcblxuICAgIGlmIChmbGFncyAmIFBpcGVsaW5lRmVhdHVyZUZsYWdzLkVtaXNzaXZlKSB7XG4gICAgICAgIHB1c2hJdGVtKHsgc2FtcGxlcjoge30gfSk7XG4gICAgICAgIHB1c2hJdGVtKHsgdGV4dHVyZTogeyB2aWV3RGltZW5zaW9uOiAnMmQnIH0gfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgbGFiZWw6IGZlYXR1cmVGbGFnc1RvU3RyaW5nKGZsYWdzKSwgZW50cmllcyB9O1xufVxuXG4vKipcbiAqIEBwYXJhbSBmbGFncyBBIGZsYWcgZW51bSBjb250YWluaW5nIHRoZSBmZWF0dXJlcyB0aGlzIGNvZGUgc2hvdWxkIGJlIGdlbmVyYXRlZCBmb3JcbiAqIEByZXR1cm5zIEEgc3RyaW5nIGNvbnRhaW5pbmcgcHJlcHJvY2Vzc2VkIHdnc2wgc2hhZGVyIGNvZGUgZm9yIHRoZSBnaXZlbiBmZWF0dXJlc1xuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbmNsdWRlKGZsYWdzOiBQaXBlbGluZUZlYXR1cmVGbGFncykge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2RcbiAgICBjb25zdCB7IGlmZGVmIH0gPSBwcmVwcm9jZXNzb3JzKGZsYWdzIGFzIG51bWJlcik7XG4gICAgY29uc3QgdmVydGV4SW5Mb2NhdGlvbiA9IHdyYXBXaXRoSW5jcmVtZW50KChpZHgpID0+IC8qIHdnc2wgKi9gQGxvY2F0aW9uKCR7aWR4fSlgKTtcbiAgICBjb25zdCB2YXJ5aW5nc0xvY2F0aW9uID0gd3JhcFdpdGhJbmNyZW1lbnQoKGlkeCkgPT4gLyogd2dzbCAqL2BAbG9jYXRpb24oJHtpZHh9KWApO1xuXG4gICAgY29uc3QgbWF0ZXJpYWxCaW5kaW5nID0gd3JhcFdpdGhJbmNyZW1lbnQoKGlkeCkgPT4gLyogd2dzbCAqL2BcbiAgICAgICAgQGdyb3VwKDEpIEBiaW5kaW5nKCR7aWR4fSlcbiAgICBgKTtcblxuICAgIGNvbnN0IHZhcnlpbmdzID0gLyogd2dzbCAqL2BcbiAgICAgICAgJHt2YXJ5aW5nc0xvY2F0aW9uKCl9IHBvczogdmVjM2YsXG4gICAgICAgICR7dmFyeWluZ3NMb2NhdGlvbigpfSBjYW1Qb3M6IHZlYzNmLFxuICAgICAgICAke3ZhcnlpbmdzTG9jYXRpb24oKX0gdXY6IHZlYzJmLFxuXG4gICAgICAgICR7aWZkZWYoUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscywgKCkgPT4gLyogd2dzbCAqL2BcbiAgICAgICAgICAgICR7dmFyeWluZ3NMb2NhdGlvbigpfSB0YW5nZW50OiB2ZWM0ZixcbiAgICAgICAgICAgICR7dmFyeWluZ3NMb2NhdGlvbigpfSBub3JtYWw6IHZlYzNmLFxuICAgICAgICBgKX1cblxuICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleENvbG9ycywgKCkgPT4gLyogd2dzbCAqL2BcbiAgICAgICAgICAgICR7dmFyeWluZ3NMb2NhdGlvbigpfSBjb2xvcjogdmVjNGYsXG4gICAgICAgIGApfVxuICAgIGA7XG5cbiAgICByZXR1cm4gLyogd2dzbCAqL2BcbiAgICAgICAgJHtHbG9iYWxVbmlmb3Jtcy5jb2RlKDApfVxuXG4gICAgICAgIHN0cnVjdCBGb3J3YXJkT3V0IHtcbiAgICAgICAgICAgIEBsb2NhdGlvbigke0dCdWZmZXJHcm91cEluZGljZXMuTm9ybWFsfSkgbm9ybWFsOiB2ZWM0ZixcbiAgICAgICAgICAgIEBsb2NhdGlvbigke0dCdWZmZXJHcm91cEluZGljZXMuQWxiZWRvfSkgYWxiZWRvOiB2ZWM0ZixcbiAgICAgICAgICAgIEBsb2NhdGlvbigke0dCdWZmZXJHcm91cEluZGljZXMuRW1pc3Npb259KSBlbWlzc2lvbjogdmVjNGYsXG4gICAgICAgICAgICBAbG9jYXRpb24oJHtHQnVmZmVyR3JvdXBJbmRpY2VzLk1ldGFsbGljUm91Z2huZXNzfSkgbWV0YWxsaWNSb3VnaG5lc3M6IHZlYzRmLFxuICAgICAgICB9XG5cbiAgICAgICAgc3RydWN0IE1hdGVyaWFsUHJvcGVydGllcyB7XG4gICAgICAgICAgICBiYXNlQ29sb3JGYWN0b3I6IHZlYzRmLFxuICAgICAgICAgICAgbWV0YWxsaWNGYWN0b3I6IGYzMixcbiAgICAgICAgICAgIHJvdWdobmVzc0ZhY3RvcjogZjMyLFxuXG4gICAgICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLkFscGhhQ3V0b2ZmLCAnYWxwaGFDdXRvZmY6IGYzMiwnKX1cbiAgICAgICAgICAgICR7aWZkZWYoUGlwZWxpbmVGZWF0dXJlRmxhZ3MuRW1pc3NpdmUsICdlbWlzc2l2ZUZhY3RvcjogdmVjM2YsJyl9XG4gICAgICAgIH1cblxuICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXI8dW5pZm9ybT4gbWF0ZXJpYWw6IE1hdGVyaWFsUHJvcGVydGllcztcblxuICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXIgYmFzZUNvbG9yU2FtcGxlcjogc2FtcGxlcjtcbiAgICAgICAgJHttYXRlcmlhbEJpbmRpbmcoKX0gdmFyIGJhc2VDb2xvclRleHR1cmU6IHRleHR1cmVfMmQ8ZjMyPjtcblxuICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXIgbm9ybWFsU2FtcGxlcjogc2FtcGxlcjtcbiAgICAgICAgJHttYXRlcmlhbEJpbmRpbmcoKX0gdmFyIG5vcm1hbFRleHR1cmU6IHRleHR1cmVfMmQ8ZjMyPjtcblxuICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXIgbWV0YWxsaWNSb3VnaG5lc3NTYW1wbGVyOiBzYW1wbGVyO1xuICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXIgbWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlOiB0ZXh0dXJlXzJkPGYzMj47XG5cbiAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5FbWlzc2l2ZSwgKCkgPT4gLyogd2dzbCAqL2BcbiAgICAgICAgICAgICR7bWF0ZXJpYWxCaW5kaW5nKCl9IHZhciBlbWlzc2lvblNhbXBsZXI6IHNhbXBsZXI7XG4gICAgICAgICAgICAke21hdGVyaWFsQmluZGluZygpfSB2YXIgZW1pc3Npb25UZXh0dXJlOiB0ZXh0dXJlXzJkPGYzMj47XG4gICAgICAgIGApfVxuXG4gICAgICAgIHN0cnVjdCBNb2RlbFByb3BlcnRpZXMge1xuICAgICAgICAgICAgbW9kZWxUb1dvcmxkTWF0cml4OiBtYXQ0eDRmLFxuXG4gICAgICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleE5vcm1hbHMsICdub3JtYWxNYXRyaXg6IG1hdDN4M2YsJyl9XG4gICAgICAgIH1cblxuICAgICAgICBAZ3JvdXAoMikgQGJpbmRpbmcoMCkgdmFyPHN0b3JhZ2UsIHJlYWQ+IGluc3RhbmNlcyA6IGFycmF5PE1vZGVsUHJvcGVydGllcz47XG5cbiAgICAgICAgc3RydWN0IFZlcnRJbiB7XG4gICAgICAgICAgICBAYnVpbHRpbihpbnN0YW5jZV9pbmRleCkgaW5zdGFuY2U6IHUzMixcbiAgICAgICAgICAgICR7dmVydGV4SW5Mb2NhdGlvbigpfSBwb3M6IHZlYzNmLFxuICAgICAgICAgICAgJHt2ZXJ0ZXhJbkxvY2F0aW9uKCl9IHV2OiB2ZWMyZixcblxuICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhOb3JtYWxzLCAoKSA9PiAvKiB3Z3NsICovYFxuICAgICAgICAgICAgICAgICR7dmVydGV4SW5Mb2NhdGlvbigpfSB0YW5nZW50OiB2ZWM0ZixcbiAgICAgICAgICAgICAgICAke3ZlcnRleEluTG9jYXRpb24oKX0gbm9ybWFsOiB2ZWMzZixcbiAgICAgICAgICAgIGApfVxuXG4gICAgICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleENvbG9ycywgKCkgPT4gLyogd2dzbCAqL2BcbiAgICAgICAgICAgICAgICAke3ZlcnRleEluTG9jYXRpb24oKX0gY29sb3I6IHZlYzRmLFxuICAgICAgICAgICAgYCl9XG4gICAgICAgIH1cblxuICAgICAgICBzdHJ1Y3QgVmVydE91dCB7XG4gICAgICAgICAgICAke3ZhcnlpbmdzfVxuICAgICAgICAgICAgQGJ1aWx0aW4ocG9zaXRpb24pIFBvc2l0aW9uOiB2ZWM0ZixcbiAgICAgICAgfVxuXG4gICAgICAgIHN0cnVjdCBGcmFnSW4ge1xuICAgICAgICAgICAgJHt2YXJ5aW5nc31cblxuICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhOb3JtYWxzIHwgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuRG91YmxlU2lkZWQsIC8qIHdnc2wgKi9gXG4gICAgICAgICAgICAgICAgQGJ1aWx0aW4oZnJvbnRfZmFjaW5nKSBmcm9udF9mYWNpbmc6IGJvb2wsXG4gICAgICAgICAgICBgKX1cbiAgICAgICAgfVxuXG4gICAgICAgIGZuIHNSR0JUb0xpbmVhcihjb2xvcjogdmVjM2YpIC0+IHZlYzNmIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3QoIFxuICAgICAgICAgICAgICAgIHBvdyhjb2xvciAqIDAuOTQ3ODY3Mjk4NiArIDAuMDUyMTMyNzAxNCwgdmVjMygyLjQpKSwgXG4gICAgICAgICAgICAgICAgY29sb3IgKiAwLjA3NzM5OTM4MDgsIFxuICAgICAgICAgICAgICAgIGNvbG9yIDw9IHZlYzMoMC4wNDA0NSksIFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSAgXG5cbiAgICAgICAgQHZlcnRleCBcbiAgICAgICAgZm4gdnMoaW5EYXRhOiBWZXJ0SW4pIC0+IFZlcnRPdXQge1xuICAgICAgICAgICAgdmFyIHZzT3V0OiBWZXJ0T3V0O1xuICAgICAgICAgICAgbGV0IGluc3RhbmNlID0gaW5zdGFuY2VzW2luRGF0YS5pbnN0YW5jZV07XG4gICAgICAgICAgICBsZXQgd29ybGRQb3MgPSBpbnN0YW5jZS5tb2RlbFRvV29ybGRNYXRyaXggKiB2ZWM0ZihpbkRhdGEucG9zLCAxKTtcbiAgICAgICAgICAgIHZzT3V0LnBvcyA9IHdvcmxkUG9zLnh5ejtcbiAgICAgICAgICAgIHZzT3V0LlBvc2l0aW9uID0gZ2xvYmFscy53b3JsZFRvQ2xpcCAqIHdvcmxkUG9zO1xuICAgICAgICAgICAgdnNPdXQuY2FtUG9zID0gZ2xvYmFscy5pbnZlcnNlV29ybGRUb1ZpZXdbM10ueHl6O1xuICAgICAgICAgICAgdnNPdXQudXYgPSBpbkRhdGEudXY7XG5cbiAgICAgICAgICAgICR7aWZkZWYoUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscywgLyogd2dzbCAqL2BcbiAgICAgICAgICAgICAgICB2c091dC5ub3JtYWwgPSBub3JtYWxpemUoaW5zdGFuY2Uubm9ybWFsTWF0cml4ICogaW5EYXRhLm5vcm1hbCk7XG4gICAgICAgICAgICAgICAgbGV0IHdzVGFuZ2VudCA9IG5vcm1hbGl6ZSgoaW5zdGFuY2UubW9kZWxUb1dvcmxkTWF0cml4ICogdmVjNChpbkRhdGEudGFuZ2VudC54eXosIDAuMCkpLnh5eik7XG4gICAgICAgICAgICAgICAgdnNPdXQudGFuZ2VudCA9IHZlYzQod3NUYW5nZW50LCBpbkRhdGEudGFuZ2VudC53KTtcbiAgICAgICAgICAgIGApfVxuXG4gICAgICAgICAgICByZXR1cm4gdnNPdXQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBtdWNoIG9mIHRoaXMgY29kZSBpcyBhZGFwdGVkIGZyb20gaHR0cHM6Ly9sZWFybm9wZW5nbC5jb20vUEJSXG4gICAgICAgIEBmcmFnbWVudFxuICAgICAgICBmbiBmcyhpbkRhdGE6IEZyYWdJbikgLT4gRm9yd2FyZE91dCB7XG4gICAgICAgICAgICB2YXIgb3V0OiBGb3J3YXJkT3V0O1xuICAgICAgICAgICAgbGV0IHJhd0NvbG9yOiB2ZWM0ZiA9IHRleHR1cmVTYW1wbGUoYmFzZUNvbG9yVGV4dHVyZSwgYmFzZUNvbG9yU2FtcGxlciwgaW5EYXRhLnV2KTtcblxuICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5BbHBoYUN1dG9mZiwgLyogd2dzbCAqL2BcbiAgICAgICAgICAgICAgICB2YXIgYWxwaGEgPSByYXdDb2xvci5hICogbWF0ZXJpYWwuYmFzZUNvbG9yRmFjdG9yLmE7XG5cbiAgICAgICAgICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleENvbG9ycywgLyogd2dzbCAqL2BcbiAgICAgICAgICAgICAgICAgICAgYWxwaGEgKj0gaW5EYXRhLmNvbG9yLmE7XG4gICAgICAgICAgICAgICAgYCl9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWxwaGEgPD0gbWF0ZXJpYWwuYWxwaGFDdXRvZmYpIHsgXG4gICAgICAgICAgICAgICAgICAgIGRpc2NhcmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgYCl9XG5cbiAgICAgICAgICAgIG91dC5hbGJlZG8gPSB2ZWM0ZihyYXdDb2xvci5yZ2IgKiBtYXRlcmlhbC5iYXNlQ29sb3JGYWN0b3IucmdiLCAxKTtcblxuICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhDb2xvcnMsIC8qIHdnc2wgKi9gXG4gICAgICAgICAgICAgICAgb3V0LmFsYmVkbyAqPSB2ZWM0ZihpbkRhdGEuY29sb3IucmdiLCAxKTtcbiAgICAgICAgICAgIGApfVxuXG4gICAgICAgICAgICBsZXQgbWV0YWxsaWNSb3VnaG5lc3MgPSB0ZXh0dXJlU2FtcGxlKG1ldGFsbGljUm91Z2huZXNzVGV4dHVyZSwgbWV0YWxsaWNSb3VnaG5lc3NTYW1wbGVyLCBpbkRhdGEudXYpO1xuICAgICAgICAgICAgb3V0Lm1ldGFsbGljUm91Z2huZXNzLnIgPSBzYXR1cmF0ZShtZXRhbGxpY1JvdWdobmVzcy5iICogbWF0ZXJpYWwubWV0YWxsaWNGYWN0b3IpO1xuICAgICAgICAgICAgb3V0Lm1ldGFsbGljUm91Z2huZXNzLmcgPSBzYXR1cmF0ZShtZXRhbGxpY1JvdWdobmVzcy5nICogbWF0ZXJpYWwucm91Z2huZXNzRmFjdG9yKTtcblxuICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhOb3JtYWxzLCAvKiB3Z3NsICovYFxuICAgICAgICAgICAgICAgIGxldCBub3JtYWxTYW1wbGUgPSB0ZXh0dXJlU2FtcGxlKG5vcm1hbFRleHR1cmUsIG5vcm1hbFNhbXBsZXIsIGluRGF0YS51dikueHl6O1xuICAgICAgICAgICAgICAgIGxldCB0YW5nZW50Tm9ybWFsID0gbm9ybWFsaXplKG5vcm1hbFNhbXBsZSAqIDIuMCAtIDEuMCk7XG4gICAgICAgICAgICAgICAgbGV0IGJpdGFuZ2VudCA9aW5EYXRhLnRhbmdlbnQudyAqIGNyb3NzKGluRGF0YS5ub3JtYWwsIGluRGF0YS50YW5nZW50Lnh5eik7XG4gICAgICAgICAgICAgICAgbGV0IHRibiA9IG1hdDN4M2Yobm9ybWFsaXplKGluRGF0YS50YW5nZW50Lnh5eiksIGJpdGFuZ2VudCwgbm9ybWFsaXplKGluRGF0YS5ub3JtYWwpKTtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsID0gbm9ybWFsaXplKHRibiAqIHRhbmdlbnROb3JtYWwpO1xuXG4gICAgICAgICAgICAgICAgJHtpZmRlZihQaXBlbGluZUZlYXR1cmVGbGFncy5Eb3VibGVTaWRlZCwgLyogd2dzbCAqL2BcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbkRhdGEuZnJvbnRfZmFjaW5nKSB7IG5vcm1hbCAqPSAtMS4wOyB9XG4gICAgICAgICAgICAgICAgYCl9XG4gICAgICAgICAgICBgKS5lbHNlKC8qIHdnc2wgKi9gXG4gICAgICAgICAgICAgICAgbGV0IGZkeCA9IGRwZHgoaW5EYXRhLnBvcyk7XG4gICAgICAgICAgICAgICAgbGV0IGZkeSA9IGRwZHkoaW5EYXRhLnBvcyk7XG4gICAgICAgICAgICAgICAgbGV0IG5vcm1hbCA9IG5vcm1hbGl6ZShjcm9zcyhmZHgsIGZkeSkpO1xuICAgICAgICAgICAgYCl9XG5cbiAgICAgICAgICAgIG91dC5ub3JtYWwgPSB2ZWM0Zihub3JtYWwsIDEpO1xuXG4gICAgICAgICAgICAke2lmZGVmKFBpcGVsaW5lRmVhdHVyZUZsYWdzLkVtaXNzaXZlLCAvKiB3Z3NsICovYFxuICAgICAgICAgICAgICAgIGxldCBlbWlzc2lvbiA9IHRleHR1cmVTYW1wbGUoZW1pc3Npb25UZXh0dXJlLCBlbWlzc2lvblNhbXBsZXIsIGluRGF0YS51dikucmdiO1xuICAgICAgICAgICAgICAgIG91dC5lbWlzc2lvbiA9IHZlYzRmKGVtaXNzaW9uLCAxKTtcbiAgICAgICAgICAgIGApfVxuXG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9XG4gICAgYDtcbn1cbiIsImltcG9ydCB7IFBpcGVsaW5lRmVhdHVyZUZsYWdzIH0gZnJvbSAnLi9waXBlbGluZS1mZWF0dXJlLWZsYWdzJztcbmltcG9ydCAqIGFzIFBpcGVsaW5lRmVhdHVyZXMgZnJvbSAnLi9waXBlbGluZS1mZWF0dXJlLWZsYWdzJztcbmltcG9ydCBpbmNsdWRlLCB7IGdldEJpbmRncm91cEluZm8gYXMgZ2V0QmluZEdyb3VwSW5mbyB9IGZyb20gJy4uLy4uL3NoYWRlcnMvZm9yd2FyZC5zaGFkZXInO1xuXG5pbXBvcnQgR0J1ZmZlciBmcm9tICcuLi9nYnVmZmVyJztcbmltcG9ydCBHbG9iYWxVbmlmb3JtcyBmcm9tICcuLi9nbG9iYWwtdW5pZm9ybXMnO1xuXG50eXBlIFBpcGVsaW5lRmVhdHVyZU1hcDxUPiA9IFBhcnRpYWw8UmVjb3JkPG51bWJlciwgVD4+O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEZXNjcmlwdG9yTWFwIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZmxhZ1RvVG9wb2xvZ3k6IFBhcnRpYWw8UmVjb3JkPFBpcGVsaW5lRmVhdHVyZUZsYWdzLCBHUFVQcmltaXRpdmVUb3BvbG9neT4+ID0ge1xuICAgICAgICBbUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVHJpYW5nbGVMaXN0XTogJ3RyaWFuZ2xlLWxpc3QnLFxuICAgICAgICBbUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVHJpYW5nbGVTdHJpcF06ICd0cmlhbmdsZS1zdHJpcCcsXG4gICAgICAgIFtQaXBlbGluZUZlYXR1cmVGbGFncy5Qb2ludExpc3RdOiAncG9pbnQtbGlzdCcsXG4gICAgICAgIFtQaXBlbGluZUZlYXR1cmVGbGFncy5MaW5lTGlzdF06ICdsaW5lLWxpc3QnLFxuICAgICAgICBbUGlwZWxpbmVGZWF0dXJlRmxhZ3MuTGluZVN0cmlwXTogJ2xpbmUtc3RyaXAnLFxuICAgIH07XG5cbiAgICByZWFkb25seSBwaXBlbGluZUxheW91dHM6IFBpcGVsaW5lRmVhdHVyZU1hcDxHUFVQaXBlbGluZUxheW91dD4gPSB7fTtcbiAgICByZWFkb25seSBwcmltaXRpdmVTdGF0ZXM6IFBpcGVsaW5lRmVhdHVyZU1hcDxHUFVQcmltaXRpdmVTdGF0ZT4gPSB7fTtcbiAgICByZWFkb25seSB2ZXJ0ZXhMYXlvdXRzOiBQaXBlbGluZUZlYXR1cmVNYXA8R1BVVmVydGV4QnVmZmVyTGF5b3V0PiA9IHt9O1xuICAgIHJlYWRvbmx5IHNoYWRlck1vZHVsZXM6IFBpcGVsaW5lRmVhdHVyZU1hcDxHUFVTaGFkZXJNb2R1bGU+ID0ge307XG4gICAgcmVhZG9ubHkgYmluZGdyb3VwTGF5b3V0czogUGlwZWxpbmVGZWF0dXJlTWFwPEdQVUJpbmRHcm91cExheW91dD4gPSB7fTtcblxuICAgIHJlYWRvbmx5IHNhbXBsZXJzOiBQYXJ0aWFsPFJlY29yZDxzdHJpbmcsIEdQVVNhbXBsZXI+PiA9IHt9O1xuXG4gICAgcmVhZG9ubHkgZm9yd2FyZEJpbmRncm91cExheW91dCA9IHRoaXMuZGV2aWNlLmNyZWF0ZUJpbmRHcm91cExheW91dCh7XG4gICAgICAgIGxhYmVsOiBgZm9yd2FyZCBtYXRlcmlhbGAsXG4gICAgICAgIGVudHJpZXM6IFt7XG4gICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgdmlzaWJpbGl0eTogR1BVU2hhZGVyU3RhZ2UuVkVSVEVYIHwgR1BVU2hhZGVyU3RhZ2UuRlJBR01FTlQsXG4gICAgICAgICAgICBidWZmZXI6IHsgdHlwZTogJ3JlYWQtb25seS1zdG9yYWdlJyB9LFxuICAgICAgICB9XSxcbiAgICB9KTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgcmVhZG9ubHkgZGV2aWNlOiBHUFVEZXZpY2UsXG4gICAgICAgIHB1YmxpYyByZWFkb25seSBnYnVmZmVyOiBHQnVmZmVyLFxuICAgICAgICBwdWJsaWMgcmVhZG9ubHkgZ2xvYmFsczogR2xvYmFsVW5pZm9ybXMsXG4gICAgKSB7IH1cblxuICAgIGdldFNhbXBsZXIoZGVzY3JpcHRvcjogR1BVU2FtcGxlckRlc2NyaXB0b3IpIHtcbiAgICAgICAgY29uc3Qga2V5ID0gSlNPTi5zdHJpbmdpZnkoZGVzY3JpcHRvcik7XG4gICAgICAgIHRoaXMuc2FtcGxlcnNba2V5XSA/Pz0gdGhpcy5kZXZpY2UuY3JlYXRlU2FtcGxlcihkZXNjcmlwdG9yKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2FtcGxlcnNba2V5XTtcbiAgICB9XG5cbiAgICBnZXRWZXJ0ZXhMYXlvdXQoZmxhZ3M6IFBpcGVsaW5lRmVhdHVyZUZsYWdzKSB7XG4gICAgICAgIGNvbnN0IG1hc2tlZDogUGlwZWxpbmVGZWF0dXJlRmxhZ3MgPSBmbGFncyAmIFBpcGVsaW5lRmVhdHVyZXMuVmVydGV4QnVmZmVyTGF5b3V0TWFzaztcblxuICAgICAgICBpZiAodGhpcy52ZXJ0ZXhMYXlvdXRzW21hc2tlZF0gPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlczogR1BVVmVydGV4QXR0cmlidXRlW10gPSBbXG4gICAgICAgICAgICAgICAgeyBzaGFkZXJMb2NhdGlvbjogMCwgb2Zmc2V0OiAwLCBmb3JtYXQ6ICdmbG9hdDMyeDMnIH0sIC8vIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgeyBzaGFkZXJMb2NhdGlvbjogMSwgb2Zmc2V0OiAxMiwgZm9ybWF0OiAnZmxvYXQzMngyJyB9LCAvLyB1dlxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgbGV0IGFycmF5U3RyaWRlID0gMjA7XG4gICAgICAgICAgICBsZXQgc2hhZGVyTG9jYXRpb24gPSAyO1xuXG4gICAgICAgICAgICBpZiAobWFza2VkICYgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscykge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaCh7IHNoYWRlckxvY2F0aW9uLCBvZmZzZXQ6IGFycmF5U3RyaWRlLCBmb3JtYXQ6ICdmbG9hdDMyeDQnIH0pOyAvLyB0YW5nZW50XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKHsgc2hhZGVyTG9jYXRpb246IHNoYWRlckxvY2F0aW9uICsgMSwgb2Zmc2V0OiBhcnJheVN0cmlkZSArIDE2LCBmb3JtYXQ6ICdmbG9hdDMyeDMnIH0pOyAvLyBub3JtYWxcbiAgICAgICAgICAgICAgICBzaGFkZXJMb2NhdGlvbiArPSAyO1xuICAgICAgICAgICAgICAgIGFycmF5U3RyaWRlICs9IDI4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobWFza2VkICYgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Q29sb3JzKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKHsgc2hhZGVyTG9jYXRpb24sIG9mZnNldDogYXJyYXlTdHJpZGUsIGZvcm1hdDogJ2Zsb2F0MzJ4NCcgfSk7IC8vIGNvbG9yXG4gICAgICAgICAgICAgICAgYXJyYXlTdHJpZGUgKz0gMTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudmVydGV4TGF5b3V0c1ttYXNrZWRdID0geyBhdHRyaWJ1dGVzLCBhcnJheVN0cmlkZSwgc3RlcE1vZGU6ICd2ZXJ0ZXgnIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy52ZXJ0ZXhMYXlvdXRzW21hc2tlZF07XG4gICAgfVxuXG4gICAgZ2V0Rm9yd2FyZFBpcGVsaW5lTGF5b3V0KGZsYWdzOiBQaXBlbGluZUZlYXR1cmVGbGFncykge1xuICAgICAgICBjb25zdCBtYXNrZWQ6IFBpcGVsaW5lRmVhdHVyZUZsYWdzID0gZmxhZ3MgJiBQaXBlbGluZUZlYXR1cmVzLlBpcGVsaW5lTGF5b3V0TWFzaztcblxuICAgICAgICB0aGlzLnBpcGVsaW5lTGF5b3V0c1ttYXNrZWRdID8/PSB0aGlzLmRldmljZS5jcmVhdGVQaXBlbGluZUxheW91dCh7XG4gICAgICAgICAgICBsYWJlbDogUGlwZWxpbmVGZWF0dXJlcy5mZWF0dXJlRmxhZ3NUb1N0cmluZyhtYXNrZWQpLFxuICAgICAgICAgICAgYmluZEdyb3VwTGF5b3V0czogW1xuICAgICAgICAgICAgICAgIHRoaXMuZ2xvYmFscy5iaW5kR3JvdXBMYXlvdXQsXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRNYXRlcmlhbEJpbmRHcm91cChmbGFncyksXG4gICAgICAgICAgICAgICAgdGhpcy5mb3J3YXJkQmluZGdyb3VwTGF5b3V0LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucGlwZWxpbmVMYXlvdXRzW21hc2tlZF07XG4gICAgfVxuXG4gICAgZ2V0U2hhZGVyTW9kdWxlKGZsYWdzOiBQaXBlbGluZUZlYXR1cmVGbGFncykge1xuICAgICAgICBjb25zdCBtYXNrZWQ6IFBpcGVsaW5lRmVhdHVyZUZsYWdzID0gZmxhZ3MgJiBQaXBlbGluZUZlYXR1cmVzLkNvZGVNYXNrO1xuICAgICAgICB0aGlzLnNoYWRlck1vZHVsZXNbbWFza2VkXSA/Pz0gdGhpcy5kZXZpY2UuY3JlYXRlU2hhZGVyTW9kdWxlKHtcbiAgICAgICAgICAgIGxhYmVsOiBQaXBlbGluZUZlYXR1cmVzLmZlYXR1cmVGbGFnc1RvU3RyaW5nKG1hc2tlZCksXG4gICAgICAgICAgICBjb2RlOiBpbmNsdWRlKG1hc2tlZCksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5zaGFkZXJNb2R1bGVzW21hc2tlZF07XG4gICAgfVxuXG4gICAgZ2V0UHJpbWl0aXZlU3RhdGUoZmxhZ3M6IFBpcGVsaW5lRmVhdHVyZUZsYWdzKSB7XG4gICAgICAgIGNvbnN0IG1hc2tlZCA9IGZsYWdzICYgUGlwZWxpbmVGZWF0dXJlcy5QcmltaXRpdmVTdGF0ZU1hc2s7XG5cbiAgICAgICAgdGhpcy5wcmltaXRpdmVTdGF0ZXNbbWFza2VkXSA/Pz0ge1xuICAgICAgICAgICAgdG9wb2xvZ3k6IERlc2NyaXB0b3JNYXAuZmxhZ1RvVG9wb2xvZ3lbKGZsYWdzICYgUGlwZWxpbmVGZWF0dXJlcy5Ub3BvbG9neUZvcm1hdE1hc2spIGFzIFBpcGVsaW5lRmVhdHVyZUZsYWdzXSxcbiAgICAgICAgICAgIGN1bGxNb2RlOiBtYXNrZWQgJiBQaXBlbGluZUZlYXR1cmVGbGFncy5Eb3VibGVTaWRlZCA/ICdub25lJyA6ICdiYWNrJyxcbiAgICAgICAgICAgIGZyb250RmFjZTogbWFza2VkICYgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuQ2xvY2t3aXNlV2luZGluZyA/ICdjdycgOiAnY2N3JyxcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdGhpcy5wcmltaXRpdmVTdGF0ZXNbbWFza2VkXTtcbiAgICB9XG5cbiAgICBnZXRNYXRlcmlhbEJpbmRHcm91cChmbGFnczogUGlwZWxpbmVGZWF0dXJlRmxhZ3MpIHtcbiAgICAgICAgY29uc3QgbWFza2VkID0gZmxhZ3MgJiBQaXBlbGluZUZlYXR1cmVzLk1hdGVyaWFsQmluZGdyb3VwTGF5b3V0TWFzaztcbiAgICAgICAgdGhpcy5iaW5kZ3JvdXBMYXlvdXRzW21hc2tlZF0gPz89IHRoaXMuZGV2aWNlLmNyZWF0ZUJpbmRHcm91cExheW91dChnZXRCaW5kR3JvdXBJbmZvKG1hc2tlZCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5iaW5kZ3JvdXBMYXlvdXRzW21hc2tlZF07XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///291\n")},8452:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FO: () => (/* binding */ PipelineLayoutMask),\n/* harmony export */   Ot: () => (/* binding */ PipelineFeatureFlags),\n/* harmony export */   P7: () => (/* binding */ maskRedundantFeatures),\n/* harmony export */   Py: () => (/* binding */ TopologyFormatMask),\n/* harmony export */   Q7: () => (/* binding */ CodeMask),\n/* harmony export */   UZ: () => (/* binding */ featureFlagsToString),\n/* harmony export */   V3: () => (/* binding */ VertexBufferLayoutMask),\n/* harmony export */   Wq: () => (/* binding */ MaterialBindgroupLayoutMask),\n/* harmony export */   XY: () => (/* binding */ PrimitiveStateMask)\n/* harmony export */ });\n/* unused harmony exports InstanceBufferLayoutMask, MaterialBufferLayoutMask, MaterialMask, featureFlagsToNames */\nvar PipelineFeatureFlags;\n(function (PipelineFeatureFlags) {\n    PipelineFeatureFlags[PipelineFeatureFlags["Defaults"] = 0] = "Defaults";\n    /**\n     * If the meshes have vertex normals.\n     * If absent, meshes are shaded with flat normals.\n    */\n    PipelineFeatureFlags[PipelineFeatureFlags["VertexNormals"] = 1] = "VertexNormals";\n    /**\n     * If the meshes have vertex colors.\n     * If absent, mesh is shaded with a base color texture.\n    */\n    PipelineFeatureFlags[PipelineFeatureFlags["VertexColors"] = 2] = "VertexColors";\n    PipelineFeatureFlags[PipelineFeatureFlags["AlphaCutoff"] = 4] = "AlphaCutoff";\n    PipelineFeatureFlags[PipelineFeatureFlags["Emissive"] = 8] = "Emissive";\n    PipelineFeatureFlags[PipelineFeatureFlags["DoubleSided"] = 16] = "DoubleSided";\n    PipelineFeatureFlags[PipelineFeatureFlags["ClockwiseWinding"] = 32] = "ClockwiseWinding";\n    // Topology formats\n    PipelineFeatureFlags[PipelineFeatureFlags["TriangleList"] = 0] = "TriangleList";\n    PipelineFeatureFlags[PipelineFeatureFlags["TriangleStrip"] = 64] = "TriangleStrip";\n    PipelineFeatureFlags[PipelineFeatureFlags["PointList"] = 128] = "PointList";\n    PipelineFeatureFlags[PipelineFeatureFlags["LineList"] = 192] = "LineList";\n    PipelineFeatureFlags[PipelineFeatureFlags["LineStrip"] = 256] = "LineStrip";\n    PipelineFeatureFlags[PipelineFeatureFlags["Unindexed"] = 320] = "Unindexed";\n    // LINE_LOOP (currently unsupported by webgpu)\n    // TRIANGLE_FAN (currently unsupported by webgpu)\n})(PipelineFeatureFlags || (PipelineFeatureFlags = {}));\nconst TopologyFormatMask = 0x111 << 6;\nconst PrimitiveStateMask = (TopologyFormatMask\n    | PipelineFeatureFlags.DoubleSided\n    | PipelineFeatureFlags.ClockwiseWinding);\nconst CodeMask = ~(TopologyFormatMask\n    | PipelineFeatureFlags.ClockwiseWinding);\nconst InstanceBufferLayoutMask = (PipelineFeatureFlags.VertexNormals);\nconst VertexBufferLayoutMask = (PipelineFeatureFlags.VertexNormals\n    | PipelineFeatureFlags.VertexColors);\nconst MaterialBufferLayoutMask = (PipelineFeatureFlags.AlphaCutoff);\nconst MaterialBindgroupLayoutMask = (MaterialBufferLayoutMask\n    | PipelineFeatureFlags.Emissive);\nconst MaterialMask = (MaterialBindgroupLayoutMask\n    | PipelineFeatureFlags.DoubleSided);\nconst PipelineLayoutMask = (InstanceBufferLayoutMask\n    | MaterialMask);\nfunction featureFlagsToNames(val) {\n    return Object.entries(PipelineFeatureFlags)\n        .flatMap(([key, flag]) => typeof flag === \'number\' && (flag & val) ? key : []);\n}\nfunction featureFlagsToString(val) {\n    return featureFlagsToNames(val).toString();\n}\nfunction maskRedundantFeatures(flags) {\n    let masked = flags;\n    if (masked & PipelineFeatureFlags.DoubleSided)\n        masked &= ~PipelineFeatureFlags.ClockwiseWinding;\n    return masked;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODQ1Mi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxJQUFZLG9CQThCWDtBQTlCRCxXQUFZLG9CQUFvQjtJQUM1Qix1RUFBWTtJQUVaOzs7TUFHRTtJQUNGLGlGQUFzQjtJQUV0Qjs7O01BR0U7SUFDRiwrRUFBcUI7SUFFckIsNkVBQW9CO0lBQ3BCLHVFQUFpQjtJQUVqQiw4RUFBb0I7SUFDcEIsd0ZBQXlCO0lBRXpCLG1CQUFtQjtJQUNuQiwrRUFBcUI7SUFDckIsa0ZBQXNCO0lBQ3RCLDJFQUFrQjtJQUNsQix5RUFBaUI7SUFDakIsMkVBQWtCO0lBQ2xCLDJFQUFrQjtJQUNsQiw4Q0FBOEM7SUFDOUMsaURBQWlEO0FBQ3JELENBQUMsRUE5Qlcsb0JBQW9CLEtBQXBCLG9CQUFvQixRQThCL0I7QUFFTSxNQUFNLGtCQUFrQixHQUFHLEtBQUssSUFBSSxDQUFDLENBQUM7QUFFdEMsTUFBTSxrQkFBa0IsR0FBRyxDQUM5QixrQkFBa0I7TUFDaEIsb0JBQW9CLENBQUMsV0FBVztNQUNoQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FDMUMsQ0FBQztBQUVLLE1BQU0sUUFBUSxHQUFHLENBQUMsQ0FDckIsa0JBQWtCO01BQ2hCLG9CQUFvQixDQUFDLGdCQUFnQixDQUMxQyxDQUFDO0FBRUssTUFBTSx3QkFBd0IsR0FBRyxDQUNwQyxvQkFBb0IsQ0FBQyxhQUFhLENBQ3JDLENBQUM7QUFFSyxNQUFNLHNCQUFzQixHQUFHLENBQ2xDLG9CQUFvQixDQUFDLGFBQWE7TUFDaEMsb0JBQW9CLENBQUMsWUFBWSxDQUN0QyxDQUFDO0FBRUssTUFBTSx3QkFBd0IsR0FBRyxDQUNwQyxvQkFBb0IsQ0FBQyxXQUFXLENBQ25DLENBQUM7QUFFSyxNQUFNLDJCQUEyQixHQUFHLENBQ3ZDLHdCQUF3QjtNQUN0QixvQkFBb0IsQ0FBQyxRQUFRLENBQ2xDLENBQUM7QUFFSyxNQUFNLFlBQVksR0FBRyxDQUN4QiwyQkFBMkI7TUFDekIsb0JBQW9CLENBQUMsV0FBVyxDQUNyQyxDQUFDO0FBRUssTUFBTSxrQkFBa0IsR0FBRyxDQUM5Qix3QkFBd0I7TUFDdEIsWUFBWSxDQUNqQixDQUFDO0FBRUssU0FBUyxtQkFBbUIsQ0FBQyxHQUFXO0lBQzNDLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztTQUN0QyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3ZGLENBQUM7QUFFTSxTQUFTLG9CQUFvQixDQUFDLEdBQVc7SUFDNUMsT0FBTyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUMvQyxDQUFDO0FBRU0sU0FBUyxxQkFBcUIsQ0FBQyxLQUEyQjtJQUM3RCxJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUM7SUFDbkIsSUFBSSxNQUFNLEdBQUcsb0JBQW9CLENBQUMsV0FBVztRQUFFLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixDQUFDLGdCQUFnQixDQUFDO0lBQ2hHLE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL3BpcGVsaW5lLWZlYXR1cmUtZmxhZ3MudHM/NGI5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZW51bSBQaXBlbGluZUZlYXR1cmVGbGFncyB7XG4gICAgRGVmYXVsdHMgPSAwLFxuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIG1lc2hlcyBoYXZlIHZlcnRleCBub3JtYWxzLlxuICAgICAqIElmIGFic2VudCwgbWVzaGVzIGFyZSBzaGFkZWQgd2l0aCBmbGF0IG5vcm1hbHMuXG4gICAgKi9cbiAgICBWZXJ0ZXhOb3JtYWxzID0gMSA8PCAwLFxuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIG1lc2hlcyBoYXZlIHZlcnRleCBjb2xvcnMuXG4gICAgICogSWYgYWJzZW50LCBtZXNoIGlzIHNoYWRlZCB3aXRoIGEgYmFzZSBjb2xvciB0ZXh0dXJlLlxuICAgICovXG4gICAgVmVydGV4Q29sb3JzID0gMSA8PCAxLFxuXG4gICAgQWxwaGFDdXRvZmYgPSAxIDw8IDIsXG4gICAgRW1pc3NpdmUgPSAxIDw8IDMsXG5cbiAgICBEb3VibGVTaWRlZCA9IDEgPDwgNCxcbiAgICBDbG9ja3dpc2VXaW5kaW5nID0gMSA8PCA1LFxuXG4gICAgLy8gVG9wb2xvZ3kgZm9ybWF0c1xuICAgIFRyaWFuZ2xlTGlzdCA9IDAgPDwgNixcbiAgICBUcmlhbmdsZVN0cmlwID0gMSA8PCA2LFxuICAgIFBvaW50TGlzdCA9IDIgPDwgNixcbiAgICBMaW5lTGlzdCA9IDMgPDwgNixcbiAgICBMaW5lU3RyaXAgPSA0IDw8IDYsXG4gICAgVW5pbmRleGVkID0gNSA8PCA2LFxuICAgIC8vIExJTkVfTE9PUCAoY3VycmVudGx5IHVuc3VwcG9ydGVkIGJ5IHdlYmdwdSlcbiAgICAvLyBUUklBTkdMRV9GQU4gKGN1cnJlbnRseSB1bnN1cHBvcnRlZCBieSB3ZWJncHUpXG59XG5cbmV4cG9ydCBjb25zdCBUb3BvbG9neUZvcm1hdE1hc2sgPSAweDExMSA8PCA2O1xuXG5leHBvcnQgY29uc3QgUHJpbWl0aXZlU3RhdGVNYXNrID0gKFxuICAgIFRvcG9sb2d5Rm9ybWF0TWFza1xuICAgIHwgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuRG91YmxlU2lkZWRcbiAgICB8IFBpcGVsaW5lRmVhdHVyZUZsYWdzLkNsb2Nrd2lzZVdpbmRpbmdcbik7XG5cbmV4cG9ydCBjb25zdCBDb2RlTWFzayA9IH4oXG4gICAgVG9wb2xvZ3lGb3JtYXRNYXNrXG4gICAgfCBQaXBlbGluZUZlYXR1cmVGbGFncy5DbG9ja3dpc2VXaW5kaW5nXG4pO1xuXG5leHBvcnQgY29uc3QgSW5zdGFuY2VCdWZmZXJMYXlvdXRNYXNrID0gKFxuICAgIFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleE5vcm1hbHNcbik7XG5cbmV4cG9ydCBjb25zdCBWZXJ0ZXhCdWZmZXJMYXlvdXRNYXNrID0gKFxuICAgIFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleE5vcm1hbHNcbiAgICB8IFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleENvbG9yc1xuKTtcblxuZXhwb3J0IGNvbnN0IE1hdGVyaWFsQnVmZmVyTGF5b3V0TWFzayA9IChcbiAgICBQaXBlbGluZUZlYXR1cmVGbGFncy5BbHBoYUN1dG9mZlxuKTtcblxuZXhwb3J0IGNvbnN0IE1hdGVyaWFsQmluZGdyb3VwTGF5b3V0TWFzayA9IChcbiAgICBNYXRlcmlhbEJ1ZmZlckxheW91dE1hc2tcbiAgICB8IFBpcGVsaW5lRmVhdHVyZUZsYWdzLkVtaXNzaXZlXG4pO1xuXG5leHBvcnQgY29uc3QgTWF0ZXJpYWxNYXNrID0gKFxuICAgIE1hdGVyaWFsQmluZGdyb3VwTGF5b3V0TWFza1xuICAgIHwgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuRG91YmxlU2lkZWRcbik7XG5cbmV4cG9ydCBjb25zdCBQaXBlbGluZUxheW91dE1hc2sgPSAoXG4gICAgSW5zdGFuY2VCdWZmZXJMYXlvdXRNYXNrXG4gICAgfCBNYXRlcmlhbE1hc2tcbik7XG5cbmV4cG9ydCBmdW5jdGlvbiBmZWF0dXJlRmxhZ3NUb05hbWVzKHZhbDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKFBpcGVsaW5lRmVhdHVyZUZsYWdzKVxuICAgICAgICAuZmxhdE1hcCgoW2tleSwgZmxhZ10pID0+IHR5cGVvZiBmbGFnID09PSAnbnVtYmVyJyAmJiAoZmxhZyAmIHZhbCkgPyBrZXkgOiBbXSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmZWF0dXJlRmxhZ3NUb1N0cmluZyh2YWw6IG51bWJlcikge1xuICAgIHJldHVybiBmZWF0dXJlRmxhZ3NUb05hbWVzKHZhbCkudG9TdHJpbmcoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hc2tSZWR1bmRhbnRGZWF0dXJlcyhmbGFnczogUGlwZWxpbmVGZWF0dXJlRmxhZ3MpIHtcbiAgICBsZXQgbWFza2VkID0gZmxhZ3M7XG4gICAgaWYgKG1hc2tlZCAmIFBpcGVsaW5lRmVhdHVyZUZsYWdzLkRvdWJsZVNpZGVkKSBtYXNrZWQgJj0gflBpcGVsaW5lRmVhdHVyZUZsYWdzLkNsb2Nrd2lzZVdpbmRpbmc7XG4gICAgcmV0dXJuIG1hc2tlZDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///8452\n')},2462:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _camera_camera__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8602);\n\nconst label = 'global uniforms';\nclass GlobalUniforms {\n    constructor(device) {\n        this.deviceBuffer = device.createBuffer(GlobalUniforms.bufferDescriptor);\n        this.bindGroupLayout = device.createBindGroupLayout(GlobalUniforms.layoutDescriptor);\n        this.bindGroupDescriptor = {\n            label,\n            layout: this.bindGroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: {\n                        buffer: this.deviceBuffer,\n                        offset: 0,\n                        size: GlobalUniforms.bufferSize,\n                    },\n                },\n            ],\n        };\n        this.bindgroup = device.createBindGroup(this.bindGroupDescriptor);\n    }\n    updateDeviceBuffer(queue, camera) {\n        camera.cacheView();\n        queue.writeBuffer(this.deviceBuffer, 0, camera.buffer);\n    }\n}\nGlobalUniforms.code = (group) => /* wgsl */ `\r\n        struct GlobalUniforms {\r\n            worldToView: mat4x4f,\r\n            viewToClip: mat4x4f,\r\n            worldToClip: mat4x4f,\r\n            inverseWorldToView: mat4x4f,\r\n            inverseViewToClip: mat4x4f,\r\n            inverseWorldToClip: mat4x4f,\r\n        }\r\n\r\n        @group(${group}) @binding(0) var<uniform> globals: GlobalUniforms;\r\n    `;\nGlobalUniforms.bufferSize = _camera_camera__WEBPACK_IMPORTED_MODULE_0__/* [\"default\"] */ .A.bufferLength;\nGlobalUniforms.layoutDescriptor = {\n    label,\n    entries: [\n        {\n            binding: 0,\n            buffer: { minBindingSize: GlobalUniforms.bufferSize },\n            visibility: GPUShaderStage.VERTEX | GPUShaderStage.FRAGMENT,\n        },\n    ],\n};\nGlobalUniforms.bufferDescriptor = {\n    label,\n    size: GlobalUniforms.bufferSize,\n    usage: GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST,\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (GlobalUniforms);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQ2Mi5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQXFDO0FBRXJDLE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDO0FBRWhDLE1BQXFCLGNBQWM7SUFzQy9CLFlBQVksTUFBaUI7UUFDekIsSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3pFLElBQUksQ0FBQyxlQUFlLEdBQUcsTUFBTSxDQUFDLHFCQUFxQixDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBRXJGLElBQUksQ0FBQyxtQkFBbUIsR0FBRztZQUN2QixLQUFLO1lBQ0wsTUFBTSxFQUFFLElBQUksQ0FBQyxlQUFlO1lBQzVCLE9BQU8sRUFBRTtnQkFDTDtvQkFDSSxPQUFPLEVBQUUsQ0FBQztvQkFDVixRQUFRLEVBQUU7d0JBQ04sTUFBTSxFQUFFLElBQUksQ0FBQyxZQUFZO3dCQUN6QixNQUFNLEVBQUUsQ0FBQzt3QkFDVCxJQUFJLEVBQUUsY0FBYyxDQUFDLFVBQVU7cUJBQ2xDO2lCQUNKO2FBQ0o7U0FDSixDQUFDO1FBRUYsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQ3RFLENBQUM7SUFFRCxrQkFBa0IsQ0FBQyxLQUFlLEVBQUUsTUFBYztRQUM5QyxNQUFNLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDbkIsS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDM0QsQ0FBQzs7QUE5RGUsbUJBQUksR0FBRyxDQUFDLEtBQWEsRUFBRSxFQUFFLENBQUMsVUFBVTs7Ozs7Ozs7OztpQkFVdkMsS0FBSztLQUNqQixDQUFDO0FBRWMseUJBQVUsR0FBRywrREFBTSxDQUFDLFlBQVksQ0FBQztBQUVqQywrQkFBZ0IsR0FBaUM7SUFDN0QsS0FBSztJQUNMLE9BQU8sRUFBRTtRQUNMO1lBQ0ksT0FBTyxFQUFFLENBQUM7WUFDVixNQUFNLEVBQUUsRUFBRSxjQUFjLEVBQUUsY0FBYyxDQUFDLFVBQVUsRUFBRTtZQUNyRCxVQUFVLEVBQUUsY0FBYyxDQUFDLE1BQU0sR0FBRyxjQUFjLENBQUMsUUFBUTtTQUM5RDtLQUNKO0NBQ0osQ0FBQztBQUVjLCtCQUFnQixHQUF3QjtJQUNwRCxLQUFLO0lBQ0wsSUFBSSxFQUFFLGNBQWMsQ0FBQyxVQUFVO0lBQy9CLEtBQUssRUFBRSxjQUFjLENBQUMsT0FBTyxHQUFHLGNBQWMsQ0FBQyxRQUFRO0NBQzFELENBQUM7aUVBL0JlLGNBQWMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvcmVuZGVyaW5nL2dsb2JhbC11bmlmb3Jtcy50cz82ZTYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYW1lcmEgZnJvbSAnLi9jYW1lcmEvY2FtZXJhJztcclxuXHJcbmNvbnN0IGxhYmVsID0gJ2dsb2JhbCB1bmlmb3Jtcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHbG9iYWxVbmlmb3JtcyB7XHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgY29kZSA9IChncm91cDogbnVtYmVyKSA9PiAvKiB3Z3NsICovYFxyXG4gICAgICAgIHN0cnVjdCBHbG9iYWxVbmlmb3JtcyB7XHJcbiAgICAgICAgICAgIHdvcmxkVG9WaWV3OiBtYXQ0eDRmLFxyXG4gICAgICAgICAgICB2aWV3VG9DbGlwOiBtYXQ0eDRmLFxyXG4gICAgICAgICAgICB3b3JsZFRvQ2xpcDogbWF0NHg0ZixcclxuICAgICAgICAgICAgaW52ZXJzZVdvcmxkVG9WaWV3OiBtYXQ0eDRmLFxyXG4gICAgICAgICAgICBpbnZlcnNlVmlld1RvQ2xpcDogbWF0NHg0ZixcclxuICAgICAgICAgICAgaW52ZXJzZVdvcmxkVG9DbGlwOiBtYXQ0eDRmLFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQGdyb3VwKCR7Z3JvdXB9KSBAYmluZGluZygwKSB2YXI8dW5pZm9ybT4gZ2xvYmFsczogR2xvYmFsVW5pZm9ybXM7XHJcbiAgICBgO1xyXG5cclxuICAgIHN0YXRpYyByZWFkb25seSBidWZmZXJTaXplID0gQ2FtZXJhLmJ1ZmZlckxlbmd0aDtcclxuXHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgbGF5b3V0RGVzY3JpcHRvcjogR1BVQmluZEdyb3VwTGF5b3V0RGVzY3JpcHRvciA9IHtcclxuICAgICAgICBsYWJlbCxcclxuICAgICAgICBlbnRyaWVzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDAsXHJcbiAgICAgICAgICAgICAgICBidWZmZXI6IHsgbWluQmluZGluZ1NpemU6IEdsb2JhbFVuaWZvcm1zLmJ1ZmZlclNpemUgfSxcclxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLlZFUlRFWCB8IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICB9O1xyXG5cclxuICAgIHN0YXRpYyByZWFkb25seSBidWZmZXJEZXNjcmlwdG9yOiBHUFVCdWZmZXJEZXNjcmlwdG9yID0ge1xyXG4gICAgICAgIGxhYmVsLFxyXG4gICAgICAgIHNpemU6IEdsb2JhbFVuaWZvcm1zLmJ1ZmZlclNpemUsXHJcbiAgICAgICAgdXNhZ2U6IEdQVUJ1ZmZlclVzYWdlLlVOSUZPUk0gfCBHUFVCdWZmZXJVc2FnZS5DT1BZX0RTVCxcclxuICAgIH07XHJcblxyXG4gICAgZGV2aWNlQnVmZmVyOiBHUFVCdWZmZXI7XHJcbiAgICBiaW5kR3JvdXBMYXlvdXQ6IEdQVUJpbmRHcm91cExheW91dDtcclxuICAgIGJpbmRHcm91cERlc2NyaXB0b3IhOiBHUFVCaW5kR3JvdXBEZXNjcmlwdG9yO1xyXG4gICAgYmluZGdyb3VwITogR1BVQmluZEdyb3VwO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGRldmljZTogR1BVRGV2aWNlKSB7XHJcbiAgICAgICAgdGhpcy5kZXZpY2VCdWZmZXIgPSBkZXZpY2UuY3JlYXRlQnVmZmVyKEdsb2JhbFVuaWZvcm1zLmJ1ZmZlckRlc2NyaXB0b3IpO1xyXG4gICAgICAgIHRoaXMuYmluZEdyb3VwTGF5b3V0ID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cExheW91dChHbG9iYWxVbmlmb3Jtcy5sYXlvdXREZXNjcmlwdG9yKTtcclxuXHJcbiAgICAgICAgdGhpcy5iaW5kR3JvdXBEZXNjcmlwdG9yID0ge1xyXG4gICAgICAgICAgICBsYWJlbCxcclxuICAgICAgICAgICAgbGF5b3V0OiB0aGlzLmJpbmRHcm91cExheW91dCxcclxuICAgICAgICAgICAgZW50cmllczogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmRpbmc6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2U6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB0aGlzLmRldmljZUJ1ZmZlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBHbG9iYWxVbmlmb3Jtcy5idWZmZXJTaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuYmluZGdyb3VwID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cCh0aGlzLmJpbmRHcm91cERlc2NyaXB0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZURldmljZUJ1ZmZlcihxdWV1ZTogR1BVUXVldWUsIGNhbWVyYTogQ2FtZXJhKSB7XHJcbiAgICAgICAgY2FtZXJhLmNhY2hlVmlldygpO1xyXG4gICAgICAgIHF1ZXVlLndyaXRlQnVmZmVyKHRoaXMuZGV2aWNlQnVmZmVyLCAwLCBjYW1lcmEuYnVmZmVyKTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2462\n")},4164:(module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _settings_property_listener__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1058);\n/* harmony import */ var _settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(8545);\n/* harmony import */ var _rendering_default_forward_pass_descriptor_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(291);\n/* harmony import */ var _rendering_default_forward_pass_pipeline_feature_flags__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(8452);\n/* harmony import */ var _cubemap_blur_cubemap_guassian_pyramid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(7638);\n/* harmony import */ var _loader_gltf_loader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(459);\n/* harmony import */ var _utils_general__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(80);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__]);\n_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\nvar __classPrivateFieldGet = (undefined && undefined.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _GltfModel_settings;\n\n\n\n\n\n\n\nconst gltfIndex = await getGltfIndex();\nasync function getGltfIndex() {\n    const indexUrl = \"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Assets/main/Models/\" + \"model-index.json\";\n    const indexRes = await fetch(indexUrl);\n    const indexStr = await indexRes.text();\n    const indexJson = JSON.parse(indexStr);\n    if (!Array.isArray(indexJson)) {\n        throw new Error('could not load gtlf model index');\n    }\n    const entries = indexJson.flatMap((gltf) => {\n        if (!(0,_utils_general__WEBPACK_IMPORTED_MODULE_6__/* .isObject */ .Gv)(gltf)\n            || !('label' in gltf)\n            || typeof gltf.label !== 'string'\n            || !('name' in gltf)\n            || typeof gltf.name !== 'string'\n            || !('variants' in gltf)\n            || !(0,_utils_general__WEBPACK_IMPORTED_MODULE_6__/* .isObject */ .Gv)(gltf.variants)\n            || typeof gltf.variants.glTF !== 'string')\n            return [];\n        const { variants: { glTF: file }, label, name } = gltf;\n        const path = `${\"https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Assets/main/Models/\"}${name}/glTF/${file}`;\n        return [[label, path]];\n    });\n    return Object.fromEntries(entries);\n}\nclass GltfModel {\n    get depthTextureView() {\n        return this.descriptorMap.gbuffer.depth.view;\n    }\n    constructor(renderer) {\n        this.renderer = renderer;\n        this.geometryPipelines = {};\n        _GltfModel_settings.set(this, (0,_settings_property_listener__WEBPACK_IMPORTED_MODULE_0__/* [\"default\"] */ .A)({\n            skybox: (0,_settings_skybox_options__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A)(this),\n            model: {\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_0__/* .ListenerSyms */ .t.$type]: 'file',\n                [_settings_property_listener__WEBPACK_IMPORTED_MODULE_0__/* .ListenerSyms */ .t.$callback]: (val, key) => {\n                    if (key !== 'value' || val == null)\n                        return;\n                    if (typeof val === 'string' || val instanceof File) {\n                        void this.setModel(val);\n                    }\n                },\n                accept: '.hdr',\n                selection: {\n                    value: 'Environment Test',\n                    initialValues: gltfIndex,\n                },\n                process: (file) => file,\n            },\n        }));\n        this.settings = __classPrivateFieldGet(this, _GltfModel_settings, \"f\").publicSettings;\n        this.priority = 1000;\n        this.descriptorMap = new _rendering_default_forward_pass_descriptor_map__WEBPACK_IMPORTED_MODULE_2__/* [\"default\"] */ .A(renderer.device, renderer.gbuffer, renderer.globals);\n        this.device = renderer.device;\n        this.renderer.addForwardPass(this);\n    }\n    async setSkybox(skybox) {\n        await (0,_cubemap_blur_cubemap_guassian_pyramid__WEBPACK_IMPORTED_MODULE_4__/* [\"default\"] */ .A)({\n            texture: skybox,\n            device: this.renderer.device,\n            inPlace: true,\n            delayWork: requestAnimationFrame,\n        });\n        this.renderer.skybox = skybox;\n    }\n    async setModel(modelPath) {\n        const size = { width: 1, height: 1 };\n        const colorArray = new Float32Array([1, 1, 1, 1]);\n        const opaqueWhite = this.renderer.device.createTexture({\n            size,\n            format: 'rgba32float',\n            usage: GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST,\n        });\n        this.renderer.device.queue.writeTexture({ texture: opaqueWhite }, colorArray, {}, size);\n        const normalMap = this.renderer.device.createTexture({\n            size,\n            format: 'rgba32float',\n            usage: GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST,\n        });\n        colorArray.set([0.5, 0.5, 1, 1]);\n        this.renderer.device.queue.writeTexture({ texture: normalMap }, colorArray, {}, size);\n        const sampler = {\n            addressModeU: 'repeat',\n            addressModeV: 'repeat',\n            magFilter: 'linear',\n            minFilter: 'linear',\n            mipmapFilter: 'linear',\n        };\n        const matData = {\n            baseColorTexture: opaqueWhite,\n            baseColorFactor: [1, 1, 1, 1],\n            normalTexture: normalMap,\n            metallicRoughnessTexture: opaqueWhite,\n            metallicFactor: 1,\n            roughnessFactor: 1,\n            baseColorSampler: sampler,\n            normalSampler: sampler,\n            metallicRoughnessSampler: sampler,\n        };\n        this.geometryPipelines = await (0,_loader_gltf_loader__WEBPACK_IMPORTED_MODULE_5__/* [\"default\"] */ .A)(modelPath, this.renderer.device, this.descriptorMap, matData, GltfModel.goalLayout, {});\n    }\n    render({ encoder, gbuffer, globals }) {\n        const pass = encoder.beginRenderPass(gbuffer.passDescriptor);\n        pass.setBindGroup(0, globals.bindgroup);\n        for (const pipeline of Object.values(this.geometryPipelines)) {\n            pipeline?.draw(pass, this.renderer.device.queue);\n        }\n        pass.end();\n    }\n}\n_GltfModel_settings = new WeakMap();\nGltfModel.title = 'glTF Model Viewer';\nGltfModel.description = '';\nGltfModel.goalLayout = [\n    {\n        name: 'POSITION',\n        type: 'VEC3',\n        componentType: 5126 /* ComponentType.float32 */,\n    },\n    {\n        name: 'TEXCOORD_0',\n        type: 'VEC2',\n        componentType: 5126 /* ComponentType.float32 */,\n    },\n    {\n        name: 'TANGENT',\n        type: 'VEC4',\n        componentType: 5126 /* ComponentType.float32 */,\n        depends: ['NORMAL'],\n        fill: [1, 0, 0, 1],\n    },\n    {\n        name: 'NORMAL',\n        type: 'VEC3',\n        componentType: 5126 /* ComponentType.float32 */,\n        strip: true,\n        feature: _rendering_default_forward_pass_pipeline_feature_flags__WEBPACK_IMPORTED_MODULE_3__/* .PipelineFeatureFlags */ .Ot.VertexNormals,\n    },\n    {\n        name: 'COLOR_0',\n        type: 'VEC4',\n        componentType: 5126 /* ComponentType.float32 */,\n        strip: true,\n        feature: _rendering_default_forward_pass_pipeline_feature_flags__WEBPACK_IMPORTED_MODULE_3__/* .PipelineFeatureFlags */ .Ot.VertexColors,\n        fill: [1, 1, 1, 1],\n    },\n];\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (GltfModel);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } }, 1);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDckI7SUFDRDtRQUNJLElBQUksRUFBRSxRQUFRO1FBQ2QsSUFBSSxFQUFFLE1BQU07UUFDWixhQUFhLGtDQUF1QjtRQUNwQyxLQUFLLEVBQUUsSUFBSTtRQUNYLE9BQU8sRUFBRSxrSEFBb0IsQ0FBQyxhQUFhO0tBQzlDO0lBQ0Q7UUFDSSxJQUFJLEVBQUUsU0FBUztRQUNmLElBQUksRUFBRSxNQUFNO1FBQ1osYUFBYSxrQ0FBdUI7UUFDcEMsS0FBSyxFQUFFLElBQUk7UUFDWCxPQUFPLEVBQUUsa0hBQW9CLENBQUMsWUFBWTtRQUMxQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDckI7Q0FDSixDQUFDO2lFQXJDZSxTQUFTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2J1bnQtcG9ydGZvbGlvLy4vc3JjL3NhbXBsZXMvZ2x0Zi12aWV3ZXIvZ2x0Zi12aWV3ZXItc2FtcGxlLnRzP2MxOTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRnVsbFJlbmRlck1vZGVsIH0gZnJvbSAnLi4vc2V0dGluZ3Mvc2FtcGxlLXNwZWMnO1xuaW1wb3J0IHByb3BlcnR5TGlzdGVuZXIsIHsgTGlzdGVuZXJTeW1zIH0gZnJvbSAnLi4vc2V0dGluZ3MvcHJvcGVydHktbGlzdGVuZXInO1xuaW1wb3J0IGdldFNreWJveE9wdGlvbnMgZnJvbSAnLi4vc2V0dGluZ3Mvc2t5Ym94LW9wdGlvbnMnO1xuXG5pbXBvcnQgR2VvbWV0cnlQaXBlbGluZSBmcm9tICcuLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvZ2VvbWV0cnktcGlwZWxpbmUnO1xuaW1wb3J0IERlc2NyaXB0b3JNYXAgZnJvbSAnLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL2Rlc2NyaXB0b3ItbWFwJztcbmltcG9ydCBSZW5kZXJlciwgeyBGb3J3YXJkUGFzc1BhcmFtcyB9IGZyb20gJy4uLy4uL3JlbmRlcmluZy9yZW5kZXJlcic7XG5pbXBvcnQgeyBNYXRlcmlhbERlc2NyaXB0b3IgfSBmcm9tICcuLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvbWF0ZXJpYWwtZHJhdy1kYXRhJztcbmltcG9ydCB7IFBpcGVsaW5lRmVhdHVyZUZsYWdzIH0gZnJvbSAnLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL3BpcGVsaW5lLWZlYXR1cmUtZmxhZ3MnO1xuXG5pbXBvcnQgY3ViZW1hcEd1YXNzaWFuUHlyYW1pZCBmcm9tICcuLi9jdWJlbWFwLWJsdXIvY3ViZW1hcC1ndWFzc2lhbi1weXJhbWlkJztcblxuaW1wb3J0IHsgQXR0cmlidXRlRGV0YWlscywgQ29tcG9uZW50VHlwZSB9IGZyb20gJy4vbG9hZGVyL3R5cGUtY29udmVyc2lvbnMnO1xuaW1wb3J0IGltcG9ydEdsdGYgZnJvbSAnLi9sb2FkZXIvZ2x0Zi1sb2FkZXInO1xuaW1wb3J0IHsgRGF0YVR5cGUgfSBmcm9tICdAbG9hZGVycy5nbC9jb3JlJztcbmltcG9ydCB7IGlzT2JqZWN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvZ2VuZXJhbCc7XG5cbmNvbnN0IGdsdGZJbmRleCA9IGF3YWl0IGdldEdsdGZJbmRleCgpO1xuXG5hc3luYyBmdW5jdGlvbiBnZXRHbHRmSW5kZXgoKSB7XG4gICAgY29uc3QgaW5kZXhVcmwgPSBHTFRGX0JBU0VfVVJMX18gKyBHTFRGX0lOREVYX0ZJTEVfXztcbiAgICBjb25zdCBpbmRleFJlcyA9IGF3YWl0IGZldGNoKGluZGV4VXJsKTtcbiAgICBjb25zdCBpbmRleFN0ciA9IGF3YWl0IGluZGV4UmVzLnRleHQoKTtcbiAgICBjb25zdCBpbmRleEpzb24gPSBKU09OLnBhcnNlKGluZGV4U3RyKSBhcyB1bmtub3duO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGluZGV4SnNvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgbG9hZCBndGxmIG1vZGVsIGluZGV4Jyk7XG4gICAgfVxuXG4gICAgY29uc3QgZW50cmllczogW3N0cmluZywgc3RyaW5nXVtdID0gaW5kZXhKc29uLmZsYXRNYXAoKGdsdGY6IHVua25vd24pID0+IHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIWlzT2JqZWN0KGdsdGYpXG4gICAgICAgICAgICB8fCAhKCdsYWJlbCcgaW4gZ2x0ZilcbiAgICAgICAgICAgIHx8IHR5cGVvZiBnbHRmLmxhYmVsICE9PSAnc3RyaW5nJ1xuICAgICAgICAgICAgfHwgISgnbmFtZScgaW4gZ2x0ZilcbiAgICAgICAgICAgIHx8IHR5cGVvZiBnbHRmLm5hbWUgIT09ICdzdHJpbmcnXG4gICAgICAgICAgICB8fCAhKCd2YXJpYW50cycgaW4gZ2x0ZilcbiAgICAgICAgICAgIHx8ICFpc09iamVjdChnbHRmLnZhcmlhbnRzKVxuICAgICAgICAgICAgfHwgdHlwZW9mIGdsdGYudmFyaWFudHMuZ2xURiAhPT0gJ3N0cmluZydcbiAgICAgICAgKSByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3QgeyB2YXJpYW50czogeyBnbFRGOiBmaWxlIH0sIGxhYmVsLCBuYW1lIH0gPSBnbHRmO1xuICAgICAgICBjb25zdCBwYXRoID0gYCR7R0xURl9CQVNFX1VSTF9ffSR7bmFtZX0vZ2xURi8ke2ZpbGV9YDtcbiAgICAgICAgcmV0dXJuIFtbbGFiZWwsIHBhdGhdXTtcbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXMoZW50cmllcyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdsdGZNb2RlbCBpbXBsZW1lbnRzIEZ1bGxSZW5kZXJNb2RlbCB7XG4gICAgc3RhdGljIHJlYWRvbmx5IHRpdGxlID0gJ2dsVEYgTW9kZWwgVmlld2VyJztcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVzY3JpcHRpb24gPSAnJztcblxuICAgIHN0YXRpYyByZWFkb25seSBnb2FsTGF5b3V0OiBBdHRyaWJ1dGVEZXRhaWxzW10gPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdQT1NJVElPTicsXG4gICAgICAgICAgICB0eXBlOiAnVkVDMycsXG4gICAgICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdURVhDT09SRF8wJyxcbiAgICAgICAgICAgIHR5cGU6ICdWRUMyJyxcbiAgICAgICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ1RBTkdFTlQnLFxuICAgICAgICAgICAgdHlwZTogJ1ZFQzQnLFxuICAgICAgICAgICAgY29tcG9uZW50VHlwZTogQ29tcG9uZW50VHlwZS5mbG9hdDMyLFxuICAgICAgICAgICAgZGVwZW5kczogWydOT1JNQUwnXSxcbiAgICAgICAgICAgIGZpbGw6IFsxLCAwLCAwLCAxXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ05PUk1BTCcsXG4gICAgICAgICAgICB0eXBlOiAnVkVDMycsXG4gICAgICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4gICAgICAgICAgICBzdHJpcDogdHJ1ZSxcbiAgICAgICAgICAgIGZlYXR1cmU6IFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleE5vcm1hbHMsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdDT0xPUl8wJyxcbiAgICAgICAgICAgIHR5cGU6ICdWRUM0JyxcbiAgICAgICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbiAgICAgICAgICAgIHN0cmlwOiB0cnVlLFxuICAgICAgICAgICAgZmVhdHVyZTogUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Q29sb3JzLFxuICAgICAgICAgICAgZmlsbDogWzEsIDEsIDEsIDFdLFxuICAgICAgICB9LFxuICAgIF07XG5cbiAgICBnZW9tZXRyeVBpcGVsaW5lczogUGFydGlhbDxSZWNvcmQ8bnVtYmVyLCBHZW9tZXRyeVBpcGVsaW5lPj4gPSB7fTtcbiAgICBkZXNjcmlwdG9yTWFwOiBEZXNjcmlwdG9yTWFwO1xuICAgIGRldmljZTogR1BVRGV2aWNlO1xuXG4gICAgZ2V0IGRlcHRoVGV4dHVyZVZpZXcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0b3JNYXAuZ2J1ZmZlci5kZXB0aC52aWV3O1xuICAgIH1cblxuICAgIHJlYWRvbmx5ICNzZXR0aW5ncyA9IHByb3BlcnR5TGlzdGVuZXIoe1xuICAgICAgICBza3lib3g6IGdldFNreWJveE9wdGlvbnModGhpcyksXG4gICAgICAgIG1vZGVsOiB7XG4gICAgICAgICAgICBbTGlzdGVuZXJTeW1zLiR0eXBlXTogJ2ZpbGUnIGFzIGNvbnN0LFxuICAgICAgICAgICAgW0xpc3RlbmVyU3ltcy4kY2FsbGJhY2tdOiAodmFsOiB1bmtub3duLCBrZXk6IFByb3BlcnR5S2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGtleSAhPT0gJ3ZhbHVlJyB8fCB2YWwgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJyB8fCB2YWwgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zZXRNb2RlbCh2YWwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhY2NlcHQ6ICcuaGRyJyxcbiAgICAgICAgICAgIHNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgIHZhbHVlOiAnRW52aXJvbm1lbnQgVGVzdCcsXG4gICAgICAgICAgICAgICAgaW5pdGlhbFZhbHVlczogZ2x0ZkluZGV4LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHByb2Nlc3M6IChmaWxlOiBGaWxlKSA9PiBmaWxlLFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmVhZG9ubHkgc2V0dGluZ3MgPSB0aGlzLiNzZXR0aW5ncy5wdWJsaWNTZXR0aW5ncztcbiAgICByZWFkb25seSBwcmlvcml0eSA9IDEwMDA7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVuZGVyZXI6IFJlbmRlcmVyKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRvck1hcCA9IG5ldyBEZXNjcmlwdG9yTWFwKHJlbmRlcmVyLmRldmljZSwgcmVuZGVyZXIuZ2J1ZmZlciwgcmVuZGVyZXIuZ2xvYmFscyk7XG4gICAgICAgIHRoaXMuZGV2aWNlID0gcmVuZGVyZXIuZGV2aWNlO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZEZvcndhcmRQYXNzKHRoaXMpO1xuICAgIH1cblxuICAgIGFzeW5jIHNldFNreWJveChza3lib3g6IEdQVVRleHR1cmUpIHtcbiAgICAgICAgYXdhaXQgY3ViZW1hcEd1YXNzaWFuUHlyYW1pZCh7XG4gICAgICAgICAgICB0ZXh0dXJlOiBza3lib3gsXG4gICAgICAgICAgICBkZXZpY2U6IHRoaXMucmVuZGVyZXIuZGV2aWNlLFxuICAgICAgICAgICAgaW5QbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIGRlbGF5V29yazogcmVxdWVzdEFuaW1hdGlvbkZyYW1lLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNreWJveCA9IHNreWJveDtcbiAgICB9XG5cbiAgICBhc3luYyBzZXRNb2RlbChtb2RlbFBhdGg6IHN0cmluZyB8IERhdGFUeXBlKSB7XG4gICAgICAgIGNvbnN0IHNpemUgPSB7IHdpZHRoOiAxLCBoZWlnaHQ6IDEgfTtcbiAgICAgICAgY29uc3QgY29sb3JBcnJheSA9IG5ldyBGbG9hdDMyQXJyYXkoWzEsIDEsIDEsIDFdKTtcblxuICAgICAgICBjb25zdCBvcGFxdWVXaGl0ZSA9IHRoaXMucmVuZGVyZXIuZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xuICAgICAgICAgICAgc2l6ZSxcbiAgICAgICAgICAgIGZvcm1hdDogJ3JnYmEzMmZsb2F0JyxcbiAgICAgICAgICAgIHVzYWdlOiBHUFVUZXh0dXJlVXNhZ2UuVEVYVFVSRV9CSU5ESU5HIHwgR1BVVGV4dHVyZVVzYWdlLkNPUFlfRFNULFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5kZXZpY2UucXVldWUud3JpdGVUZXh0dXJlKHsgdGV4dHVyZTogb3BhcXVlV2hpdGUgfSwgY29sb3JBcnJheSwge30sIHNpemUpO1xuXG4gICAgICAgIGNvbnN0IG5vcm1hbE1hcCA9IHRoaXMucmVuZGVyZXIuZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xuICAgICAgICAgICAgc2l6ZSxcbiAgICAgICAgICAgIGZvcm1hdDogJ3JnYmEzMmZsb2F0JyxcbiAgICAgICAgICAgIHVzYWdlOiBHUFVUZXh0dXJlVXNhZ2UuVEVYVFVSRV9CSU5ESU5HIHwgR1BVVGV4dHVyZVVzYWdlLkNPUFlfRFNULFxuICAgICAgICB9KTtcbiAgICAgICAgY29sb3JBcnJheS5zZXQoWzAuNSwgMC41LCAxLCAxXSk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuZGV2aWNlLnF1ZXVlLndyaXRlVGV4dHVyZSh7IHRleHR1cmU6IG5vcm1hbE1hcCB9LCBjb2xvckFycmF5LCB7fSwgc2l6ZSk7XG5cbiAgICAgICAgY29uc3Qgc2FtcGxlciA9IHtcbiAgICAgICAgICAgIGFkZHJlc3NNb2RlVTogJ3JlcGVhdCcsXG4gICAgICAgICAgICBhZGRyZXNzTW9kZVY6ICdyZXBlYXQnLFxuICAgICAgICAgICAgbWFnRmlsdGVyOiAnbGluZWFyJyxcbiAgICAgICAgICAgIG1pbkZpbHRlcjogJ2xpbmVhcicsXG4gICAgICAgICAgICBtaXBtYXBGaWx0ZXI6ICdsaW5lYXInLFxuICAgICAgICB9IGFzIEdQVVNhbXBsZXJEZXNjcmlwdG9yO1xuXG4gICAgICAgIGNvbnN0IG1hdERhdGE6IE1hdGVyaWFsRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGJhc2VDb2xvclRleHR1cmU6IG9wYXF1ZVdoaXRlLFxuICAgICAgICAgICAgYmFzZUNvbG9yRmFjdG9yOiBbMSwgMSwgMSwgMV0sXG4gICAgICAgICAgICBub3JtYWxUZXh0dXJlOiBub3JtYWxNYXAsXG4gICAgICAgICAgICBtZXRhbGxpY1JvdWdobmVzc1RleHR1cmU6IG9wYXF1ZVdoaXRlLFxuICAgICAgICAgICAgbWV0YWxsaWNGYWN0b3I6IDEsXG4gICAgICAgICAgICByb3VnaG5lc3NGYWN0b3I6IDEsXG4gICAgICAgICAgICBiYXNlQ29sb3JTYW1wbGVyOiBzYW1wbGVyLFxuICAgICAgICAgICAgbm9ybWFsU2FtcGxlcjogc2FtcGxlcixcbiAgICAgICAgICAgIG1ldGFsbGljUm91Z2huZXNzU2FtcGxlcjogc2FtcGxlcixcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmdlb21ldHJ5UGlwZWxpbmVzID0gYXdhaXQgaW1wb3J0R2x0ZihcbiAgICAgICAgICAgIG1vZGVsUGF0aCxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuZGV2aWNlLFxuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdG9yTWFwLFxuICAgICAgICAgICAgbWF0RGF0YSxcbiAgICAgICAgICAgIEdsdGZNb2RlbC5nb2FsTGF5b3V0LFxuICAgICAgICAgICAge30sXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKHsgZW5jb2RlciwgZ2J1ZmZlciwgZ2xvYmFscyB9OiBGb3J3YXJkUGFzc1BhcmFtcykge1xuICAgICAgICBjb25zdCBwYXNzID0gZW5jb2Rlci5iZWdpblJlbmRlclBhc3MoZ2J1ZmZlci5wYXNzRGVzY3JpcHRvcik7XG4gICAgICAgIHBhc3Muc2V0QmluZEdyb3VwKDAsIGdsb2JhbHMuYmluZGdyb3VwKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHBpcGVsaW5lIG9mIE9iamVjdC52YWx1ZXModGhpcy5nZW9tZXRyeVBpcGVsaW5lcykpIHtcbiAgICAgICAgICAgIHBpcGVsaW5lPy5kcmF3KHBhc3MsIHRoaXMucmVuZGVyZXIuZGV2aWNlLnF1ZXVlKTtcbiAgICAgICAgfVxuICAgICAgICBwYXNzLmVuZCgpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4164\n")},459:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  A: () => (/* binding */ importGltf)\n});\n\n// EXTERNAL MODULE: ./node_modules/.pnpm/wgpu-matrix@3.0.2/node_modules/wgpu-matrix/dist/3.x/wgpu-matrix.module.js\nvar wgpu_matrix_module = __webpack_require__(4523);\n// EXTERNAL MODULE: ./node_modules/.pnpm/@loaders.gl+core@4.2.2/node_modules/@loaders.gl/core/dist/lib/api/load.js + 50 modules\nvar load = __webpack_require__(4245);\n// EXTERNAL MODULE: ./node_modules/.pnpm/@loaders.gl+gltf@4.2.2_@loaders.gl+core@4.2.2/node_modules/@loaders.gl/gltf/dist/gltf-loader.js + 71 modules\nvar gltf_loader = __webpack_require__(6732);\n// EXTERNAL MODULE: ./node_modules/.pnpm/@loaders.gl+gltf@4.2.2_@loaders.gl+core@4.2.2/node_modules/@loaders.gl/gltf/dist/lib/api/post-process-gltf.js\nvar post_process_gltf = __webpack_require__(3700);\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/weld.ts\n/**\n * Adapted from gltf-transform's version:\n * github.com/donmccurdy/glTF-Transform/blob/main/packages/functions/src/weld.ts\n */\nclass HashTable {\n    constructor(prim) {\n        this.attributes = [];\n        let byteStride = 0;\n        for (const attribute of Object.values(prim)) {\n            byteStride += this.initAttribute(attribute);\n        }\n        const paddedByteStride = (byteStride + 3) & ~3;\n        this.u8 = new Uint8Array(paddedByteStride);\n        this.u32 = new Uint32Array(this.u8.buffer);\n    }\n    initAttribute(attribute) {\n        const u8 = attribute.data instanceof Uint8Array\n            ? attribute.data\n            : new Uint8Array(attribute.data.buffer);\n        const byteStride = attribute.bytesPerComponent * attribute.componentsPerElement;\n        this.attributes.push({ u8, byteStride });\n        return byteStride;\n    }\n    hash(index) {\n        let byteOffset = 0;\n        for (const { u8, byteStride } of this.attributes) {\n            for (let i = 0; i < byteStride; i += 1) {\n                this.u8[byteOffset + i] = u8[index * byteStride + i];\n            }\n            byteOffset += byteStride;\n        }\n        return this.murmurHash2();\n    }\n    equal(a, b) {\n        for (const { u8, byteStride } of this.attributes) {\n            for (let j = 0; j < byteStride; j += 1) {\n                if (u8[a * byteStride + j] !== u8[b * byteStride + j]) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    hashLookup(table, buckets, key, empty) {\n        const hashmod = buckets - 1;\n        const hashval = this.hash(key);\n        let bucket = hashval & hashmod;\n        for (let probe = 0; probe <= hashmod; probe += 1) {\n            const item = table[bucket];\n            if (item === empty || this.equal(item, key)) {\n                return bucket;\n            }\n            bucket = (bucket + probe + 1) & hashmod; // Hash collision.\n        }\n        throw new Error('Hash table full.');\n    }\n    /**\n     * References:\n     * - https://github.com/mikolalysenko/murmurhash-js/blob/f19136e9f9c17f8cddc216ca3d44ec7c5c502f60/murmurhash2_gc.js#L14\n     * - https://github.com/zeux/meshoptimizer/blob/e47e1be6d3d9513153188216455bdbed40a206ef/src/indexgenerator.cpp#L12\n     */\n    murmurHash2() {\n        const m = 0x5bd1e995;\n        const r = 24;\n        let h = 0;\n        for (let k of this.u32) {\n            k = Math.imul(k, m) >>> 0;\n            k = (k ^ (k >> r)) >>> 0;\n            k = Math.imul(k, m) >>> 0;\n            h = Math.imul(h, m) >>> 0;\n            h = (h ^ k) >>> 0;\n        }\n        return h;\n    }\n}\nfunction ceilPowerOfTwo(value) {\n    return 2 ** Math.ceil(Math.log(value) / Math.LN2);\n}\n/**\n * Weld and merge, combining vertices that are bitwise-equal.\n *\n * Adapted from gltf-transform's _weldPrimitiveStrict:\n * github.com/donmccurdy/glTF-Transform/blob/main/packages/functions/src/weld.ts#L193\n */\nfunction weld(prim) {\n    const srcVertexCount = prim.POSITION.count;\n    const hash = new HashTable(prim);\n    const tableSize = ceilPowerOfTwo(srcVertexCount + (srcVertexCount / 4));\n    const is16Bit = srcVertexCount < (2 ** 16 - 1);\n    const empty = 2 ** (is16Bit ? 16 : 32) - 1;\n    const indexFormat = is16Bit ? 'uint16' : 'uint32';\n    const writeMap = is16Bit ? new Uint16Array(srcVertexCount) : new Uint32Array(srcVertexCount);\n    const table = is16Bit ? new Uint16Array(tableSize) : new Uint32Array(tableSize);\n    table.fill(empty);\n    let dstVertexCount = 0;\n    for (let i = 0; i < srcVertexCount; i += 1) {\n        const hashIndex = hash.hashLookup(table, tableSize, i, empty);\n        const dstIndex = table[hashIndex];\n        if (dstIndex === empty) {\n            table[hashIndex] = i;\n            writeMap[i] = dstVertexCount;\n            dstVertexCount += 1;\n        }\n        else {\n            writeMap[i] = writeMap[dstIndex];\n        }\n    }\n    for (const attribute of Object.values(prim)) {\n        attribute.remap(writeMap, dstVertexCount);\n    }\n    // The gltf-transform version checks for degenerate triangles to remove.\n    // This is omitted here.\n    return { indexArray: writeMap, indexFormat, vertexCount: dstVertexCount };\n}\n\n// EXTERNAL MODULE: ./src/rendering/default-forward-pass/pipeline-feature-flags.ts\nvar pipeline_feature_flags = __webpack_require__(8452);\n// EXTERNAL MODULE: ./src/rendering/constants.ts\nvar constants = __webpack_require__(4176);\n// EXTERNAL MODULE: ./src/utils/data-copy.ts\nvar data_copy = __webpack_require__(6182);\n;// CONCATENATED MODULE: ./src/rendering/default-forward-pass/primitive-draw-data.ts\n\n\n\n\nclass PrimitiveDrawData {\n    constructor(primitive, device, max, descriptorMap, instances) {\n        this.instanceCount = 0;\n        this.dirty = false;\n        this.max = max;\n        this.features = primitive.features;\n        this.name = primitive.name ?? 'mesh';\n        this.vertexCount = primitive.vertexCount;\n        if (primitive.vertexArray instanceof GPUBuffer) {\n            this.vertexBuffer = primitive.vertexArray;\n        }\n        else {\n            this.vertexBuffer = (0,data_copy/* createAndCopyBuffer */.Lr)(primitive.vertexArray, GPUBufferUsage.VERTEX, device, `${this.name} vertex buffer`);\n        }\n        if (primitive.indexArray && primitive.indexFormat) {\n            const { indexArray, indexFormat } = primitive;\n            this.indexData = {\n                indexFormat,\n                indexCount: indexArray.byteLength / (indexFormat === 'uint16' ? 2 : 4),\n                indexBuffer: (0,data_copy/* createAndCopyBuffer */.Lr)(primitive.indexArray, GPUBufferUsage.INDEX, device, `${this.name} index buffer`),\n            };\n        }\n        this.instanceSize = constants/* TypeSizes */.vV.sizeofMat4x4f;\n        if (this.features & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals) {\n            this.instanceSize += 12 * 4;\n        }\n        this.instances = new ArrayBuffer(max * this.instanceSize);\n        this.modelMatrices = new Array(max);\n        for (let i = 0; i < max; i += 1) {\n            const offset = i * this.instanceSize;\n            this.modelMatrices[i] = new Float32Array(this.instances, offset, 16);\n        }\n        if (this.features & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals) {\n            this.normalMatrices = new Array(max);\n            for (let i = 0; i < max; i += 1) {\n                const offset = (i * this.instanceSize) + constants/* TypeSizes */.vV.sizeofMat4x4f;\n                this.normalMatrices[i] = new Float32Array(this.instances, offset, 12);\n            }\n        }\n        this.instanceBuffer = device.createBuffer({\n            label: `${this.name} instance buffer`,\n            size: this.instances.byteLength,\n            usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM,\n        });\n        this.instanceBindGroup = device.createBindGroup({\n            label: `PrimitiveDrawData instance bind group`,\n            layout: descriptorMap.forwardBindgroupLayout,\n            entries: [{\n                    binding: 0,\n                    resource: { buffer: this.instanceBuffer },\n                }],\n        });\n        if (instances) {\n            for (const instance of instances) {\n                this.addInstance(instance);\n            }\n        }\n    }\n    draw(passEncoder, queue) {\n        if (this.dirty) {\n            queue.writeBuffer(this.instanceBuffer, 0, this.instances);\n            this.dirty = false;\n        }\n        passEncoder.setVertexBuffer(0, this.vertexBuffer);\n        passEncoder.setBindGroup(2, this.instanceBindGroup);\n        if (this.indexData != null) {\n            const { indexBuffer, indexCount, indexFormat } = this.indexData;\n            passEncoder.setIndexBuffer(indexBuffer, indexFormat);\n            passEncoder.drawIndexed(indexCount, this.instanceCount);\n        }\n        else {\n            passEncoder.draw(this.vertexCount, this.instanceCount);\n        }\n    }\n    addInstance(transform) {\n        if (this.instanceCount === this.max)\n            return;\n        wgpu_matrix_module/* mat4 */.pB.copy(transform, this.modelMatrices[this.instanceCount]);\n        this.calculateNormalMatrix(this.instanceCount);\n        this.instanceCount += 1;\n        this.dirty = true;\n    }\n    calculateNormalMatrix(idx) {\n        if (!(this.features & pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals))\n            return;\n        const normalMatrix = this.normalMatrices[idx];\n        wgpu_matrix_module/* mat3 */.w0.fromMat4(this.modelMatrices[idx], normalMatrix);\n        wgpu_matrix_module/* mat3 */.w0.invert(normalMatrix, normalMatrix);\n        wgpu_matrix_module/* mat3 */.w0.transpose(normalMatrix, normalMatrix);\n    }\n}\n\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/type-conversions.ts\n\nconst typeToElementCount = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 12,\n    MAT4: 16,\n};\nconst componentToSize = {\n    [5120 /* ComponentType.int8 */]: 1,\n    [5121 /* ComponentType.uint8 */]: 1,\n    [5122 /* ComponentType.int16 */]: 2,\n    [5123 /* ComponentType.uint16 */]: 2,\n    [5125 /* ComponentType.uint32 */]: 4,\n    [5126 /* ComponentType.float32 */]: 4,\n};\nconst modeToTopology = {\n    [0 /* TopologyMode.Points */]: pipeline_feature_flags/* PipelineFeatureFlags */.Ot.PointList, // POINTS\n    [1 /* TopologyMode.LineList */]: pipeline_feature_flags/* PipelineFeatureFlags */.Ot.LineList, // LINES\n    // 2: LINE_LOOP (unsupported by webgpu)\n    // 3: PipelineFeatureFlags.LineStrip, // LINE_STRIP\n    [4 /* TopologyMode.TriangleList */]: pipeline_feature_flags/* PipelineFeatureFlags */.Ot.TriangleList, // TRIANGLES\n    // 5: PipelineFeatureFlags.TriangleStrip, // TRIANGLE_STRIP\n    // 6: TRIANGLE_FAN (unsupported by webgpu)\n};\n\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/attribute-wrapper.ts\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nclass AttributeWrapper {\n    constructor(accessor, componentCount) {\n        this.unwelded = false;\n        if (accessor instanceof Float32Array) {\n            this.data = accessor;\n            this.componentsPerElement = componentCount;\n            this.count = accessor.length / componentCount;\n            this.processed = true;\n            this.bytesPerComponent = 4;\n            this.copyFrom = this.copyProcessed.bind(this);\n        }\n        else {\n            this.data = accessor.value;\n            this.componentsPerElement = accessor.components;\n            this.count = accessor.count;\n            this.bytesPerComponent = accessor.bytesPerComponent;\n            this.processed = false;\n            this.view = new DataView(this.data.buffer);\n            this.copyFrom = this.copyUnprocessed.bind(this);\n            switch (accessor.componentType) {\n                case 5120 /* ComponentType.int8 */: {\n                    this.at = (i, j) => this.view.getInt8(i * this.componentsPerElement + j);\n                    break;\n                }\n                case 5121 /* ComponentType.uint8 */: {\n                    this.at = (i, j) => this.view.getUint8(i * this.componentsPerElement + j);\n                    break;\n                }\n                case 5122 /* ComponentType.int16 */: {\n                    this.at = (i, j) => {\n                        const offset = 2 * (i * this.componentsPerElement + j);\n                        return this.view.getInt16(offset, true);\n                    };\n                    break;\n                }\n                case 5123 /* ComponentType.uint16 */: {\n                    this.at = (i, j) => {\n                        const offset = 2 * (i * this.componentsPerElement + j);\n                        return this.view.getUint16(offset, true);\n                    };\n                    break;\n                }\n                case 5125 /* ComponentType.uint32 */: {\n                    this.at = (i, j) => {\n                        const offset = 4 * (i * this.componentsPerElement + j);\n                        return this.view.getUint32(offset, true);\n                    };\n                    break;\n                }\n                case 5126 /* ComponentType.float32 */: {\n                    this.at = (i, j) => {\n                        const offset = 4 * (i * this.componentsPerElement + j);\n                        return this.view.getFloat32(offset, true);\n                    };\n                    break;\n                }\n                default: throw new Error(`gltf importer -- invalid componentType ${accessor.componentType}`);\n            }\n            if (accessor.normalized) {\n                let val;\n                switch (accessor.componentType) {\n                    case 5121 /* ComponentType.uint8 */:\n                        val = 255;\n                        break;\n                    case 5120 /* ComponentType.int8 */:\n                        val = 127;\n                        break;\n                    case 5123 /* ComponentType.uint16 */:\n                        val = 65535;\n                        break;\n                    case 5122 /* ComponentType.int16 */:\n                        val = 32767;\n                        break;\n                    case 5125 /* ComponentType.uint32 */:\n                        val = 4294967295;\n                        break;\n                    default: throw new Error(`gltf importer -- invalid componentType ${accessor.componentType}`);\n                }\n                this.at = (i, j) => this.at(i, j) / val;\n            }\n        }\n    }\n    get array() {\n        if (!this.processed)\n            this.process();\n        return this.data;\n    }\n    copyProcessed(srcIdx, dstIdx, dst) {\n        for (let j = 0; j < this.componentsPerElement; j += 1) {\n            dst[dstIdx + j] = this.data[(srcIdx * this.componentsPerElement) + j];\n        }\n    }\n    copyUnprocessed(srcIdx, dstIdx, dst) {\n        for (let j = 0; j < this.componentsPerElement; j += 1) {\n            dst[dstIdx + j] = this.at(srcIdx, j);\n        }\n    }\n    markProcessed() {\n        this.processed = true;\n        this.copyFrom = this.copyProcessed.bind(this);\n        delete this.view;\n        delete this.at;\n    }\n    process() {\n        if (this.processed)\n            return;\n        const newView = new Float32Array(this.count * this.componentsPerElement);\n        for (let i = 0; i < this.count; i += 1) {\n            this.copyFrom(i, i * this.componentsPerElement, newView);\n        }\n        this.data = newView;\n        this.markProcessed();\n    }\n    unweld(indexArray) {\n        if (this.unwelded)\n            return;\n        this.unwelded = true;\n        const newView = new Float32Array(indexArray.length * this.componentsPerElement);\n        for (let i = 0; i < indexArray.length; i += 1) {\n            this.copyFrom(indexArray[i], i * this.componentsPerElement, newView);\n        }\n        this.count = indexArray.length;\n        this.data = newView;\n        this.markProcessed();\n    }\n    remap(remap, dstCount) {\n        const dstArray = new Float32Array(dstCount * this.componentsPerElement);\n        const done = new Uint8Array(dstCount);\n        for (let srcIndex = 0; srcIndex < this.count; srcIndex += 1) {\n            const dstIndex = remap[srcIndex];\n            if (done[dstIndex])\n                continue;\n            this.copyFrom(srcIndex, dstIndex * this.componentsPerElement, dstArray);\n            done[dstIndex] = 1;\n        }\n        this.data = dstArray;\n        this.markProcessed();\n    }\n}\n\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/interleave-vertices.ts\n\n\n// const goalLayout: AttributeDetails[] = [\n//     {\n//         name: 'POSITION',\n//         type: 'VEC3',\n//         componentType: ComponentType.float32,\n//     },\n//     {\n//         name: 'TEXCOORD_0',\n//         type: 'VEC2',\n//         componentType: ComponentType.float32,\n//     },\n//     {\n//         name: 'TANGENT',\n//         type: 'VEC4',\n//         componentType: ComponentType.float32,\n//         depends: ['NORMAL'],\n//         fill: [1, 0, 0, 1],\n//     },\n//     {\n//         name: 'NORMAL',\n//         type: 'VEC3',\n//         componentType: ComponentType.float32,\n//         strip: true,\n//         feature: PipelineFeatureFlags.VertexNormals,\n//     },\n//     {\n//         name: 'COLOR_0',\n//         type: 'VEC4',\n//         componentType: ComponentType.float32,\n//         strip: true,\n//         feature: PipelineFeatureFlags.VertexColors,\n//         fill: [1, 1, 1, 1],\n//     },\n// ];\nfunction interleaveVertices(attributes, count) {\n    let vertexFeatures = pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Defaults;\n    let stride = 5;\n    if (attributes.NORMAL != null)\n        stride += 7;\n    if (attributes.COLOR_0 != null)\n        stride += 4;\n    const vertexArray = new ArrayBuffer(stride * count * 4);\n    const vertexView = new Float32Array(vertexArray);\n    for (let i = 0; i < count; i += 1) {\n        attributes.POSITION?.copyFrom(i, stride * i, vertexView);\n    }\n    const uv = attributes.TEXCOORD_0 ?? new AttributeWrapper(new Float32Array(count * 2), 2);\n    for (let i = 0; i < count; i += 1) {\n        uv.copyFrom(i, i * stride + 3, vertexView);\n    }\n    if (attributes.NORMAL != null && attributes.TANGENT != null) {\n        vertexFeatures |= pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals;\n        for (let i = 0; i < count; i += 1) {\n            attributes.TANGENT.copyFrom(i, i * stride + 5, vertexView);\n        }\n        for (let i = 0; i < count; i += 1) {\n            attributes.NORMAL.copyFrom(i, i * stride + 9, vertexView);\n        }\n    }\n    if (attributes.COLOR_0 != null) {\n        vertexFeatures |= pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors;\n        const step = attributes.NORMAL != null ? 12 : 5;\n        for (let i = 0; i < count; i += 1) {\n            attributes.COLOR_0.copyFrom(i, i * stride + step, vertexView);\n            vertexView[i * stride + step + 3] = 1;\n        }\n    }\n    return { vertexArray, vertexFeatures };\n}\n\n// EXTERNAL MODULE: ./src/utils/general.ts\nvar general = __webpack_require__(80);\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/primitive-loader.ts\n\n\n\n\n\n\n\n\nconst generateTangentsAsync = __webpack_require__.e(/* import() */ 451).then(__webpack_require__.bind(__webpack_require__, 1451)).then((module) => module.generateTangents);\nfunction wrapIndices(indices) {\n    switch (indices.bytesPerComponent) {\n        case 2: return {\n            indexArray: new Uint16Array(indices.value.buffer),\n            indexFormat: 'uint16',\n        };\n        case 4: return {\n            indexArray: new Uint32Array(indices.value.buffer),\n            indexFormat: 'uint32',\n        };\n        case 1:\n        default: return {\n            indexArray: new Uint16Array(indices.value),\n            indexFormat: 'uint16',\n        };\n    }\n}\nfunction reindex(indices, originalMode) {\n    switch (originalMode) {\n        case 2 /* TopologyMode.LineLoop */:\n        case 3 /* TopologyMode.LineStrip */:\n        case 6 /* TopologyMode.TriangleFan */:\n        case 5 /* TopologyMode.TriangleStrip */: {\n            // TODO: convert non-list topologies into lists.\n            throw new Error('Topology currently unsupported');\n        }\n        default: return { ...wrapIndices(indices), mode: 4 /* TopologyMode.TriangleList */ };\n    }\n}\n/**\n * Checks the determinant of each given matrix and returns a culling mode such that\n * a primitive will render correctly for all nodes containing it, using 'none'\n * for primitive which are rendered both inverted and normally.\n *\n * @param instanceMatrices the instance matrices to render the primitive with\n * @returns The cull mode to use on the primitive.\n *\n * @remarks\n * The glFT spec determines the winding direction of a model by the\n * determinant of the transform of the node which uses it, allowing\n * inversion through negative scale. Changing cullMode instead\n * more easily integrates with instanced rendering, although comes\n * at a performance cost.\n */\nfunction getCullMode(instanceMatrices) {\n    let overallSign;\n    for (let i = 0; i < instanceMatrices.length; i += 1) {\n        const det = wgpu_matrix_module/* mat4 */.pB.determinant(instanceMatrices[i]);\n        const sign = Math.sign(det);\n        overallSign ??= sign;\n        if (sign !== overallSign)\n            return pipeline_feature_flags/* PipelineFeatureFlags */.Ot.DoubleSided;\n    }\n    return (overallSign == null || overallSign > 0)\n        ? pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Defaults\n        : pipeline_feature_flags/* PipelineFeatureFlags */.Ot.ClockwiseWinding;\n}\nasync function loadPrimitive(layout, primitive, instances, descriptorMap, device) {\n    const attributes = primitive.attributes;\n    if (attributes.POSITION == null)\n        return {};\n    const { indices } = primitive;\n    const atrs = (0,general/* mapValues */.LG)(attributes, (atr) => new AttributeWrapper(atr));\n    let { mode } = primitive;\n    let vertexCount = attributes.POSITION.count;\n    let indexArray;\n    let indexFormat;\n    if (indices != null) {\n        ({ indexArray, indexFormat } = wrapIndices(indices));\n        if (mode !== 0 /* TopologyMode.Points */\n            && mode !== 1 /* TopologyMode.LineList */\n            && mode !== 4 /* TopologyMode.TriangleList */) {\n            ({ indexArray, indexFormat, mode } = reindex(indices, mode));\n        }\n    }\n    if (atrs.NORMAL != null && atrs.TANGENT == null) {\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (atrs.TEXCOORD_0 != null) {\n            if (indexArray != null) {\n                vertexCount = indexArray.length;\n                for (const atr of Object.values(atrs)) {\n                    atr.unweld(indexArray);\n                }\n            }\n            const start = Date.now();\n            const tangent = await generateTangentsAsync.then((func) => func(\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            atrs.POSITION.array, \n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            atrs.NORMAL.array, atrs.TEXCOORD_0.array));\n            for (let i = 3; i < tangent.length; i += 4) {\n                tangent[i] *= -1;\n            }\n            console.log(`tangents generated in ${Date.now() - start}`);\n            atrs.TANGENT = new AttributeWrapper(tangent, 4);\n            ({ indexArray, indexFormat, vertexCount } = weld(atrs));\n            mode = 4 /* TopologyMode.TriangleList */;\n        }\n        else {\n            const tangent = new Float32Array(vertexCount * 4);\n            for (let i = 0; i < vertexCount; i += 1) {\n                tangent.set([1, 0, 0, 1], i * 4);\n            }\n            atrs.TANGENT = new AttributeWrapper(tangent, 4);\n        }\n    }\n    const { vertexArray, vertexFeatures } = interleaveVertices(atrs, vertexCount);\n    let features = getCullMode(instances) | vertexFeatures;\n    if (mode != null)\n        features |= modeToTopology[mode] || 0;\n    const drawData = new PrimitiveDrawData({\n        features,\n        indexArray,\n        indexFormat,\n        vertexCount,\n        vertexArray,\n    }, device, instances.length, descriptorMap, instances);\n    return { material: primitive.material, drawData };\n}\n\n// EXTERNAL MODULE: ./src/utils/texture-importing.ts\nvar texture_importing = __webpack_require__(2253);\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/material-loader.ts\n\n\nconst DEFAULT_METALLIC = 0.0;\nconst DEFAULT_ROUGHNESS = 1.0;\nconst gltfToMagDescription = {\n    9728: 'nearest',\n    9729: 'linear',\n    9984: 'nearest', // NEAREST_MIPMAP_NEAREST\n    9985: 'linear', // LINEAR_MIPMAP_NEAREST\n    9986: 'nearest', // NEAREST_MIPMAP_LINEAR\n    9987: 'linear', // LINEAR_MIPMAP_LINEAR\n};\nconst gltfToMipDescription = {\n    9984: 'nearest', // NEAREST_MIPMAP_NEAREST\n    9985: 'nearest', // LINEAR_MIPMAP_NEAREST\n    9986: 'linear', // NEAREST_MIPMAP_LINEAR\n    9987: 'linear', // LINEAR_MIPMAP_LINEAR\n};\nconst gltfToAddressMode = {\n    33071: 'clamp-to-edge', // CLAMP_TO_EDGE\n    33648: 'mirror-repeat', // MIRRORED_REPEAT\n    10497: 'repeat', // REPEAT\n};\nfunction toSamplerDescription(sampler) {\n    const { magFilter, minFilter, wrapS, wrapT } = sampler;\n    return {\n        addressModeU: gltfToAddressMode[wrapS ?? 10497],\n        addressModeV: gltfToAddressMode[wrapT ?? 10497],\n        minFilter: gltfToMagDescription[minFilter ?? 9987],\n        magFilter: gltfToMagDescription[magFilter ?? 9729],\n        mipmapFilter: gltfToMipDescription[minFilter ?? 9987] ?? 'linear',\n    };\n}\nfunction getImageData(handle) {\n    const { source, sampler } = handle;\n    if (source == null)\n        return {};\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    const data = source.image.data ?? source.bufferView?.data;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (data == null)\n        return {};\n    return { data, mimeType: source.mimeType, sampler };\n}\nasync function loadMaterial(material, defaultMaterial, device) {\n    const mat = {};\n    if (material.pbrMetallicRoughness != null) {\n        const { baseColorFactor, baseColorTexture, metallicFactor, metallicRoughnessTexture, roughnessFactor, } = material.pbrMetallicRoughness;\n        if (metallicRoughnessTexture?.texture.source == null) {\n            if (metallicFactor == null)\n                mat.metallicFactor = DEFAULT_METALLIC;\n            if (roughnessFactor == null)\n                mat.roughnessFactor = DEFAULT_ROUGHNESS;\n        }\n        else {\n            const { data, mimeType, sampler } = getImageData(metallicRoughnessTexture.texture);\n            if (data != null) {\n                mat.metallicRoughnessTexture = await (0,texture_importing/* imageToTexture */.u)({\n                    label: `${material.id} mr texture`,\n                    data,\n                    mimeType,\n                    usage: GPUTextureUsage.TEXTURE_BINDING,\n                    device,\n                });\n                if (sampler)\n                    mat.metallicRoughnessSampler = toSamplerDescription(sampler);\n            }\n        }\n        if (baseColorTexture?.texture.source != null) {\n            const { data, mimeType, sampler } = getImageData(baseColorTexture.texture);\n            if (data != null) {\n                mat.baseColorTexture = await (0,texture_importing/* imageToTexture */.u)({\n                    label: `${material.id} mr texture`,\n                    data,\n                    mimeType,\n                    usage: GPUTextureUsage.TEXTURE_BINDING,\n                    device,\n                    srgbToLinear: true,\n                });\n                if (sampler)\n                    mat.baseColorSampler = toSamplerDescription(sampler);\n            }\n        }\n        if (baseColorFactor != null)\n            mat.baseColorFactor = baseColorFactor;\n        if (metallicFactor != null)\n            mat.metallicFactor = metallicFactor;\n        if (roughnessFactor != null)\n            mat.metallicFactor = roughnessFactor;\n    }\n    else {\n        mat.metallicFactor = DEFAULT_METALLIC;\n        mat.roughnessFactor = DEFAULT_ROUGHNESS;\n    }\n    if (material.normalTexture?.texture.source != null) {\n        const { data, mimeType, sampler } = getImageData(material.normalTexture.texture);\n        if (data != null) {\n            mat.normalTexture = await (0,texture_importing/* imageToTexture */.u)({\n                label: `${material.id} mr texture`,\n                data,\n                mimeType,\n                usage: GPUTextureUsage.TEXTURE_BINDING,\n                device,\n            });\n            if (sampler)\n                mat.normalSampler = toSamplerDescription(sampler);\n        }\n    }\n    const { emissiveFactor, emissiveTexture } = material;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n    const emissiveStrength = material.extensions?.KHR_materials_emissive_strength?.emissiveStrength;\n    if (emissiveTexture != null || emissiveFactor?.some((x) => x > 0)) {\n        mat.emissiveFactor = emissiveFactor ?? [1, 1, 1];\n        mat.emissiveSampler = { magFilter: 'linear', minFilter: 'linear' };\n        if (emissiveTexture?.texture.source != null) {\n            const { data, mimeType, sampler } = getImageData(emissiveTexture.texture);\n            if (data != null) {\n                mat.emissiveTexture = await (0,texture_importing/* imageToTexture */.u)({\n                    label: `${material.id} mr texture`,\n                    data,\n                    mimeType,\n                    usage: GPUTextureUsage.TEXTURE_BINDING,\n                    device,\n                    srgbToLinear: true,\n                });\n                if (sampler)\n                    mat.emissiveSampler = toSamplerDescription(sampler);\n            }\n        }\n        else {\n            mat.emissiveTexture = defaultMaterial.baseColorTexture;\n        }\n        if (emissiveStrength != null && typeof emissiveStrength === 'number') {\n            wgpu_matrix_module/* vec3 */.eR.scale(mat.emissiveFactor, emissiveStrength, mat.emissiveFactor);\n        }\n    }\n    if (material.doubleSided)\n        mat.doubleSided = true;\n    if (material.alphaMode === 'MASK')\n        mat.alphaCutoff = material.alphaCutoff ?? 0.5;\n    return { ...defaultMaterial, ...mat };\n}\n\n;// CONCATENATED MODULE: ./src/rendering/default-forward-pass/material-draw-data.ts\n\n\nclass MaterialDrawData {\n    constructor(data, device, descriptorMap, primitiveFeatures, primitives) {\n        this.primitives = [];\n        this.features = primitiveFeatures;\n        if (data.doubleSided)\n            this.features |= pipeline_feature_flags/* PipelineFeatureFlags */.Ot.DoubleSided;\n        // TODO : don't hardcode the properties features\n        const properties = new Float32Array(12);\n        properties.set(data.baseColorFactor);\n        properties[4] = data.metallicFactor;\n        properties[5] = data.roughnessFactor;\n        if (data.alphaCutoff != null) {\n            this.features |= pipeline_feature_flags/* PipelineFeatureFlags */.Ot.AlphaCutoff;\n            properties[6] = data.alphaCutoff;\n        }\n        if (data.emissiveFactor != null) {\n            properties.set(data.emissiveFactor, 8);\n        }\n        this.propertiesBuffer = (0,data_copy/* createAndCopyBuffer */.Lr)(properties, GPUBufferUsage.UNIFORM, device);\n        const entries = [\n            { binding: 0, resource: { buffer: this.propertiesBuffer } },\n            { binding: 1, resource: descriptorMap.getSampler(data.baseColorSampler) },\n            { binding: 2, resource: data.baseColorTexture.createView({ dimension: '2d' }) },\n            { binding: 3, resource: descriptorMap.getSampler(data.normalSampler) },\n            { binding: 4, resource: data.normalTexture.createView({ dimension: '2d' }) },\n            { binding: 5, resource: descriptorMap.getSampler(data.metallicRoughnessSampler) },\n            { binding: 6, resource: data.metallicRoughnessTexture.createView({ dimension: '2d' }) },\n        ];\n        if (data.emissiveTexture != null) {\n            this.features |= pipeline_feature_flags/* PipelineFeatureFlags */.Ot.Emissive;\n            entries.push({\n                binding: 7,\n                resource: descriptorMap.getSampler(data.emissiveSampler ?? {}),\n            });\n            entries.push({\n                binding: 8,\n                resource: data.emissiveTexture.createView({ dimension: '2d' }),\n            });\n        }\n        this.layout = descriptorMap.getMaterialBindGroup(this.features);\n        this.matData = data;\n        this.bindGroup = device.createBindGroup({\n            label: (0,pipeline_feature_flags/* featureFlagsToString */.UZ)(this.features),\n            layout: this.layout,\n            entries,\n        });\n        if (primitives != null) {\n            this.addPrimitives(...primitives);\n        }\n    }\n    draw(passEncoder, queue) {\n        if (this.primitives.length === 0)\n            return;\n        passEncoder.setBindGroup(1, this.bindGroup);\n        for (const primitive of this.primitives) {\n            primitive.draw(passEncoder, queue);\n        }\n    }\n    addPrimitives(...drawData) {\n        const filtered = drawData.filter((data) => {\n            if ((data.features & this.features) === data.features)\n                return true;\n            console.warn(`invalid primitive added to material: \nprimitive: ${data.name}\nprimitive features: ${(0,pipeline_feature_flags/* featureFlagsToString */.UZ)(data.features).toString()}\nmaterial: ${this.matData.name}\nmaterial features: ${(0,pipeline_feature_flags/* featureFlagsToString */.UZ)(this.features).toString()}`);\n            return false;\n        });\n        this.primitives.push(...filtered);\n    }\n}\n\n;// CONCATENATED MODULE: ./src/rendering/default-forward-pass/geometry-pipeline.ts\n\nclass GeometryPipeline {\n    constructor(features, maps) {\n        this.materials = [];\n        this.features = (0,pipeline_feature_flags/* maskRedundantFeatures */.P7)(features);\n        const module = maps.getShaderModule(features);\n        this.pipeline = maps.device.createRenderPipeline({\n            label: (0,pipeline_feature_flags/* featureFlagsToString */.UZ)(features),\n            layout: maps.getForwardPipelineLayout(features),\n            primitive: maps.getPrimitiveState(features),\n            vertex: {\n                entryPoint: 'vs',\n                buffers: [maps.getVertexLayout(features)],\n                module,\n            },\n            fragment: {\n                entryPoint: 'fs',\n                module,\n                targets: maps.gbuffer.targets,\n            },\n            depthStencil: {\n                depthWriteEnabled: true,\n                depthCompare: 'less-equal',\n                format: maps.gbuffer.depth.format,\n            },\n        });\n    }\n    addMaterials(...materials) {\n        if (materials.some((data) => data.features !== this.features)) {\n            throw new Error('invalid primitive added to material');\n        }\n        this.materials.push(...materials);\n    }\n    draw(passEncoder, queue) {\n        passEncoder.setPipeline(this.pipeline);\n        for (const mat of this.materials) {\n            mat.draw(passEncoder, queue);\n        }\n    }\n}\n\n;// CONCATENATED MODULE: ./src/samples/gltf-viewer/loader/gltf-loader.ts\n\n\n\n\n\n\n\n\nconst defaultLayout = [\n    {\n        name: 'POSITION',\n        type: 'VEC3',\n        componentType: 5126 /* ComponentType.float32 */,\n    },\n    {\n        name: 'TEXCOORD_0',\n        type: 'VEC2',\n        componentType: 5126 /* ComponentType.float32 */,\n    },\n    {\n        name: 'TANGENT',\n        type: 'VEC4',\n        componentType: 5126 /* ComponentType.float32 */,\n        depends: ['NORMAL'],\n        fill: [1, 0, 0, 1],\n    },\n    {\n        name: 'NORMAL',\n        type: 'VEC3',\n        componentType: 5126 /* ComponentType.float32 */,\n        strip: true,\n        feature: pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexNormals,\n    },\n    {\n        name: 'COLOR_0',\n        type: 'VEC4',\n        componentType: 5126 /* ComponentType.float32 */,\n        strip: true,\n        feature: pipeline_feature_flags/* PipelineFeatureFlags */.Ot.VertexColors,\n        fill: [1, 1, 1, 1],\n    },\n];\nconst recurseNode = (parentMatrix, meshes) => (node) => {\n    const matrix = node.matrix ?? wgpu_matrix_module/* mat4 */.pB.identity();\n    if (node.matrix == null) {\n        if (node.scale)\n            wgpu_matrix_module/* mat4 */.pB.scaling(node.scale, matrix);\n        if (node.rotation) {\n            const { axis, angle } = wgpu_matrix_module/* quat */.Yu.toAxisAngle(node.rotation);\n            wgpu_matrix_module/* mat4 */.pB.rotate(matrix, axis, angle, matrix);\n        }\n        if (node.translation != null) {\n            wgpu_matrix_module/* mat4 */.pB.setTranslation(matrix, node.translation, matrix);\n        }\n    }\n    wgpu_matrix_module/* mat4 */.pB.mul(parentMatrix, matrix, matrix);\n    if (node.mesh != null) {\n        if (!meshes.has(node.mesh))\n            meshes.set(node.mesh, []);\n        meshes.get(node.mesh).push(matrix); // eslint-disable-line @typescript-eslint/no-non-null-assertion\n    }\n    node.children?.forEach(recurseNode(matrix, meshes));\n};\nasync function importGltf(url, device, descriptorMap, defaultMaterial, layout = defaultLayout, pipelines = {}, \n// eslint-disable-next-line no-console\nlog = console.log) {\n    log('starting import');\n    const start = Date.now();\n    const gltfWithBuffers = await (0,load/* load */.H)(url, gltf_loader/* GLTFLoader */.B);\n    log(`finished loading: ${Date.now() - start}`);\n    const { scene } = (0,post_process_gltf/* postProcessGLTF */.R)(gltfWithBuffers);\n    if (scene?.nodes == null)\n        return pipelines;\n    log(`finished processing: ${Date.now() - start}`);\n    const meshes = new Map();\n    scene.nodes.forEach(recurseNode(wgpu_matrix_module/* mat4 */.pB.identity(), meshes));\n    log(`finished creating instances: ${Date.now() - start}`);\n    const meshEntries = Array.from(meshes.entries());\n    const primitivePromises = meshEntries.flatMap(([{ primitives }, instances]) => primitives.map((prim) => loadPrimitive(layout, prim, instances, descriptorMap, device)));\n    const primitiveDescriptors = await Promise.all(primitivePromises);\n    log(`finished creating primitives: ${Date.now() - start}`);\n    const materialMap = new Map();\n    const materialPromises = {};\n    for (const { material, drawData } of primitiveDescriptors) {\n        if (drawData == null)\n            continue;\n        const key = { materialId: material?.id, features: drawData.features };\n        if (!materialMap.has(key))\n            materialMap.set(key, []);\n        materialMap.get(key).push(drawData); // eslint-disable-line @typescript-eslint/no-non-null-assertion\n        if (material != null) {\n            materialPromises[material.id] = loadMaterial(material, defaultMaterial, device);\n        }\n    }\n    const materialEntries = Object.entries(materialPromises)\n        .map(async ([id, mat]) => [id, await mat]);\n    const materialDescriptors = Object.fromEntries(await Promise.all(materialEntries));\n    log(`finished creating material descriptors: ${Date.now() - start}`);\n    const fullDefaultMat = { ...defaultMaterial, metallicFactor: 0 };\n    for (const [{ features, materialId }, drawDatas] of materialMap.entries()) {\n        const descriptor = materialId != null ? materialDescriptors[materialId] : fullDefaultMat;\n        const mat = new MaterialDrawData(descriptor, device, descriptorMap, features, drawDatas);\n        const { features: f } = mat;\n        pipelines[f] ??= new GeometryPipeline(f, descriptorMap);\n        pipelines[f].addMaterials(mat);\n    }\n    log(`finished: ${Date.now() - start}`);\n    return pipelines;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLE9BQU8sU0FBUyxDQUFDO0FBQ3JCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvc2FtcGxlcy9nbHRmLXZpZXdlci9sb2FkZXIvd2VsZC50cz9kYzI0Iiwid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvcHJpbWl0aXZlLWRyYXctZGF0YS50cz84YTBlIiwid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy9zYW1wbGVzL2dsdGYtdmlld2VyL2xvYWRlci90eXBlLWNvbnZlcnNpb25zLnRzPzJhYWYiLCJ3ZWJwYWNrOi8vY2J1bnQtcG9ydGZvbGlvLy4vc3JjL3NhbXBsZXMvZ2x0Zi12aWV3ZXIvbG9hZGVyL2F0dHJpYnV0ZS13cmFwcGVyLnRzPzU5NTQiLCJ3ZWJwYWNrOi8vY2J1bnQtcG9ydGZvbGlvLy4vc3JjL3NhbXBsZXMvZ2x0Zi12aWV3ZXIvbG9hZGVyL2ludGVybGVhdmUtdmVydGljZXMudHM/YjNjNSIsIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvc2FtcGxlcy9nbHRmLXZpZXdlci9sb2FkZXIvcHJpbWl0aXZlLWxvYWRlci50cz8wZjU3Iiwid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy9zYW1wbGVzL2dsdGYtdmlld2VyL2xvYWRlci9tYXRlcmlhbC1sb2FkZXIudHM/YWRhMCIsIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL21hdGVyaWFsLWRyYXctZGF0YS50cz8zODlhIiwid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvZ2VvbWV0cnktcGlwZWxpbmUudHM/YjNlYiIsIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvc2FtcGxlcy9nbHRmLXZpZXdlci9sb2FkZXIvZ2x0Zi1sb2FkZXIudHM/NzA3YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXR0cmlidXRlV3JhcHBlciBmcm9tICcuL2F0dHJpYnV0ZS13cmFwcGVyJztcblxuLyoqXG4gKiBBZGFwdGVkIGZyb20gZ2x0Zi10cmFuc2Zvcm0ncyB2ZXJzaW9uOlxuICogZ2l0aHViLmNvbS9kb25tY2N1cmR5L2dsVEYtVHJhbnNmb3JtL2Jsb2IvbWFpbi9wYWNrYWdlcy9mdW5jdGlvbnMvc3JjL3dlbGQudHNcbiAqL1xuY2xhc3MgSGFzaFRhYmxlIHtcbiAgICBwcml2YXRlIGF0dHJpYnV0ZXM6IHsgdTg6IFVpbnQ4QXJyYXksIGJ5dGVTdHJpZGU6IG51bWJlciB9W10gPSBbXTtcbiAgICBwcml2YXRlIHU4OiBVaW50OEFycmF5O1xuICAgIHByaXZhdGUgdTMyOiBVaW50MzJBcnJheTtcblxuICAgIGNvbnN0cnVjdG9yKHByaW06IFJlY29yZDxzdHJpbmcsIEF0dHJpYnV0ZVdyYXBwZXI+KSB7XG4gICAgICAgIGxldCBieXRlU3RyaWRlID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgT2JqZWN0LnZhbHVlcyhwcmltKSkge1xuICAgICAgICAgICAgYnl0ZVN0cmlkZSArPSB0aGlzLmluaXRBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWRkZWRCeXRlU3RyaWRlID0gKGJ5dGVTdHJpZGUgKyAzKSAmIH4zO1xuICAgICAgICB0aGlzLnU4ID0gbmV3IFVpbnQ4QXJyYXkocGFkZGVkQnl0ZVN0cmlkZSk7XG4gICAgICAgIHRoaXMudTMyID0gbmV3IFVpbnQzMkFycmF5KHRoaXMudTguYnVmZmVyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRBdHRyaWJ1dGUoYXR0cmlidXRlOiBBdHRyaWJ1dGVXcmFwcGVyKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgdTggPSBhdHRyaWJ1dGUuZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXlcbiAgICAgICAgICAgID8gYXR0cmlidXRlLmRhdGFcbiAgICAgICAgICAgIDogbmV3IFVpbnQ4QXJyYXkoYXR0cmlidXRlLmRhdGEuYnVmZmVyKTtcbiAgICAgICAgY29uc3QgYnl0ZVN0cmlkZSA9IGF0dHJpYnV0ZS5ieXRlc1BlckNvbXBvbmVudCAqIGF0dHJpYnV0ZS5jb21wb25lbnRzUGVyRWxlbWVudDtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnB1c2goeyB1OCwgYnl0ZVN0cmlkZSB9KTtcbiAgICAgICAgcmV0dXJuIGJ5dGVTdHJpZGU7XG4gICAgfVxuXG4gICAgaGFzaChpbmRleDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGJ5dGVPZmZzZXQgPSAwO1xuICAgICAgICBmb3IgKGNvbnN0IHsgdTgsIGJ5dGVTdHJpZGUgfSBvZiB0aGlzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZVN0cmlkZTsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51OFtieXRlT2Zmc2V0ICsgaV0gPSB1OFtpbmRleCAqIGJ5dGVTdHJpZGUgKyBpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJ5dGVPZmZzZXQgKz0gYnl0ZVN0cmlkZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5tdXJtdXJIYXNoMigpO1xuICAgIH1cblxuICAgIGVxdWFsKGE6IG51bWJlciwgYjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIGZvciAoY29uc3QgeyB1OCwgYnl0ZVN0cmlkZSB9IG9mIHRoaXMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBieXRlU3RyaWRlOyBqICs9IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAodThbYSAqIGJ5dGVTdHJpZGUgKyBqXSAhPT0gdThbYiAqIGJ5dGVTdHJpZGUgKyBqXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGhhc2hMb29rdXAodGFibGU6IFR5cGVkQXJyYXksIGJ1Y2tldHM6IG51bWJlciwga2V5OiBudW1iZXIsIGVtcHR5OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBjb25zdCBoYXNobW9kID0gYnVja2V0cyAtIDE7XG4gICAgICAgIGNvbnN0IGhhc2h2YWwgPSB0aGlzLmhhc2goa2V5KTtcbiAgICAgICAgbGV0IGJ1Y2tldCA9IGhhc2h2YWwgJiBoYXNobW9kO1xuXG4gICAgICAgIGZvciAobGV0IHByb2JlID0gMDsgcHJvYmUgPD0gaGFzaG1vZDsgcHJvYmUgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRhYmxlW2J1Y2tldF07XG5cbiAgICAgICAgICAgIGlmIChpdGVtID09PSBlbXB0eSB8fCB0aGlzLmVxdWFsKGl0ZW0sIGtleSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYnVja2V0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBidWNrZXQgPSAoYnVja2V0ICsgcHJvYmUgKyAxKSAmIGhhc2htb2Q7IC8vIEhhc2ggY29sbGlzaW9uLlxuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIYXNoIHRhYmxlIGZ1bGwuJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVmZXJlbmNlczpcbiAgICAgKiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9taWtvbGFseXNlbmtvL211cm11cmhhc2gtanMvYmxvYi9mMTkxMzZlOWY5YzE3ZjhjZGRjMjE2Y2EzZDQ0ZWM3YzVjNTAyZjYwL211cm11cmhhc2gyX2djLmpzI0wxNFxuICAgICAqIC0gaHR0cHM6Ly9naXRodWIuY29tL3pldXgvbWVzaG9wdGltaXplci9ibG9iL2U0N2UxYmU2ZDNkOTUxMzE1MzE4ODIxNjQ1NWJkYmVkNDBhMjA2ZWYvc3JjL2luZGV4Z2VuZXJhdG9yLmNwcCNMMTJcbiAgICAgKi9cbiAgICBtdXJtdXJIYXNoMigpOiBudW1iZXIge1xuICAgICAgICBjb25zdCBtID0gMHg1YmQxZTk5NTtcbiAgICAgICAgY29uc3QgciA9IDI0O1xuICAgICAgICBsZXQgaCA9IDA7XG5cbiAgICAgICAgZm9yIChsZXQgayBvZiB0aGlzLnUzMikge1xuICAgICAgICAgICAgayA9IE1hdGguaW11bChrLCBtKSA+Pj4gMDtcbiAgICAgICAgICAgIGsgPSAoayBeIChrID4+IHIpKSA+Pj4gMDtcbiAgICAgICAgICAgIGsgPSBNYXRoLmltdWwoaywgbSkgPj4+IDA7XG5cbiAgICAgICAgICAgIGggPSBNYXRoLmltdWwoaCwgbSkgPj4+IDA7XG4gICAgICAgICAgICBoID0gKGggXiBrKSA+Pj4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBoO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2VpbFBvd2VyT2ZUd28odmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIDIgKiogTWF0aC5jZWlsKE1hdGgubG9nKHZhbHVlKSAvIE1hdGguTE4yKTtcbn1cblxuLyoqXG4gKiBXZWxkIGFuZCBtZXJnZSwgY29tYmluaW5nIHZlcnRpY2VzIHRoYXQgYXJlIGJpdHdpc2UtZXF1YWwuXG4gKlxuICogQWRhcHRlZCBmcm9tIGdsdGYtdHJhbnNmb3JtJ3MgX3dlbGRQcmltaXRpdmVTdHJpY3Q6XG4gKiBnaXRodWIuY29tL2Rvbm1jY3VyZHkvZ2xURi1UcmFuc2Zvcm0vYmxvYi9tYWluL3BhY2thZ2VzL2Z1bmN0aW9ucy9zcmMvd2VsZC50cyNMMTkzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHdlbGQocHJpbTogUmVjb3JkPHN0cmluZywgQXR0cmlidXRlV3JhcHBlcj4pIHtcbiAgICBjb25zdCBzcmNWZXJ0ZXhDb3VudCA9IHByaW0uUE9TSVRJT04uY291bnQ7XG4gICAgY29uc3QgaGFzaCA9IG5ldyBIYXNoVGFibGUocHJpbSk7XG4gICAgY29uc3QgdGFibGVTaXplID0gY2VpbFBvd2VyT2ZUd28oc3JjVmVydGV4Q291bnQgKyAoc3JjVmVydGV4Q291bnQgLyA0KSk7XG4gICAgY29uc3QgaXMxNkJpdCA9IHNyY1ZlcnRleENvdW50IDwgKDIgKiogMTYgLSAxKTtcbiAgICBjb25zdCBlbXB0eSA9IDIgKiogKGlzMTZCaXQgPyAxNiA6IDMyKSAtIDE7XG4gICAgY29uc3QgaW5kZXhGb3JtYXQ6IEdQVUluZGV4Rm9ybWF0ID0gaXMxNkJpdCA/ICd1aW50MTYnIDogJ3VpbnQzMic7XG4gICAgY29uc3Qgd3JpdGVNYXAgPSBpczE2Qml0ID8gbmV3IFVpbnQxNkFycmF5KHNyY1ZlcnRleENvdW50KSA6IG5ldyBVaW50MzJBcnJheShzcmNWZXJ0ZXhDb3VudCk7XG4gICAgY29uc3QgdGFibGUgPSBpczE2Qml0ID8gbmV3IFVpbnQxNkFycmF5KHRhYmxlU2l6ZSkgOiBuZXcgVWludDMyQXJyYXkodGFibGVTaXplKTtcbiAgICB0YWJsZS5maWxsKGVtcHR5KTtcblxuICAgIGxldCBkc3RWZXJ0ZXhDb3VudCA9IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNyY1ZlcnRleENvdW50OyBpICs9IDEpIHtcbiAgICAgICAgY29uc3QgaGFzaEluZGV4ID0gaGFzaC5oYXNoTG9va3VwKHRhYmxlLCB0YWJsZVNpemUsIGksIGVtcHR5KTtcbiAgICAgICAgY29uc3QgZHN0SW5kZXggPSB0YWJsZVtoYXNoSW5kZXhdO1xuXG4gICAgICAgIGlmIChkc3RJbmRleCA9PT0gZW1wdHkpIHtcbiAgICAgICAgICAgIHRhYmxlW2hhc2hJbmRleF0gPSBpO1xuICAgICAgICAgICAgd3JpdGVNYXBbaV0gPSBkc3RWZXJ0ZXhDb3VudDtcbiAgICAgICAgICAgIGRzdFZlcnRleENvdW50ICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3cml0ZU1hcFtpXSA9IHdyaXRlTWFwW2RzdEluZGV4XTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIE9iamVjdC52YWx1ZXMocHJpbSkpIHtcbiAgICAgICAgYXR0cmlidXRlLnJlbWFwKHdyaXRlTWFwLCBkc3RWZXJ0ZXhDb3VudCk7XG4gICAgfVxuXG4gICAgLy8gVGhlIGdsdGYtdHJhbnNmb3JtIHZlcnNpb24gY2hlY2tzIGZvciBkZWdlbmVyYXRlIHRyaWFuZ2xlcyB0byByZW1vdmUuXG4gICAgLy8gVGhpcyBpcyBvbWl0dGVkIGhlcmUuXG4gICAgcmV0dXJuIHsgaW5kZXhBcnJheTogd3JpdGVNYXAsIGluZGV4Rm9ybWF0LCB2ZXJ0ZXhDb3VudDogZHN0VmVydGV4Q291bnQgfTtcbn1cbiIsImltcG9ydCB7IG1hdDMsIG1hdDQsIE1hdDMsIE1hdDQgfSBmcm9tICd3Z3B1LW1hdHJpeCc7XG5cbmltcG9ydCB7IFR5cGVTaXplcyB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBjcmVhdGVBbmRDb3B5QnVmZmVyIH0gZnJvbSAnLi4vLi4vdXRpbHMvZGF0YS1jb3B5JztcbmltcG9ydCB7IFBpcGVsaW5lRmVhdHVyZUZsYWdzIH0gZnJvbSAnLi9waXBlbGluZS1mZWF0dXJlLWZsYWdzJztcbmltcG9ydCBEZXNjcmlwdG9yTWFwIGZyb20gJy4vZGVzY3JpcHRvci1tYXAnO1xuXG5leHBvcnQgdHlwZSBQcmltaXRpdmVEZXNjcmlwdG9yID0ge1xuICAgIG5hbWU/OiBzdHJpbmcsXG4gICAgLy8gdmVydGV4QnVmZmVyTGF5b3V0czogR1BVVmVydGV4QnVmZmVyTGF5b3V0O1xuICAgIGZlYXR1cmVzOiBQaXBlbGluZUZlYXR1cmVGbGFncyxcbiAgICB2ZXJ0ZXhDb3VudDogbnVtYmVyLFxuICAgIHZlcnRleEFycmF5OiBBcnJheUJ1ZmZlciB8IFR5cGVkQXJyYXkgfCBHUFVCdWZmZXIsXG4gICAgaW5kZXhBcnJheT86IEFycmF5QnVmZmVyIHwgVHlwZWRBcnJheSxcbiAgICBpbmRleEZvcm1hdD86IEdQVUluZGV4Rm9ybWF0LFxufTtcblxuZXhwb3J0IHR5cGUgSW5kZXhEYXRhID0ge1xuICAgIGluZGV4QnVmZmVyOiBHUFVCdWZmZXIsXG4gICAgaW5kZXhDb3VudDogbnVtYmVyLFxuICAgIGluZGV4Rm9ybWF0OiBHUFVJbmRleEZvcm1hdCxcbn07XG5cbmV4cG9ydCBjbGFzcyBQcmltaXRpdmVEcmF3RGF0YSB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHZlcnRleEJ1ZmZlcjogR1BVQnVmZmVyO1xuICAgIGluZGV4RGF0YT86IEluZGV4RGF0YTtcbiAgICBpbnN0YW5jZUJ1ZmZlcjogR1BVQnVmZmVyO1xuICAgIGluc3RhbmNlQmluZEdyb3VwOiBHUFVCaW5kR3JvdXA7XG4gICAgdmVydGV4Q291bnQ6IG51bWJlcjtcbiAgICBmZWF0dXJlczogbnVtYmVyO1xuXG4gICAgaW5zdGFuY2VTaXplOiBudW1iZXI7XG5cbiAgICBpbnN0YW5jZXM6IEFycmF5QnVmZmVyO1xuICAgIG1vZGVsTWF0cmljZXM6IE1hdDRbXTtcbiAgICBub3JtYWxNYXRyaWNlcyE6IE1hdDNbXTtcbiAgICBtYXg6IG51bWJlcjtcblxuICAgIGluc3RhbmNlQ291bnQ6IG51bWJlciA9IDA7XG4gICAgZGlydHk6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcmltaXRpdmU6IFByaW1pdGl2ZURlc2NyaXB0b3IsXG4gICAgICAgIGRldmljZTogR1BVRGV2aWNlLFxuICAgICAgICBtYXg6IG51bWJlcixcbiAgICAgICAgZGVzY3JpcHRvck1hcDogRGVzY3JpcHRvck1hcCxcbiAgICAgICAgaW5zdGFuY2VzPzogTWF0NFtdLFxuICAgICkge1xuICAgICAgICB0aGlzLm1heCA9IG1heDtcbiAgICAgICAgdGhpcy5mZWF0dXJlcyA9IHByaW1pdGl2ZS5mZWF0dXJlcztcbiAgICAgICAgdGhpcy5uYW1lID0gcHJpbWl0aXZlLm5hbWUgPz8gJ21lc2gnO1xuICAgICAgICB0aGlzLnZlcnRleENvdW50ID0gcHJpbWl0aXZlLnZlcnRleENvdW50O1xuXG4gICAgICAgIGlmIChwcmltaXRpdmUudmVydGV4QXJyYXkgaW5zdGFuY2VvZiBHUFVCdWZmZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmVydGV4QnVmZmVyID0gcHJpbWl0aXZlLnZlcnRleEFycmF5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52ZXJ0ZXhCdWZmZXIgPSBjcmVhdGVBbmRDb3B5QnVmZmVyKFxuICAgICAgICAgICAgICAgIHByaW1pdGl2ZS52ZXJ0ZXhBcnJheSxcbiAgICAgICAgICAgICAgICBHUFVCdWZmZXJVc2FnZS5WRVJURVgsXG4gICAgICAgICAgICAgICAgZGV2aWNlLFxuICAgICAgICAgICAgICAgIGAke3RoaXMubmFtZX0gdmVydGV4IGJ1ZmZlcmAsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByaW1pdGl2ZS5pbmRleEFycmF5ICYmIHByaW1pdGl2ZS5pbmRleEZvcm1hdCkge1xuICAgICAgICAgICAgY29uc3QgeyBpbmRleEFycmF5LCBpbmRleEZvcm1hdCB9ID0gcHJpbWl0aXZlO1xuICAgICAgICAgICAgdGhpcy5pbmRleERhdGEgPSB7XG4gICAgICAgICAgICAgICAgaW5kZXhGb3JtYXQsXG4gICAgICAgICAgICAgICAgaW5kZXhDb3VudDogaW5kZXhBcnJheS5ieXRlTGVuZ3RoIC8gKGluZGV4Rm9ybWF0ID09PSAndWludDE2JyA/IDIgOiA0KSxcbiAgICAgICAgICAgICAgICBpbmRleEJ1ZmZlcjogY3JlYXRlQW5kQ29weUJ1ZmZlcihcbiAgICAgICAgICAgICAgICAgICAgcHJpbWl0aXZlLmluZGV4QXJyYXksXG4gICAgICAgICAgICAgICAgICAgIEdQVUJ1ZmZlclVzYWdlLklOREVYLFxuICAgICAgICAgICAgICAgICAgICBkZXZpY2UsXG4gICAgICAgICAgICAgICAgICAgIGAke3RoaXMubmFtZX0gaW5kZXggYnVmZmVyYCxcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaW5zdGFuY2VTaXplID0gVHlwZVNpemVzLnNpemVvZk1hdDR4NGY7XG4gICAgICAgIGlmICh0aGlzLmZlYXR1cmVzICYgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscykge1xuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZVNpemUgKz0gMTIgKiA0O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pbnN0YW5jZXMgPSBuZXcgQXJyYXlCdWZmZXIobWF4ICogdGhpcy5pbnN0YW5jZVNpemUpO1xuICAgICAgICB0aGlzLm1vZGVsTWF0cmljZXMgPSBuZXcgQXJyYXkobWF4KSBhcyBGbG9hdDMyQXJyYXlbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBpICogdGhpcy5pbnN0YW5jZVNpemU7XG4gICAgICAgICAgICB0aGlzLm1vZGVsTWF0cmljZXNbaV0gPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuaW5zdGFuY2VzLCBvZmZzZXQsIDE2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmZlYXR1cmVzICYgUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscykge1xuICAgICAgICAgICAgdGhpcy5ub3JtYWxNYXRyaWNlcyA9IG5ldyBBcnJheShtYXgpIGFzIEZsb2F0MzJBcnJheVtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gKGkgKiB0aGlzLmluc3RhbmNlU2l6ZSkgKyBUeXBlU2l6ZXMuc2l6ZW9mTWF0NHg0ZjtcbiAgICAgICAgICAgICAgICB0aGlzLm5vcm1hbE1hdHJpY2VzW2ldID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLmluc3RhbmNlcywgb2Zmc2V0LCAxMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluc3RhbmNlQnVmZmVyID0gZGV2aWNlLmNyZWF0ZUJ1ZmZlcih7XG4gICAgICAgICAgICBsYWJlbDogYCR7dGhpcy5uYW1lfSBpbnN0YW5jZSBidWZmZXJgLFxuICAgICAgICAgICAgc2l6ZTogdGhpcy5pbnN0YW5jZXMuYnl0ZUxlbmd0aCxcbiAgICAgICAgICAgIHVzYWdlOiBHUFVCdWZmZXJVc2FnZS5TVE9SQUdFIHwgR1BVQnVmZmVyVXNhZ2UuQ09QWV9EU1QgfCBHUFVCdWZmZXJVc2FnZS5VTklGT1JNLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmluc3RhbmNlQmluZEdyb3VwID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cCh7XG4gICAgICAgICAgICBsYWJlbDogYFByaW1pdGl2ZURyYXdEYXRhIGluc3RhbmNlIGJpbmQgZ3JvdXBgLFxuICAgICAgICAgICAgbGF5b3V0OiBkZXNjcmlwdG9yTWFwLmZvcndhcmRCaW5kZ3JvdXBMYXlvdXQsXG4gICAgICAgICAgICBlbnRyaWVzOiBbe1xuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDAsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2U6IHsgYnVmZmVyOiB0aGlzLmluc3RhbmNlQnVmZmVyIH0sXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGluc3RhbmNlcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpbnN0YW5jZSBvZiBpbnN0YW5jZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEluc3RhbmNlKGluc3RhbmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXcocGFzc0VuY29kZXI6IEdQVVJlbmRlclBhc3NFbmNvZGVyLCBxdWV1ZTogR1BVUXVldWUpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlydHkpIHtcbiAgICAgICAgICAgIHF1ZXVlLndyaXRlQnVmZmVyKHRoaXMuaW5zdGFuY2VCdWZmZXIsIDAsIHRoaXMuaW5zdGFuY2VzKTtcbiAgICAgICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhc3NFbmNvZGVyLnNldFZlcnRleEJ1ZmZlcigwLCB0aGlzLnZlcnRleEJ1ZmZlcik7XG4gICAgICAgIHBhc3NFbmNvZGVyLnNldEJpbmRHcm91cCgyLCB0aGlzLmluc3RhbmNlQmluZEdyb3VwKTtcblxuICAgICAgICBpZiAodGhpcy5pbmRleERhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgeyBpbmRleEJ1ZmZlciwgaW5kZXhDb3VudCwgaW5kZXhGb3JtYXQgfSA9IHRoaXMuaW5kZXhEYXRhO1xuICAgICAgICAgICAgcGFzc0VuY29kZXIuc2V0SW5kZXhCdWZmZXIoaW5kZXhCdWZmZXIsIGluZGV4Rm9ybWF0KTtcbiAgICAgICAgICAgIHBhc3NFbmNvZGVyLmRyYXdJbmRleGVkKGluZGV4Q291bnQsIHRoaXMuaW5zdGFuY2VDb3VudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYXNzRW5jb2Rlci5kcmF3KHRoaXMudmVydGV4Q291bnQsIHRoaXMuaW5zdGFuY2VDb3VudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRJbnN0YW5jZSh0cmFuc2Zvcm06IE1hdDQpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2VDb3VudCA9PT0gdGhpcy5tYXgpIHJldHVybjtcbiAgICAgICAgbWF0NC5jb3B5KHRyYW5zZm9ybSwgdGhpcy5tb2RlbE1hdHJpY2VzW3RoaXMuaW5zdGFuY2VDb3VudF0pO1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZU5vcm1hbE1hdHJpeCh0aGlzLmluc3RhbmNlQ291bnQpO1xuICAgICAgICB0aGlzLmluc3RhbmNlQ291bnQgKz0gMTtcbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgfVxuXG4gICAgY2FsY3VsYXRlTm9ybWFsTWF0cml4KGlkeDogbnVtYmVyKSB7XG4gICAgICAgIGlmICghKHRoaXMuZmVhdHVyZXMgJiBQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhOb3JtYWxzKSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBub3JtYWxNYXRyaXggPSB0aGlzLm5vcm1hbE1hdHJpY2VzW2lkeF07XG4gICAgICAgIG1hdDMuZnJvbU1hdDQodGhpcy5tb2RlbE1hdHJpY2VzW2lkeF0sIG5vcm1hbE1hdHJpeCk7XG4gICAgICAgIG1hdDMuaW52ZXJ0KG5vcm1hbE1hdHJpeCwgbm9ybWFsTWF0cml4KTtcbiAgICAgICAgbWF0My50cmFuc3Bvc2Uobm9ybWFsTWF0cml4LCBub3JtYWxNYXRyaXgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgR0xURiB9IGZyb20gJy4uLy4uLy4uL2luY2x1ZGUvZ2x0Zic7XG5pbXBvcnQgeyBQaXBlbGluZUZlYXR1cmVGbGFncyB9IGZyb20gJy4uLy4uLy4uL3JlbmRlcmluZy9kZWZhdWx0LWZvcndhcmQtcGFzcy9waXBlbGluZS1mZWF0dXJlLWZsYWdzJztcblxuZXhwb3J0IHR5cGUgQXR0cmlidXRlRGV0YWlscyA9IHtcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgdHlwZTogR0xURi5BY2Nlc3NvclR5cGUsXG4gICAgY29tcG9uZW50VHlwZTogR0xURi5BY2Nlc3NvckNvbXBvbmVudFR5cGUsXG4gICAgc3RyaXA/OiBib29sZWFuLFxuICAgIGRlcGVuZHM/OiBzdHJpbmdbXSxcbiAgICBmZWF0dXJlPzogUGlwZWxpbmVGZWF0dXJlRmxhZ3MsXG4gICAgZmlsbD86IG51bWJlcltdLFxufTtcblxuZXhwb3J0IGNvbnN0IGVudW0gQ29tcG9uZW50VHlwZSB7XG4gICAgaW50OCA9IDUxMjAsXG4gICAgdWludDggPSA1MTIxLFxuICAgIGludDE2ID0gNTEyMixcbiAgICB1aW50MTYgPSA1MTIzLFxuICAgIHVpbnQzMiA9IDUxMjUsXG4gICAgZmxvYXQzMiA9IDUxMjYsXG59XG5cbmV4cG9ydCBjb25zdCB0eXBlVG9FbGVtZW50Q291bnQ6IFJlY29yZDxHTFRGLkFjY2Vzc29yVHlwZSwgbnVtYmVyPiA9IHtcbiAgICBTQ0FMQVI6IDEsXG4gICAgVkVDMjogMixcbiAgICBWRUMzOiAzLFxuICAgIFZFQzQ6IDQsXG4gICAgTUFUMjogNCxcbiAgICBNQVQzOiAxMixcbiAgICBNQVQ0OiAxNixcbn07XG5cbmV4cG9ydCBjb25zdCBjb21wb25lbnRUb1NpemU6IFJlY29yZDxDb21wb25lbnRUeXBlLCBudW1iZXI+ID0ge1xuICAgIFtDb21wb25lbnRUeXBlLmludDhdOiAxLFxuICAgIFtDb21wb25lbnRUeXBlLnVpbnQ4XTogMSxcbiAgICBbQ29tcG9uZW50VHlwZS5pbnQxNl06IDIsXG4gICAgW0NvbXBvbmVudFR5cGUudWludDE2XTogMixcbiAgICBbQ29tcG9uZW50VHlwZS51aW50MzJdOiA0LFxuICAgIFtDb21wb25lbnRUeXBlLmZsb2F0MzJdOiA0LFxufTtcblxuZXhwb3J0IGNvbnN0IGVudW0gVG9wb2xvZ3lNb2RlIHtcbiAgICBQb2ludHMgPSAwLFxuICAgIExpbmVMaXN0ID0gMSxcbiAgICBMaW5lTG9vcCA9IDIsXG4gICAgTGluZVN0cmlwID0gMyxcbiAgICBUcmlhbmdsZUxpc3QgPSA0LFxuICAgIFRyaWFuZ2xlU3RyaXAgPSA1LFxuICAgIFRyaWFuZ2xlRmFuID0gNixcbn1cblxuZXhwb3J0IGNvbnN0IG1vZGVUb1RvcG9sb2d5OiBQYXJ0aWFsPFJlY29yZDxUb3BvbG9neU1vZGUsIFBpcGVsaW5lRmVhdHVyZUZsYWdzPj4gPSB7XG4gICAgW1RvcG9sb2d5TW9kZS5Qb2ludHNdOiBQaXBlbGluZUZlYXR1cmVGbGFncy5Qb2ludExpc3QsIC8vIFBPSU5UU1xuICAgIFtUb3BvbG9neU1vZGUuTGluZUxpc3RdOiBQaXBlbGluZUZlYXR1cmVGbGFncy5MaW5lTGlzdCwgLy8gTElORVNcbiAgICAvLyAyOiBMSU5FX0xPT1AgKHVuc3VwcG9ydGVkIGJ5IHdlYmdwdSlcbiAgICAvLyAzOiBQaXBlbGluZUZlYXR1cmVGbGFncy5MaW5lU3RyaXAsIC8vIExJTkVfU1RSSVBcbiAgICBbVG9wb2xvZ3lNb2RlLlRyaWFuZ2xlTGlzdF06IFBpcGVsaW5lRmVhdHVyZUZsYWdzLlRyaWFuZ2xlTGlzdCwgLy8gVFJJQU5HTEVTXG4gICAgLy8gNTogUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVHJpYW5nbGVTdHJpcCwgLy8gVFJJQU5HTEVfU1RSSVBcbiAgICAvLyA2OiBUUklBTkdMRV9GQU4gKHVuc3VwcG9ydGVkIGJ5IHdlYmdwdSlcbn07XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uICovXG5cbmltcG9ydCB7IEdMVEZBY2Nlc3NvclBvc3Rwcm9jZXNzZWQgfSBmcm9tICdAbG9hZGVycy5nbC9nbHRmJztcbmltcG9ydCB7IENvbXBvbmVudFR5cGUgfSBmcm9tICcuL3R5cGUtY29udmVyc2lvbnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBdHRyaWJ1dGVXcmFwcGVyIHtcbiAgICBkYXRhOiBUeXBlZEFycmF5O1xuICAgIHByb2Nlc3NlZDogYm9vbGVhbjtcbiAgICBjb21wb25lbnRzUGVyRWxlbWVudDogbnVtYmVyO1xuICAgIGJ5dGVzUGVyQ29tcG9uZW50OiBudW1iZXI7XG4gICAgY291bnQ6IG51bWJlcjtcblxuICAgIGNvcHlGcm9tOiAoc3JjSWR4OiBudW1iZXIsIGRzdElkeDogbnVtYmVyLCBkc3Q6IEZsb2F0MzJBcnJheSkgPT4gdm9pZDtcblxuICAgIGF0PzogKGk6IG51bWJlciwgajogbnVtYmVyKSA9PiBudW1iZXI7XG4gICAgdmlldz86IERhdGFWaWV3O1xuXG4gICAgdW53ZWxkZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKGFjY2Vzc29yOiBHTFRGQWNjZXNzb3JQb3N0cHJvY2Vzc2VkKTtcbiAgICBjb25zdHJ1Y3RvcihhcnJheTogRmxvYXQzMkFycmF5LCBjb21wb25lbnRDb3VudDogbnVtYmVyKTtcblxuICAgIGNvbnN0cnVjdG9yKGFjY2Vzc29yOiBHTFRGQWNjZXNzb3JQb3N0cHJvY2Vzc2VkIHwgRmxvYXQzMkFycmF5LCBjb21wb25lbnRDb3VudD86IG51bWJlcikge1xuICAgICAgICBpZiAoYWNjZXNzb3IgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGFjY2Vzc29yO1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudCA9IGNvbXBvbmVudENvdW50ITtcbiAgICAgICAgICAgIHRoaXMuY291bnQgPSBhY2Nlc3Nvci5sZW5ndGggLyBjb21wb25lbnRDb3VudCE7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmJ5dGVzUGVyQ29tcG9uZW50ID0gNDtcbiAgICAgICAgICAgIHRoaXMuY29weUZyb20gPSB0aGlzLmNvcHlQcm9jZXNzZWQuYmluZCh0aGlzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGFjY2Vzc29yLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudCA9IGFjY2Vzc29yLmNvbXBvbmVudHM7XG4gICAgICAgICAgICB0aGlzLmNvdW50ID0gYWNjZXNzb3IuY291bnQ7XG4gICAgICAgICAgICB0aGlzLmJ5dGVzUGVyQ29tcG9uZW50ID0gYWNjZXNzb3IuYnl0ZXNQZXJDb21wb25lbnQ7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gbmV3IERhdGFWaWV3KHRoaXMuZGF0YS5idWZmZXIpO1xuICAgICAgICAgICAgdGhpcy5jb3B5RnJvbSA9IHRoaXMuY29weVVucHJvY2Vzc2VkLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoYWNjZXNzb3IuY29tcG9uZW50VHlwZSBhcyBDb21wb25lbnRUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBDb21wb25lbnRUeXBlLmludDg6IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdCA9IChpLCBqKSA9PiB0aGlzLnZpZXchLmdldEludDgoaSAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQgKyBqKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgQ29tcG9uZW50VHlwZS51aW50ODoge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0ID0gKGksIGopID0+IHRoaXMudmlldyEuZ2V0VWludDgoaSAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQgKyBqKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgQ29tcG9uZW50VHlwZS5pbnQxNjoge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0ID0gKGksIGopID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IDIgKiAoaSAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQgKyBqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXchLmdldEludDE2KG9mZnNldCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUudWludDE2OiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXQgPSAoaSwgaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gMiAqIChpICogdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudCArIGopO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldyEuZ2V0VWludDE2KG9mZnNldCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUudWludDMyOiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXQgPSAoaSwgaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gNCAqIChpICogdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudCArIGopO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldyEuZ2V0VWludDMyKG9mZnNldCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUuZmxvYXQzMjoge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0ID0gKGksIGopID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IDQgKiAoaSAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQgKyBqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXchLmdldEZsb2F0MzIob2Zmc2V0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcihgZ2x0ZiBpbXBvcnRlciAtLSBpbnZhbGlkIGNvbXBvbmVudFR5cGUgJHthY2Nlc3Nvci5jb21wb25lbnRUeXBlfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYWNjZXNzb3Iubm9ybWFsaXplZCkge1xuICAgICAgICAgICAgICAgIGxldCB2YWw6IG51bWJlcjtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjY2Vzc29yLmNvbXBvbmVudFR5cGUgYXMgQ29tcG9uZW50VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUudWludDg6IHZhbCA9IDI1NTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgQ29tcG9uZW50VHlwZS5pbnQ4OiB2YWwgPSAxMjc7IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUudWludDE2OiB2YWwgPSA2NTUzNTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgQ29tcG9uZW50VHlwZS5pbnQxNjogdmFsID0gMzI3Njc7IGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIENvbXBvbmVudFR5cGUudWludDMyOiB2YWwgPSA0Mjk0OTY3Mjk1OyBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEVycm9yKGBnbHRmIGltcG9ydGVyIC0tIGludmFsaWQgY29tcG9uZW50VHlwZSAke2FjY2Vzc29yLmNvbXBvbmVudFR5cGV9YCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5hdCA9IChpLCBqKSA9PiB0aGlzLmF0IShpLCBqKSAvIHZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBhcnJheSgpOiBGbG9hdDMyQXJyYXkge1xuICAgICAgICBpZiAoIXRoaXMucHJvY2Vzc2VkKSB0aGlzLnByb2Nlc3MoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YSBhcyBGbG9hdDMyQXJyYXk7XG4gICAgfVxuXG4gICAgY29weVByb2Nlc3NlZChzcmNJZHg6IG51bWJlciwgZHN0SWR4OiBudW1iZXIsIGRzdDogRmxvYXQzMkFycmF5KSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudDsgaiArPSAxKSB7XG4gICAgICAgICAgICBkc3RbZHN0SWR4ICsgal0gPSB0aGlzLmRhdGFbKHNyY0lkeCAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQpICsgal07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb3B5VW5wcm9jZXNzZWQoc3JjSWR4OiBudW1iZXIsIGRzdElkeDogbnVtYmVyLCBkc3Q6IEZsb2F0MzJBcnJheSkge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQ7IGogKz0gMSkge1xuICAgICAgICAgICAgZHN0W2RzdElkeCArIGpdID0gdGhpcy5hdCEoc3JjSWR4LCBqKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1hcmtQcm9jZXNzZWQoKSB7XG4gICAgICAgIHRoaXMucHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jb3B5RnJvbSA9IHRoaXMuY29weVByb2Nlc3NlZC5iaW5kKHRoaXMpO1xuICAgICAgICBkZWxldGUgdGhpcy52aWV3O1xuICAgICAgICBkZWxldGUgdGhpcy5hdDtcbiAgICB9XG5cbiAgICBwcm9jZXNzKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9jZXNzZWQpIHJldHVybjtcbiAgICAgICAgY29uc3QgbmV3VmlldyA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5jb3VudCAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICB0aGlzLmNvcHlGcm9tKGksIGkgKiB0aGlzLmNvbXBvbmVudHNQZXJFbGVtZW50LCBuZXdWaWV3KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGF0YSA9IG5ld1ZpZXc7XG4gICAgICAgIHRoaXMubWFya1Byb2Nlc3NlZCgpO1xuICAgIH1cblxuICAgIHVud2VsZChpbmRleEFycmF5OiBUeXBlZEFycmF5KTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnVud2VsZGVkKSByZXR1cm47XG4gICAgICAgIHRoaXMudW53ZWxkZWQgPSB0cnVlO1xuICAgICAgICBjb25zdCBuZXdWaWV3ID0gbmV3IEZsb2F0MzJBcnJheShpbmRleEFycmF5Lmxlbmd0aCAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5kZXhBcnJheS5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgdGhpcy5jb3B5RnJvbShpbmRleEFycmF5W2ldLCBpICogdGhpcy5jb21wb25lbnRzUGVyRWxlbWVudCwgbmV3Vmlldyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvdW50ID0gaW5kZXhBcnJheS5sZW5ndGg7XG4gICAgICAgIHRoaXMuZGF0YSA9IG5ld1ZpZXc7XG4gICAgICAgIHRoaXMubWFya1Byb2Nlc3NlZCgpO1xuICAgIH1cblxuICAgIHJlbWFwKHJlbWFwOiBUeXBlZEFycmF5LCBkc3RDb3VudDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRzdEFycmF5ID0gbmV3IEZsb2F0MzJBcnJheShkc3RDb3VudCAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQpO1xuICAgICAgICBjb25zdCBkb25lID0gbmV3IFVpbnQ4QXJyYXkoZHN0Q291bnQpO1xuXG4gICAgICAgIGZvciAobGV0IHNyY0luZGV4ID0gMDsgc3JjSW5kZXggPCB0aGlzLmNvdW50OyBzcmNJbmRleCArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBkc3RJbmRleCA9IHJlbWFwW3NyY0luZGV4XTtcbiAgICAgICAgICAgIGlmIChkb25lW2RzdEluZGV4XSkgY29udGludWU7XG4gICAgICAgICAgICB0aGlzLmNvcHlGcm9tKHNyY0luZGV4LCBkc3RJbmRleCAqIHRoaXMuY29tcG9uZW50c1BlckVsZW1lbnQsIGRzdEFycmF5KTtcbiAgICAgICAgICAgIGRvbmVbZHN0SW5kZXhdID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZGF0YSA9IGRzdEFycmF5O1xuICAgICAgICB0aGlzLm1hcmtQcm9jZXNzZWQoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgQXR0cmlidXRlV3JhcHBlciBmcm9tICcuL2F0dHJpYnV0ZS13cmFwcGVyJztcbmltcG9ydCB7IFBpcGVsaW5lRmVhdHVyZUZsYWdzIH0gZnJvbSAnLi4vLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL3BpcGVsaW5lLWZlYXR1cmUtZmxhZ3MnO1xuXG4vLyBjb25zdCBnb2FsTGF5b3V0OiBBdHRyaWJ1dGVEZXRhaWxzW10gPSBbXG4vLyAgICAge1xuLy8gICAgICAgICBuYW1lOiAnUE9TSVRJT04nLFxuLy8gICAgICAgICB0eXBlOiAnVkVDMycsXG4vLyAgICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbi8vICAgICB9LFxuLy8gICAgIHtcbi8vICAgICAgICAgbmFtZTogJ1RFWENPT1JEXzAnLFxuLy8gICAgICAgICB0eXBlOiAnVkVDMicsXG4vLyAgICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbi8vICAgICB9LFxuLy8gICAgIHtcbi8vICAgICAgICAgbmFtZTogJ1RBTkdFTlQnLFxuLy8gICAgICAgICB0eXBlOiAnVkVDNCcsXG4vLyAgICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbi8vICAgICAgICAgZGVwZW5kczogWydOT1JNQUwnXSxcbi8vICAgICAgICAgZmlsbDogWzEsIDAsIDAsIDFdLFxuLy8gICAgIH0sXG4vLyAgICAge1xuLy8gICAgICAgICBuYW1lOiAnTk9STUFMJyxcbi8vICAgICAgICAgdHlwZTogJ1ZFQzMnLFxuLy8gICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4vLyAgICAgICAgIHN0cmlwOiB0cnVlLFxuLy8gICAgICAgICBmZWF0dXJlOiBQaXBlbGluZUZlYXR1cmVGbGFncy5WZXJ0ZXhOb3JtYWxzLFxuLy8gICAgIH0sXG4vLyAgICAge1xuLy8gICAgICAgICBuYW1lOiAnQ09MT1JfMCcsXG4vLyAgICAgICAgIHR5cGU6ICdWRUM0Jyxcbi8vICAgICAgICAgY29tcG9uZW50VHlwZTogQ29tcG9uZW50VHlwZS5mbG9hdDMyLFxuLy8gICAgICAgICBzdHJpcDogdHJ1ZSxcbi8vICAgICAgICAgZmVhdHVyZTogUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Q29sb3JzLFxuLy8gICAgICAgICBmaWxsOiBbMSwgMSwgMSwgMV0sXG4vLyAgICAgfSxcbi8vIF07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGludGVybGVhdmVWZXJ0aWNlcyhcbiAgICBhdHRyaWJ1dGVzOiBQYXJ0aWFsPFJlY29yZDxzdHJpbmcsIEF0dHJpYnV0ZVdyYXBwZXI+PixcbiAgICBjb3VudDogbnVtYmVyLFxuKSB7XG4gICAgbGV0IHZlcnRleEZlYXR1cmVzOiBQaXBlbGluZUZlYXR1cmVGbGFncyA9IFBpcGVsaW5lRmVhdHVyZUZsYWdzLkRlZmF1bHRzO1xuICAgIGxldCBzdHJpZGUgPSA1O1xuICAgIGlmIChhdHRyaWJ1dGVzLk5PUk1BTCAhPSBudWxsKSBzdHJpZGUgKz0gNztcbiAgICBpZiAoYXR0cmlidXRlcy5DT0xPUl8wICE9IG51bGwpIHN0cmlkZSArPSA0O1xuXG4gICAgY29uc3QgdmVydGV4QXJyYXkgPSBuZXcgQXJyYXlCdWZmZXIoc3RyaWRlICogY291bnQgKiA0KTtcbiAgICBjb25zdCB2ZXJ0ZXhWaWV3ID0gbmV3IEZsb2F0MzJBcnJheSh2ZXJ0ZXhBcnJheSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgYXR0cmlidXRlcy5QT1NJVElPTj8uY29weUZyb20oaSwgc3RyaWRlICogaSwgdmVydGV4Vmlldyk7XG4gICAgfVxuXG4gICAgY29uc3QgdXYgPSBhdHRyaWJ1dGVzLlRFWENPT1JEXzAgPz8gbmV3IEF0dHJpYnV0ZVdyYXBwZXIobmV3IEZsb2F0MzJBcnJheShjb3VudCAqIDIpLCAyKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpICs9IDEpIHtcbiAgICAgICAgdXYuY29weUZyb20oaSwgaSAqIHN0cmlkZSArIDMsIHZlcnRleFZpZXcpO1xuICAgIH1cblxuICAgIGlmIChhdHRyaWJ1dGVzLk5PUk1BTCAhPSBudWxsICYmIGF0dHJpYnV0ZXMuVEFOR0VOVCAhPSBudWxsKSB7XG4gICAgICAgIHZlcnRleEZlYXR1cmVzIHw9IFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleE5vcm1hbHM7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLlRBTkdFTlQuY29weUZyb20oaSwgaSAqIHN0cmlkZSArIDUsIHZlcnRleFZpZXcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLk5PUk1BTC5jb3B5RnJvbShpLCBpICogc3RyaWRlICsgOSwgdmVydGV4Vmlldyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYXR0cmlidXRlcy5DT0xPUl8wICE9IG51bGwpIHtcbiAgICAgICAgdmVydGV4RmVhdHVyZXMgfD0gUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Q29sb3JzO1xuICAgICAgICBjb25zdCBzdGVwID0gYXR0cmlidXRlcy5OT1JNQUwgIT0gbnVsbCA/IDEyIDogNTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLkNPTE9SXzAuY29weUZyb20oaSwgaSAqIHN0cmlkZSArIHN0ZXAsIHZlcnRleFZpZXcpO1xuICAgICAgICAgICAgdmVydGV4Vmlld1tpICogc3RyaWRlICsgc3RlcCArIDNdID0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IHZlcnRleEFycmF5LCB2ZXJ0ZXhGZWF0dXJlcyB9O1xufVxuIiwiaW1wb3J0IHsgTWF0NCwgbWF0NCB9IGZyb20gJ3dncHUtbWF0cml4JztcbmltcG9ydCB7IEdMVEZBY2Nlc3NvclBvc3Rwcm9jZXNzZWQsIEdMVEZNYXRlcmlhbFBvc3Rwcm9jZXNzZWQsIEdMVEZNZXNoUHJpbWl0aXZlUG9zdHByb2Nlc3NlZCB9IGZyb20gJ0Bsb2FkZXJzLmdsL2dsdGYnO1xuXG5pbXBvcnQgd2VsZCBmcm9tICcuL3dlbGQnO1xuaW1wb3J0IHsgUGlwZWxpbmVGZWF0dXJlRmxhZ3MgfSBmcm9tICcuLi8uLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvcGlwZWxpbmUtZmVhdHVyZS1mbGFncyc7XG5pbXBvcnQgeyBQcmltaXRpdmVEcmF3RGF0YSB9IGZyb20gJy4uLy4uLy4uL3JlbmRlcmluZy9kZWZhdWx0LWZvcndhcmQtcGFzcy9wcmltaXRpdmUtZHJhdy1kYXRhJztcbmltcG9ydCB7IEF0dHJpYnV0ZURldGFpbHMsIFRvcG9sb2d5TW9kZSwgbW9kZVRvVG9wb2xvZ3kgfSBmcm9tICcuL3R5cGUtY29udmVyc2lvbnMnO1xuaW1wb3J0IERlc2NyaXB0b3JNYXAgZnJvbSAnLi4vLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL2Rlc2NyaXB0b3ItbWFwJztcbmltcG9ydCBBdHRyaWJ1dGVXcmFwcGVyIGZyb20gJy4vYXR0cmlidXRlLXdyYXBwZXInO1xuaW1wb3J0IGludGVybGVhdmVWZXJ0aWNlcyBmcm9tICcuL2ludGVybGVhdmUtdmVydGljZXMnO1xuaW1wb3J0IHsgbWFwVmFsdWVzIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvZ2VuZXJhbCc7XG5cbmV4cG9ydCB0eXBlIE5hbWVkQXR0cmlidXRlID0gJ1BPU0lUSU9OJyB8ICdOT1JNQUwnIHwgJ1RBTkdFTlQnO1xuZXhwb3J0IHR5cGUgTnVtYmVyZWRBdHRyaWJ1dGUgPSAnVEVYQ09PUkQnIHwgJ0NPTE9SJyB8ICdKT0lOVFMnIHwgJ1dFSUdIVFMnO1xuZXhwb3J0IHR5cGUgUHJpbWl0aXZlQXR0cmlidXRlS2V5ID0gTmFtZWRBdHRyaWJ1dGUgfCBgJHtOdW1iZXJlZEF0dHJpYnV0ZX1fJHtudW1iZXJ9YCB8IGBfJHtzdHJpbmd9YDtcblxuY29uc3QgZ2VuZXJhdGVUYW5nZW50c0FzeW5jID0gaW1wb3J0KCdtaWtrdHNwYWNlJykudGhlbigobW9kdWxlKSA9PiBtb2R1bGUuZ2VuZXJhdGVUYW5nZW50cyk7XG5cbmZ1bmN0aW9uIHdyYXBJbmRpY2VzKGluZGljZXM6IEdMVEZBY2Nlc3NvclBvc3Rwcm9jZXNzZWQpIHtcbiAgICBzd2l0Y2ggKGluZGljZXMuYnl0ZXNQZXJDb21wb25lbnQpIHtcbiAgICAgICAgY2FzZSAyOiByZXR1cm4ge1xuICAgICAgICAgICAgaW5kZXhBcnJheTogbmV3IFVpbnQxNkFycmF5KGluZGljZXMudmFsdWUuYnVmZmVyKSxcbiAgICAgICAgICAgIGluZGV4Rm9ybWF0OiAndWludDE2JyBhcyBHUFVJbmRleEZvcm1hdCxcbiAgICAgICAgfTtcbiAgICAgICAgY2FzZSA0OiByZXR1cm4ge1xuICAgICAgICAgICAgaW5kZXhBcnJheTogbmV3IFVpbnQzMkFycmF5KGluZGljZXMudmFsdWUuYnVmZmVyKSxcbiAgICAgICAgICAgIGluZGV4Rm9ybWF0OiAndWludDMyJyBhcyBHUFVJbmRleEZvcm1hdCxcbiAgICAgICAgfTtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICBkZWZhdWx0OiByZXR1cm4ge1xuICAgICAgICAgICAgaW5kZXhBcnJheTogbmV3IFVpbnQxNkFycmF5KGluZGljZXMudmFsdWUpLFxuICAgICAgICAgICAgaW5kZXhGb3JtYXQ6ICd1aW50MTYnIGFzIEdQVUluZGV4Rm9ybWF0LFxuICAgICAgICB9O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVpbmRleChpbmRpY2VzOiBHTFRGQWNjZXNzb3JQb3N0cHJvY2Vzc2VkLCBvcmlnaW5hbE1vZGU/OiBudW1iZXIpIHtcbiAgICBzd2l0Y2ggKG9yaWdpbmFsTW9kZSkge1xuICAgICAgICBjYXNlIFRvcG9sb2d5TW9kZS5MaW5lTG9vcDpcbiAgICAgICAgY2FzZSBUb3BvbG9neU1vZGUuTGluZVN0cmlwOlxuICAgICAgICBjYXNlIFRvcG9sb2d5TW9kZS5UcmlhbmdsZUZhbjpcbiAgICAgICAgY2FzZSBUb3BvbG9neU1vZGUuVHJpYW5nbGVTdHJpcDoge1xuICAgICAgICAgICAgLy8gVE9ETzogY29udmVydCBub24tbGlzdCB0b3BvbG9naWVzIGludG8gbGlzdHMuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RvcG9sb2d5IGN1cnJlbnRseSB1bnN1cHBvcnRlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiB7IC4uLndyYXBJbmRpY2VzKGluZGljZXMpLCBtb2RlOiBUb3BvbG9neU1vZGUuVHJpYW5nbGVMaXN0IH07XG4gICAgfVxufVxuXG4vKipcbiAqIENoZWNrcyB0aGUgZGV0ZXJtaW5hbnQgb2YgZWFjaCBnaXZlbiBtYXRyaXggYW5kIHJldHVybnMgYSBjdWxsaW5nIG1vZGUgc3VjaCB0aGF0XG4gKiBhIHByaW1pdGl2ZSB3aWxsIHJlbmRlciBjb3JyZWN0bHkgZm9yIGFsbCBub2RlcyBjb250YWluaW5nIGl0LCB1c2luZyAnbm9uZSdcbiAqIGZvciBwcmltaXRpdmUgd2hpY2ggYXJlIHJlbmRlcmVkIGJvdGggaW52ZXJ0ZWQgYW5kIG5vcm1hbGx5LlxuICpcbiAqIEBwYXJhbSBpbnN0YW5jZU1hdHJpY2VzIHRoZSBpbnN0YW5jZSBtYXRyaWNlcyB0byByZW5kZXIgdGhlIHByaW1pdGl2ZSB3aXRoXG4gKiBAcmV0dXJucyBUaGUgY3VsbCBtb2RlIHRvIHVzZSBvbiB0aGUgcHJpbWl0aXZlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgZ2xGVCBzcGVjIGRldGVybWluZXMgdGhlIHdpbmRpbmcgZGlyZWN0aW9uIG9mIGEgbW9kZWwgYnkgdGhlXG4gKiBkZXRlcm1pbmFudCBvZiB0aGUgdHJhbnNmb3JtIG9mIHRoZSBub2RlIHdoaWNoIHVzZXMgaXQsIGFsbG93aW5nXG4gKiBpbnZlcnNpb24gdGhyb3VnaCBuZWdhdGl2ZSBzY2FsZS4gQ2hhbmdpbmcgY3VsbE1vZGUgaW5zdGVhZFxuICogbW9yZSBlYXNpbHkgaW50ZWdyYXRlcyB3aXRoIGluc3RhbmNlZCByZW5kZXJpbmcsIGFsdGhvdWdoIGNvbWVzXG4gKiBhdCBhIHBlcmZvcm1hbmNlIGNvc3QuXG4gKi9cbmZ1bmN0aW9uIGdldEN1bGxNb2RlKGluc3RhbmNlTWF0cmljZXM6IE1hdDRbXSkge1xuICAgIGxldCBvdmVyYWxsU2lnbjogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnN0YW5jZU1hdHJpY2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IGRldCA9IG1hdDQuZGV0ZXJtaW5hbnQoaW5zdGFuY2VNYXRyaWNlc1tpXSk7XG4gICAgICAgIGNvbnN0IHNpZ24gPSBNYXRoLnNpZ24oZGV0KTtcbiAgICAgICAgb3ZlcmFsbFNpZ24gPz89IHNpZ247XG5cbiAgICAgICAgaWYgKHNpZ24gIT09IG92ZXJhbGxTaWduKSByZXR1cm4gUGlwZWxpbmVGZWF0dXJlRmxhZ3MuRG91YmxlU2lkZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIChvdmVyYWxsU2lnbiA9PSBudWxsIHx8IG92ZXJhbGxTaWduID4gMClcbiAgICAgICAgPyBQaXBlbGluZUZlYXR1cmVGbGFncy5EZWZhdWx0c1xuICAgICAgICA6IFBpcGVsaW5lRmVhdHVyZUZsYWdzLkNsb2Nrd2lzZVdpbmRpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGxvYWRQcmltaXRpdmUoXG4gICAgbGF5b3V0OiBBdHRyaWJ1dGVEZXRhaWxzW10sXG4gICAgcHJpbWl0aXZlOiBHTFRGTWVzaFByaW1pdGl2ZVBvc3Rwcm9jZXNzZWQsXG4gICAgaW5zdGFuY2VzOiBNYXQ0W10sXG4gICAgZGVzY3JpcHRvck1hcDogRGVzY3JpcHRvck1hcCxcbiAgICBkZXZpY2U6IEdQVURldmljZSxcbik6IFByb21pc2U8eyBkcmF3RGF0YT86IFByaW1pdGl2ZURyYXdEYXRhLCBtYXRlcmlhbD86IEdMVEZNYXRlcmlhbFBvc3Rwcm9jZXNzZWQgfT4ge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBwcmltaXRpdmUuYXR0cmlidXRlcyBhcyBQYXJ0aWFsPFJlY29yZDxQcmltaXRpdmVBdHRyaWJ1dGVLZXksIEdMVEZBY2Nlc3NvclBvc3Rwcm9jZXNzZWQ+PjtcbiAgICBpZiAoYXR0cmlidXRlcy5QT1NJVElPTiA9PSBudWxsKSByZXR1cm4ge307XG5cbiAgICBjb25zdCB7IGluZGljZXMgfSA9IHByaW1pdGl2ZTtcbiAgICBjb25zdCBhdHJzID0gbWFwVmFsdWVzKGF0dHJpYnV0ZXMsIChhdHIpID0+IG5ldyBBdHRyaWJ1dGVXcmFwcGVyKGF0ciBhcyBHTFRGQWNjZXNzb3JQb3N0cHJvY2Vzc2VkKSk7XG4gICAgbGV0IHsgbW9kZSB9ID0gcHJpbWl0aXZlO1xuICAgIGxldCB2ZXJ0ZXhDb3VudCA9IGF0dHJpYnV0ZXMuUE9TSVRJT04uY291bnQ7XG4gICAgbGV0IGluZGV4QXJyYXk6IFR5cGVkQXJyYXkgfCB1bmRlZmluZWQ7XG4gICAgbGV0IGluZGV4Rm9ybWF0OiBHUFVJbmRleEZvcm1hdCB8IHVuZGVmaW5lZDtcblxuICAgIGlmIChpbmRpY2VzICE9IG51bGwpIHtcbiAgICAgICAgKHsgaW5kZXhBcnJheSwgaW5kZXhGb3JtYXQgfSA9IHdyYXBJbmRpY2VzKGluZGljZXMpKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBtb2RlICE9PSBUb3BvbG9neU1vZGUuUG9pbnRzXG4gICAgICAgICAgICAmJiBtb2RlICE9PSBUb3BvbG9neU1vZGUuTGluZUxpc3RcbiAgICAgICAgICAgICYmIG1vZGUgIT09IFRvcG9sb2d5TW9kZS5UcmlhbmdsZUxpc3RcbiAgICAgICAgKSB7XG4gICAgICAgICAgICAoeyBpbmRleEFycmF5LCBpbmRleEZvcm1hdCwgbW9kZSB9ID0gcmVpbmRleChpbmRpY2VzLCBtb2RlKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoYXRycy5OT1JNQUwgIT0gbnVsbCAmJiBhdHJzLlRBTkdFTlQgPT0gbnVsbCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LWNvbmRpdGlvblxuICAgICAgICBpZiAoYXRycy5URVhDT09SRF8wICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChpbmRleEFycmF5ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2ZXJ0ZXhDb3VudCA9IGluZGV4QXJyYXkubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYXRyIG9mIE9iamVjdC52YWx1ZXMoYXRycykpIHtcbiAgICAgICAgICAgICAgICAgICAgYXRyLnVud2VsZChpbmRleEFycmF5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcblxuICAgICAgICAgICAgY29uc3QgdGFuZ2VudCA9IGF3YWl0IGdlbmVyYXRlVGFuZ2VudHNBc3luYy50aGVuKChmdW5jKSA9PiBmdW5jKFxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAgICAgYXRycy5QT1NJVElPTiEuYXJyYXksXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICAgICBhdHJzLk5PUk1BTCEuYXJyYXksXG4gICAgICAgICAgICAgICAgYXRycy5URVhDT09SRF8wLmFycmF5LFxuICAgICAgICAgICAgKSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAzOyBpIDwgdGFuZ2VudC5sZW5ndGg7IGkgKz0gNCkge1xuICAgICAgICAgICAgICAgIHRhbmdlbnRbaV0gKj0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgdGFuZ2VudHMgZ2VuZXJhdGVkIGluICR7RGF0ZS5ub3coKSAtIHN0YXJ0fWApO1xuXG4gICAgICAgICAgICBhdHJzLlRBTkdFTlQgPSBuZXcgQXR0cmlidXRlV3JhcHBlcih0YW5nZW50LCA0KTtcblxuICAgICAgICAgICAgKHsgaW5kZXhBcnJheSwgaW5kZXhGb3JtYXQsIHZlcnRleENvdW50IH0gPSB3ZWxkKGF0cnMpKTtcbiAgICAgICAgICAgIG1vZGUgPSBUb3BvbG9neU1vZGUuVHJpYW5nbGVMaXN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGFuZ2VudCA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGV4Q291bnQgKiA0KTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydGV4Q291bnQ7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIHRhbmdlbnQuc2V0KFsxLCAwLCAwLCAxXSwgaSAqIDQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXRycy5UQU5HRU5UID0gbmV3IEF0dHJpYnV0ZVdyYXBwZXIodGFuZ2VudCwgNCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB7IHZlcnRleEFycmF5LCB2ZXJ0ZXhGZWF0dXJlcyB9ID0gaW50ZXJsZWF2ZVZlcnRpY2VzKGF0cnMsIHZlcnRleENvdW50KTtcbiAgICBsZXQgZmVhdHVyZXMgPSBnZXRDdWxsTW9kZShpbnN0YW5jZXMpIHwgdmVydGV4RmVhdHVyZXM7XG4gICAgaWYgKG1vZGUgIT0gbnVsbCkgZmVhdHVyZXMgfD0gbW9kZVRvVG9wb2xvZ3lbbW9kZSBhcyBUb3BvbG9neU1vZGVdIHx8IDA7XG5cbiAgICBjb25zdCBkcmF3RGF0YSA9IG5ldyBQcmltaXRpdmVEcmF3RGF0YSh7XG4gICAgICAgIGZlYXR1cmVzLFxuICAgICAgICBpbmRleEFycmF5LFxuICAgICAgICBpbmRleEZvcm1hdCxcbiAgICAgICAgdmVydGV4Q291bnQsXG4gICAgICAgIHZlcnRleEFycmF5LFxuICAgIH0sIGRldmljZSwgaW5zdGFuY2VzLmxlbmd0aCwgZGVzY3JpcHRvck1hcCwgaW5zdGFuY2VzKTtcblxuICAgIHJldHVybiB7IG1hdGVyaWFsOiBwcmltaXRpdmUubWF0ZXJpYWwsIGRyYXdEYXRhIH07XG59XG4iLCJpbXBvcnQgeyBHTFRGTWF0ZXJpYWxQb3N0cHJvY2Vzc2VkLCBHTFRGU2FtcGxlciwgR0xURlRleHR1cmVQb3N0cHJvY2Vzc2VkIH0gZnJvbSAnQGxvYWRlcnMuZ2wvZ2x0Zic7XG5cbmltcG9ydCB7IHZlYzMgfSBmcm9tICd3Z3B1LW1hdHJpeCc7XG5pbXBvcnQgeyBNYXRlcmlhbERlc2NyaXB0b3IgfSBmcm9tICcuLi8uLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvbWF0ZXJpYWwtZHJhdy1kYXRhJztcbmltcG9ydCB7IGltYWdlVG9UZXh0dXJlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdGV4dHVyZS1pbXBvcnRpbmcnO1xuXG5jb25zdCBERUZBVUxUX01FVEFMTElDID0gMC4wO1xuY29uc3QgREVGQVVMVF9ST1VHSE5FU1MgPSAxLjA7XG5cbmNvbnN0IGdsdGZUb01hZ0Rlc2NyaXB0aW9uOiBSZWNvcmQ8bnVtYmVyLCBHUFVGaWx0ZXJNb2RlPiA9IHtcbiAgICA5NzI4OiAnbmVhcmVzdCcsXG4gICAgOTcyOTogJ2xpbmVhcicsXG4gICAgOTk4NDogJ25lYXJlc3QnLCAvLyBORUFSRVNUX01JUE1BUF9ORUFSRVNUXG4gICAgOTk4NTogJ2xpbmVhcicsIC8vIExJTkVBUl9NSVBNQVBfTkVBUkVTVFxuICAgIDk5ODY6ICduZWFyZXN0JywgLy8gTkVBUkVTVF9NSVBNQVBfTElORUFSXG4gICAgOTk4NzogJ2xpbmVhcicsIC8vIExJTkVBUl9NSVBNQVBfTElORUFSXG59O1xuXG5jb25zdCBnbHRmVG9NaXBEZXNjcmlwdGlvbjogUGFydGlhbDxSZWNvcmQ8bnVtYmVyLCBHUFVGaWx0ZXJNb2RlPj4gPSB7XG4gICAgOTk4NDogJ25lYXJlc3QnLCAvLyBORUFSRVNUX01JUE1BUF9ORUFSRVNUXG4gICAgOTk4NTogJ25lYXJlc3QnLCAvLyBMSU5FQVJfTUlQTUFQX05FQVJFU1RcbiAgICA5OTg2OiAnbGluZWFyJywgLy8gTkVBUkVTVF9NSVBNQVBfTElORUFSXG4gICAgOTk4NzogJ2xpbmVhcicsIC8vIExJTkVBUl9NSVBNQVBfTElORUFSXG59O1xuXG5jb25zdCBnbHRmVG9BZGRyZXNzTW9kZTogUmVjb3JkPG51bWJlciwgR1BVQWRkcmVzc01vZGU+ID0ge1xuICAgIDMzMDcxOiAnY2xhbXAtdG8tZWRnZScsIC8vIENMQU1QX1RPX0VER0VcbiAgICAzMzY0ODogJ21pcnJvci1yZXBlYXQnLCAvLyBNSVJST1JFRF9SRVBFQVRcbiAgICAxMDQ5NzogJ3JlcGVhdCcsIC8vIFJFUEVBVFxufTtcblxuZnVuY3Rpb24gdG9TYW1wbGVyRGVzY3JpcHRpb24oc2FtcGxlcjogR0xURlNhbXBsZXIpOiBHUFVTYW1wbGVyRGVzY3JpcHRvciB7XG4gICAgY29uc3QgeyBtYWdGaWx0ZXIsIG1pbkZpbHRlciwgd3JhcFMsIHdyYXBUIH0gPSBzYW1wbGVyO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkcmVzc01vZGVVOiBnbHRmVG9BZGRyZXNzTW9kZVt3cmFwUyA/PyAxMDQ5N10sXG4gICAgICAgIGFkZHJlc3NNb2RlVjogZ2x0ZlRvQWRkcmVzc01vZGVbd3JhcFQgPz8gMTA0OTddLFxuICAgICAgICBtaW5GaWx0ZXI6IGdsdGZUb01hZ0Rlc2NyaXB0aW9uW21pbkZpbHRlciA/PyA5OTg3XSxcbiAgICAgICAgbWFnRmlsdGVyOiBnbHRmVG9NYWdEZXNjcmlwdGlvblttYWdGaWx0ZXIgPz8gOTcyOV0sXG4gICAgICAgIG1pcG1hcEZpbHRlcjogZ2x0ZlRvTWlwRGVzY3JpcHRpb25bbWluRmlsdGVyID8/IDk5ODddID8/ICdsaW5lYXInLFxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldEltYWdlRGF0YShoYW5kbGU6IEdMVEZUZXh0dXJlUG9zdHByb2Nlc3NlZCkge1xuICAgIGNvbnN0IHsgc291cmNlLCBzYW1wbGVyIH0gPSBoYW5kbGU7XG4gICAgaWYgKHNvdXJjZSA9PSBudWxsKSByZXR1cm4ge307XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LWNvbmRpdGlvblxuICAgIGNvbnN0IGRhdGEgPSBzb3VyY2UuaW1hZ2UuZGF0YSA/PyBzb3VyY2UuYnVmZmVyVmlldz8uZGF0YTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LWNvbmRpdGlvblxuICAgIGlmIChkYXRhID09IG51bGwpIHJldHVybiB7fTtcblxuICAgIHJldHVybiB7IGRhdGEsIG1pbWVUeXBlOiBzb3VyY2UubWltZVR5cGUsIHNhbXBsZXIgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gbG9hZE1hdGVyaWFsKFxuICAgIG1hdGVyaWFsOiBHTFRGTWF0ZXJpYWxQb3N0cHJvY2Vzc2VkLFxuICAgIGRlZmF1bHRNYXRlcmlhbDogTWF0ZXJpYWxEZXNjcmlwdG9yLFxuICAgIGRldmljZTogR1BVRGV2aWNlLFxuKTogUHJvbWlzZTxNYXRlcmlhbERlc2NyaXB0b3I+IHtcbiAgICBjb25zdCBtYXQ6IFBhcnRpYWw8TWF0ZXJpYWxEZXNjcmlwdG9yPiA9IHt9O1xuICAgIGlmIChtYXRlcmlhbC5wYnJNZXRhbGxpY1JvdWdobmVzcyAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGJhc2VDb2xvckZhY3RvcixcbiAgICAgICAgICAgIGJhc2VDb2xvclRleHR1cmUsXG4gICAgICAgICAgICBtZXRhbGxpY0ZhY3RvcixcbiAgICAgICAgICAgIG1ldGFsbGljUm91Z2huZXNzVGV4dHVyZSxcbiAgICAgICAgICAgIHJvdWdobmVzc0ZhY3RvcixcbiAgICAgICAgfSA9IG1hdGVyaWFsLnBick1ldGFsbGljUm91Z2huZXNzO1xuXG4gICAgICAgIGlmIChtZXRhbGxpY1JvdWdobmVzc1RleHR1cmU/LnRleHR1cmUuc291cmNlID09IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChtZXRhbGxpY0ZhY3RvciA9PSBudWxsKSBtYXQubWV0YWxsaWNGYWN0b3IgPSBERUZBVUxUX01FVEFMTElDO1xuICAgICAgICAgICAgaWYgKHJvdWdobmVzc0ZhY3RvciA9PSBudWxsKSBtYXQucm91Z2huZXNzRmFjdG9yID0gREVGQVVMVF9ST1VHSE5FU1M7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGEsIG1pbWVUeXBlLCBzYW1wbGVyIH0gPSBnZXRJbWFnZURhdGEobWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlLnRleHR1cmUpO1xuICAgICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1hdC5tZXRhbGxpY1JvdWdobmVzc1RleHR1cmUgPSBhd2FpdCBpbWFnZVRvVGV4dHVyZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBgJHttYXRlcmlhbC5pZH0gbXIgdGV4dHVyZWAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlLFxuICAgICAgICAgICAgICAgICAgICB1c2FnZTogR1BVVGV4dHVyZVVzYWdlLlRFWFRVUkVfQklORElORyxcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChzYW1wbGVyKSBtYXQubWV0YWxsaWNSb3VnaG5lc3NTYW1wbGVyID0gdG9TYW1wbGVyRGVzY3JpcHRpb24oc2FtcGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYmFzZUNvbG9yVGV4dHVyZT8udGV4dHVyZS5zb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgeyBkYXRhLCBtaW1lVHlwZSwgc2FtcGxlciB9ID0gZ2V0SW1hZ2VEYXRhKGJhc2VDb2xvclRleHR1cmUudGV4dHVyZSk7XG4gICAgICAgICAgICBpZiAoZGF0YSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbWF0LmJhc2VDb2xvclRleHR1cmUgPSBhd2FpdCBpbWFnZVRvVGV4dHVyZSh7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBgJHttYXRlcmlhbC5pZH0gbXIgdGV4dHVyZWAsXG4gICAgICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlLFxuICAgICAgICAgICAgICAgICAgICB1c2FnZTogR1BVVGV4dHVyZVVzYWdlLlRFWFRVUkVfQklORElORyxcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlLFxuICAgICAgICAgICAgICAgICAgICBzcmdiVG9MaW5lYXI6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNhbXBsZXIpIG1hdC5iYXNlQ29sb3JTYW1wbGVyID0gdG9TYW1wbGVyRGVzY3JpcHRpb24oc2FtcGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYmFzZUNvbG9yRmFjdG9yICE9IG51bGwpIG1hdC5iYXNlQ29sb3JGYWN0b3IgPSBiYXNlQ29sb3JGYWN0b3I7XG4gICAgICAgIGlmIChtZXRhbGxpY0ZhY3RvciAhPSBudWxsKSBtYXQubWV0YWxsaWNGYWN0b3IgPSBtZXRhbGxpY0ZhY3RvcjtcbiAgICAgICAgaWYgKHJvdWdobmVzc0ZhY3RvciAhPSBudWxsKSBtYXQubWV0YWxsaWNGYWN0b3IgPSByb3VnaG5lc3NGYWN0b3I7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbWF0Lm1ldGFsbGljRmFjdG9yID0gREVGQVVMVF9NRVRBTExJQztcbiAgICAgICAgbWF0LnJvdWdobmVzc0ZhY3RvciA9IERFRkFVTFRfUk9VR0hORVNTO1xuICAgIH1cblxuICAgIGlmIChtYXRlcmlhbC5ub3JtYWxUZXh0dXJlPy50ZXh0dXJlLnNvdXJjZSAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSwgbWltZVR5cGUsIHNhbXBsZXIgfSA9IGdldEltYWdlRGF0YShtYXRlcmlhbC5ub3JtYWxUZXh0dXJlLnRleHR1cmUpO1xuXG4gICAgICAgIGlmIChkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgIG1hdC5ub3JtYWxUZXh0dXJlID0gYXdhaXQgaW1hZ2VUb1RleHR1cmUoe1xuICAgICAgICAgICAgICAgIGxhYmVsOiBgJHttYXRlcmlhbC5pZH0gbXIgdGV4dHVyZWAsXG4gICAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgICBtaW1lVHlwZSxcbiAgICAgICAgICAgICAgICB1c2FnZTogR1BVVGV4dHVyZVVzYWdlLlRFWFRVUkVfQklORElORyxcbiAgICAgICAgICAgICAgICBkZXZpY2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzYW1wbGVyKSBtYXQubm9ybWFsU2FtcGxlciA9IHRvU2FtcGxlckRlc2NyaXB0aW9uKHNhbXBsZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgeyBlbWlzc2l2ZUZhY3RvciwgZW1pc3NpdmVUZXh0dXJlIH0gPSBtYXRlcmlhbDtcblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnQsIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgIGNvbnN0IGVtaXNzaXZlU3RyZW5ndGggPSBtYXRlcmlhbC5leHRlbnNpb25zPy5LSFJfbWF0ZXJpYWxzX2VtaXNzaXZlX3N0cmVuZ3RoPy5lbWlzc2l2ZVN0cmVuZ3RoO1xuXG4gICAgaWYgKGVtaXNzaXZlVGV4dHVyZSAhPSBudWxsIHx8IGVtaXNzaXZlRmFjdG9yPy5zb21lKCh4KSA9PiB4ID4gMCkpIHtcbiAgICAgICAgbWF0LmVtaXNzaXZlRmFjdG9yID0gZW1pc3NpdmVGYWN0b3IgPz8gWzEsIDEsIDFdO1xuICAgICAgICBtYXQuZW1pc3NpdmVTYW1wbGVyID0geyBtYWdGaWx0ZXI6ICdsaW5lYXInLCBtaW5GaWx0ZXI6ICdsaW5lYXInIH07XG5cbiAgICAgICAgaWYgKGVtaXNzaXZlVGV4dHVyZT8udGV4dHVyZS5zb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgeyBkYXRhLCBtaW1lVHlwZSwgc2FtcGxlciB9ID0gZ2V0SW1hZ2VEYXRhKGVtaXNzaXZlVGV4dHVyZS50ZXh0dXJlKTtcbiAgICAgICAgICAgIGlmIChkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBtYXQuZW1pc3NpdmVUZXh0dXJlID0gYXdhaXQgaW1hZ2VUb1RleHR1cmUoe1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogYCR7bWF0ZXJpYWwuaWR9IG1yIHRleHR1cmVgLFxuICAgICAgICAgICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgdXNhZ2U6IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcsXG4gICAgICAgICAgICAgICAgICAgIGRldmljZSxcbiAgICAgICAgICAgICAgICAgICAgc3JnYlRvTGluZWFyOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChzYW1wbGVyKSBtYXQuZW1pc3NpdmVTYW1wbGVyID0gdG9TYW1wbGVyRGVzY3JpcHRpb24oc2FtcGxlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXQuZW1pc3NpdmVUZXh0dXJlID0gZGVmYXVsdE1hdGVyaWFsLmJhc2VDb2xvclRleHR1cmU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW1pc3NpdmVTdHJlbmd0aCAhPSBudWxsICYmIHR5cGVvZiBlbWlzc2l2ZVN0cmVuZ3RoID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdmVjMy5zY2FsZShtYXQuZW1pc3NpdmVGYWN0b3IsIGVtaXNzaXZlU3RyZW5ndGgsIG1hdC5lbWlzc2l2ZUZhY3Rvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWF0ZXJpYWwuZG91YmxlU2lkZWQpIG1hdC5kb3VibGVTaWRlZCA9IHRydWU7XG4gICAgaWYgKG1hdGVyaWFsLmFscGhhTW9kZSA9PT0gJ01BU0snKSBtYXQuYWxwaGFDdXRvZmYgPSBtYXRlcmlhbC5hbHBoYUN1dG9mZiA/PyAwLjU7XG5cbiAgICByZXR1cm4geyAuLi5kZWZhdWx0TWF0ZXJpYWwsIC4uLm1hdCB9O1xufVxuIiwiaW1wb3J0IHsgVmVjM24sIFZlYzRuIH0gZnJvbSAnd2dwdS1tYXRyaXgnO1xuaW1wb3J0IERlc2NyaXB0b3JNYXAgZnJvbSAnLi9kZXNjcmlwdG9yLW1hcCc7XG5pbXBvcnQgeyBmZWF0dXJlRmxhZ3NUb1N0cmluZywgUGlwZWxpbmVGZWF0dXJlRmxhZ3MgfSBmcm9tICcuL3BpcGVsaW5lLWZlYXR1cmUtZmxhZ3MnO1xuaW1wb3J0IHsgUHJpbWl0aXZlRHJhd0RhdGEgfSBmcm9tICcuL3ByaW1pdGl2ZS1kcmF3LWRhdGEnO1xuaW1wb3J0IHsgY3JlYXRlQW5kQ29weUJ1ZmZlciB9IGZyb20gJy4uLy4uL3V0aWxzL2RhdGEtY29weSc7XG5cbmV4cG9ydCB0eXBlIE1hdGVyaWFsRGVzY3JpcHRvciA9IHtcbiAgICBuYW1lPzogc3RyaW5nLFxuXG4gICAgYmFzZUNvbG9yRmFjdG9yOiBWZWM0bixcbiAgICBiYXNlQ29sb3JUZXh0dXJlOiBHUFVUZXh0dXJlLFxuICAgIGJhc2VDb2xvclNhbXBsZXI6IEdQVVNhbXBsZXJEZXNjcmlwdG9yLFxuXG4gICAgcm91Z2huZXNzRmFjdG9yOiBudW1iZXIsXG4gICAgbWV0YWxsaWNGYWN0b3I6IG51bWJlcixcbiAgICBtZXRhbGxpY1JvdWdobmVzc1RleHR1cmU6IEdQVVRleHR1cmUsXG4gICAgbWV0YWxsaWNSb3VnaG5lc3NTYW1wbGVyOiBHUFVTYW1wbGVyRGVzY3JpcHRvcixcblxuICAgIG5vcm1hbFRleHR1cmU6IEdQVVRleHR1cmUsXG4gICAgbm9ybWFsU2FtcGxlcjogR1BVU2FtcGxlckRlc2NyaXB0b3IsXG5cbiAgICBhbHBoYUN1dG9mZj86IG51bWJlcixcblxuICAgIGVtaXNzaXZlRmFjdG9yPzogVmVjM24sXG4gICAgZW1pc3NpdmVUZXh0dXJlPzogR1BVVGV4dHVyZSxcbiAgICBlbWlzc2l2ZVNhbXBsZXI/OiBHUFVTYW1wbGVyRGVzY3JpcHRvcixcblxuICAgIGRvdWJsZVNpZGVkPzogYm9vbGVhbixcbn07XG5cbmV4cG9ydCBjbGFzcyBNYXRlcmlhbERyYXdEYXRhIHtcbiAgICBsYXlvdXQ6IEdQVUJpbmRHcm91cExheW91dDtcbiAgICBwcmltaXRpdmVzOiBQcmltaXRpdmVEcmF3RGF0YVtdID0gW107XG4gICAgbWF0RGF0YTogTWF0ZXJpYWxEZXNjcmlwdG9yO1xuICAgIGJpbmRHcm91cDogR1BVQmluZEdyb3VwO1xuICAgIHByb3BlcnRpZXNCdWZmZXI6IEdQVUJ1ZmZlcjtcbiAgICBmZWF0dXJlczogUGlwZWxpbmVGZWF0dXJlRmxhZ3M7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgZGF0YTogTWF0ZXJpYWxEZXNjcmlwdG9yLFxuICAgICAgICBkZXZpY2U6IEdQVURldmljZSxcbiAgICAgICAgZGVzY3JpcHRvck1hcDogRGVzY3JpcHRvck1hcCxcbiAgICAgICAgcHJpbWl0aXZlRmVhdHVyZXM6IFBpcGVsaW5lRmVhdHVyZUZsYWdzLFxuICAgICAgICBwcmltaXRpdmVzPzogUHJpbWl0aXZlRHJhd0RhdGFbXSxcbiAgICApIHtcbiAgICAgICAgdGhpcy5mZWF0dXJlcyA9IHByaW1pdGl2ZUZlYXR1cmVzO1xuICAgICAgICBpZiAoZGF0YS5kb3VibGVTaWRlZCkgdGhpcy5mZWF0dXJlcyB8PSBQaXBlbGluZUZlYXR1cmVGbGFncy5Eb3VibGVTaWRlZDtcblxuICAgICAgICAvLyBUT0RPIDogZG9uJ3QgaGFyZGNvZGUgdGhlIHByb3BlcnRpZXMgZmVhdHVyZXNcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBGbG9hdDMyQXJyYXkoMTIpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldChkYXRhLmJhc2VDb2xvckZhY3Rvcik7XG4gICAgICAgIHByb3BlcnRpZXNbNF0gPSBkYXRhLm1ldGFsbGljRmFjdG9yO1xuICAgICAgICBwcm9wZXJ0aWVzWzVdID0gZGF0YS5yb3VnaG5lc3NGYWN0b3I7XG5cbiAgICAgICAgaWYgKGRhdGEuYWxwaGFDdXRvZmYgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5mZWF0dXJlcyB8PSBQaXBlbGluZUZlYXR1cmVGbGFncy5BbHBoYUN1dG9mZjtcbiAgICAgICAgICAgIHByb3BlcnRpZXNbNl0gPSBkYXRhLmFscGhhQ3V0b2ZmO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuZW1pc3NpdmVGYWN0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5zZXQoZGF0YS5lbWlzc2l2ZUZhY3RvciwgOCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb3BlcnRpZXNCdWZmZXIgPSBjcmVhdGVBbmRDb3B5QnVmZmVyKFxuICAgICAgICAgICAgcHJvcGVydGllcyxcbiAgICAgICAgICAgIEdQVUJ1ZmZlclVzYWdlLlVOSUZPUk0sXG4gICAgICAgICAgICBkZXZpY2UsXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZW50cmllcyA9IFtcbiAgICAgICAgICAgIHsgYmluZGluZzogMCwgcmVzb3VyY2U6IHsgYnVmZmVyOiB0aGlzLnByb3BlcnRpZXNCdWZmZXIgfSB9LFxuICAgICAgICAgICAgeyBiaW5kaW5nOiAxLCByZXNvdXJjZTogZGVzY3JpcHRvck1hcC5nZXRTYW1wbGVyKGRhdGEuYmFzZUNvbG9yU2FtcGxlcikgfSxcbiAgICAgICAgICAgIHsgYmluZGluZzogMiwgcmVzb3VyY2U6IGRhdGEuYmFzZUNvbG9yVGV4dHVyZS5jcmVhdGVWaWV3KHsgZGltZW5zaW9uOiAnMmQnIH0pIH0sXG4gICAgICAgICAgICB7IGJpbmRpbmc6IDMsIHJlc291cmNlOiBkZXNjcmlwdG9yTWFwLmdldFNhbXBsZXIoZGF0YS5ub3JtYWxTYW1wbGVyKSB9LFxuICAgICAgICAgICAgeyBiaW5kaW5nOiA0LCByZXNvdXJjZTogZGF0YS5ub3JtYWxUZXh0dXJlLmNyZWF0ZVZpZXcoeyBkaW1lbnNpb246ICcyZCcgfSkgfSxcbiAgICAgICAgICAgIHsgYmluZGluZzogNSwgcmVzb3VyY2U6IGRlc2NyaXB0b3JNYXAuZ2V0U2FtcGxlcihkYXRhLm1ldGFsbGljUm91Z2huZXNzU2FtcGxlcikgfSxcbiAgICAgICAgICAgIHsgYmluZGluZzogNiwgcmVzb3VyY2U6IGRhdGEubWV0YWxsaWNSb3VnaG5lc3NUZXh0dXJlLmNyZWF0ZVZpZXcoeyBkaW1lbnNpb246ICcyZCcgfSkgfSxcbiAgICAgICAgXTtcblxuICAgICAgICBpZiAoZGF0YS5lbWlzc2l2ZVRleHR1cmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5mZWF0dXJlcyB8PSBQaXBlbGluZUZlYXR1cmVGbGFncy5FbWlzc2l2ZTtcblxuICAgICAgICAgICAgZW50cmllcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiA3LFxuICAgICAgICAgICAgICAgIHJlc291cmNlOiBkZXNjcmlwdG9yTWFwLmdldFNhbXBsZXIoZGF0YS5lbWlzc2l2ZVNhbXBsZXIgPz8ge30pLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVudHJpZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgYmluZGluZzogOCxcbiAgICAgICAgICAgICAgICByZXNvdXJjZTogZGF0YS5lbWlzc2l2ZVRleHR1cmUuY3JlYXRlVmlldyh7IGRpbWVuc2lvbjogJzJkJyB9KSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sYXlvdXQgPSBkZXNjcmlwdG9yTWFwLmdldE1hdGVyaWFsQmluZEdyb3VwKHRoaXMuZmVhdHVyZXMpO1xuICAgICAgICB0aGlzLm1hdERhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLmJpbmRHcm91cCA9IGRldmljZS5jcmVhdGVCaW5kR3JvdXAoe1xuICAgICAgICAgICAgbGFiZWw6IGZlYXR1cmVGbGFnc1RvU3RyaW5nKHRoaXMuZmVhdHVyZXMpLFxuICAgICAgICAgICAgbGF5b3V0OiB0aGlzLmxheW91dCxcbiAgICAgICAgICAgIGVudHJpZXMsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChwcmltaXRpdmVzICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkUHJpbWl0aXZlcyguLi5wcmltaXRpdmVzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRyYXcocGFzc0VuY29kZXI6IEdQVVJlbmRlclBhc3NFbmNvZGVyLCBxdWV1ZTogR1BVUXVldWUpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpbWl0aXZlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgICAgICBwYXNzRW5jb2Rlci5zZXRCaW5kR3JvdXAoMSwgdGhpcy5iaW5kR3JvdXApO1xuICAgICAgICBmb3IgKGNvbnN0IHByaW1pdGl2ZSBvZiB0aGlzLnByaW1pdGl2ZXMpIHtcbiAgICAgICAgICAgIHByaW1pdGl2ZS5kcmF3KHBhc3NFbmNvZGVyLCBxdWV1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRQcmltaXRpdmVzKC4uLmRyYXdEYXRhOiBQcmltaXRpdmVEcmF3RGF0YVtdKSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gZHJhd0RhdGEuZmlsdGVyKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBpZiAoKGRhdGEuZmVhdHVyZXMgJiB0aGlzLmZlYXR1cmVzKSA9PT0gZGF0YS5mZWF0dXJlcykgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYGludmFsaWQgcHJpbWl0aXZlIGFkZGVkIHRvIG1hdGVyaWFsOiBcbnByaW1pdGl2ZTogJHtkYXRhLm5hbWV9XG5wcmltaXRpdmUgZmVhdHVyZXM6ICR7ZmVhdHVyZUZsYWdzVG9TdHJpbmcoZGF0YS5mZWF0dXJlcykudG9TdHJpbmcoKX1cbm1hdGVyaWFsOiAke3RoaXMubWF0RGF0YS5uYW1lfVxubWF0ZXJpYWwgZmVhdHVyZXM6ICR7ZmVhdHVyZUZsYWdzVG9TdHJpbmcodGhpcy5mZWF0dXJlcykudG9TdHJpbmcoKX1gKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucHJpbWl0aXZlcy5wdXNoKC4uLmZpbHRlcmVkKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgRGVzY3JpcHRvck1hcCBmcm9tICcuL2Rlc2NyaXB0b3ItbWFwJztcbmltcG9ydCB7IE1hdGVyaWFsRHJhd0RhdGEgfSBmcm9tICcuL21hdGVyaWFsLWRyYXctZGF0YSc7XG5pbXBvcnQgeyBQaXBlbGluZUZlYXR1cmVGbGFncywgZmVhdHVyZUZsYWdzVG9TdHJpbmcsIG1hc2tSZWR1bmRhbnRGZWF0dXJlcyB9IGZyb20gJy4vcGlwZWxpbmUtZmVhdHVyZS1mbGFncyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdlb21ldHJ5UGlwZWxpbmUge1xuICAgIGZlYXR1cmVzOiBQaXBlbGluZUZlYXR1cmVGbGFncztcbiAgICBwaXBlbGluZTogR1BVUmVuZGVyUGlwZWxpbmU7XG5cbiAgICBtYXRlcmlhbHM6IE1hdGVyaWFsRHJhd0RhdGFbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoZmVhdHVyZXM6IFBpcGVsaW5lRmVhdHVyZUZsYWdzLCBtYXBzOiBEZXNjcmlwdG9yTWFwKSB7XG4gICAgICAgIHRoaXMuZmVhdHVyZXMgPSBtYXNrUmVkdW5kYW50RmVhdHVyZXMoZmVhdHVyZXMpO1xuXG4gICAgICAgIGNvbnN0IG1vZHVsZSA9IG1hcHMuZ2V0U2hhZGVyTW9kdWxlKGZlYXR1cmVzKTtcblxuICAgICAgICB0aGlzLnBpcGVsaW5lID0gbWFwcy5kZXZpY2UuY3JlYXRlUmVuZGVyUGlwZWxpbmUoe1xuICAgICAgICAgICAgbGFiZWw6IGZlYXR1cmVGbGFnc1RvU3RyaW5nKGZlYXR1cmVzKSxcbiAgICAgICAgICAgIGxheW91dDogbWFwcy5nZXRGb3J3YXJkUGlwZWxpbmVMYXlvdXQoZmVhdHVyZXMpLFxuICAgICAgICAgICAgcHJpbWl0aXZlOiBtYXBzLmdldFByaW1pdGl2ZVN0YXRlKGZlYXR1cmVzKSxcbiAgICAgICAgICAgIHZlcnRleDoge1xuICAgICAgICAgICAgICAgIGVudHJ5UG9pbnQ6ICd2cycsXG4gICAgICAgICAgICAgICAgYnVmZmVyczogW21hcHMuZ2V0VmVydGV4TGF5b3V0KGZlYXR1cmVzKV0sXG4gICAgICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZyYWdtZW50OiB7XG4gICAgICAgICAgICAgICAgZW50cnlQb2ludDogJ2ZzJyxcbiAgICAgICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICAgICAgdGFyZ2V0czogbWFwcy5nYnVmZmVyLnRhcmdldHMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVwdGhTdGVuY2lsOiB7XG4gICAgICAgICAgICAgICAgZGVwdGhXcml0ZUVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgZGVwdGhDb21wYXJlOiAnbGVzcy1lcXVhbCcsXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBtYXBzLmdidWZmZXIuZGVwdGguZm9ybWF0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkTWF0ZXJpYWxzKC4uLm1hdGVyaWFsczogTWF0ZXJpYWxEcmF3RGF0YVtdKSB7XG4gICAgICAgIGlmIChtYXRlcmlhbHMuc29tZSgoZGF0YSkgPT4gZGF0YS5mZWF0dXJlcyAhPT0gdGhpcy5mZWF0dXJlcykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBwcmltaXRpdmUgYWRkZWQgdG8gbWF0ZXJpYWwnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1hdGVyaWFscy5wdXNoKC4uLm1hdGVyaWFscyk7XG4gICAgfVxuXG4gICAgZHJhdyhwYXNzRW5jb2RlcjogR1BVUmVuZGVyUGFzc0VuY29kZXIsIHF1ZXVlOiBHUFVRdWV1ZSkge1xuICAgICAgICBwYXNzRW5jb2Rlci5zZXRQaXBlbGluZSh0aGlzLnBpcGVsaW5lKTtcbiAgICAgICAgZm9yIChjb25zdCBtYXQgb2YgdGhpcy5tYXRlcmlhbHMpIHtcbiAgICAgICAgICAgIG1hdC5kcmF3KHBhc3NFbmNvZGVyLCBxdWV1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNYXQ0LCBtYXQ0LCBNYXQ0QXJnLCBNYXQ0VHlwZSwgcXVhdCB9IGZyb20gJ3dncHUtbWF0cml4JztcbmltcG9ydCB7IERhdGFUeXBlLCBsb2FkIH0gZnJvbSAnQGxvYWRlcnMuZ2wvY29yZSc7XG5pbXBvcnQgeyBHTFRGTG9hZGVyLCBHTFRGTWVzaFBvc3Rwcm9jZXNzZWQsIEdMVEZOb2RlUG9zdHByb2Nlc3NlZCwgcG9zdFByb2Nlc3NHTFRGIH0gZnJvbSAnQGxvYWRlcnMuZ2wvZ2x0Zic7XG5cbmltcG9ydCB7IENvbXBvbmVudFR5cGUsIEF0dHJpYnV0ZURldGFpbHMgfSBmcm9tICcuL3R5cGUtY29udmVyc2lvbnMnO1xuaW1wb3J0IGxvYWRQcmltaXRpdmUgZnJvbSAnLi9wcmltaXRpdmUtbG9hZGVyJztcbmltcG9ydCBsb2FkTWF0ZXJpYWwgZnJvbSAnLi9tYXRlcmlhbC1sb2FkZXInO1xuXG5pbXBvcnQgeyBNYXRlcmlhbERlc2NyaXB0b3IsIE1hdGVyaWFsRHJhd0RhdGEgfSBmcm9tICcuLi8uLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvbWF0ZXJpYWwtZHJhdy1kYXRhJztcbmltcG9ydCB7IFBpcGVsaW5lRmVhdHVyZUZsYWdzIH0gZnJvbSAnLi4vLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL3BpcGVsaW5lLWZlYXR1cmUtZmxhZ3MnO1xuaW1wb3J0IHsgUHJpbWl0aXZlRHJhd0RhdGEgfSBmcm9tICcuLi8uLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvcHJpbWl0aXZlLWRyYXctZGF0YSc7XG5pbXBvcnQgRGVzY3JpcHRvck1hcCBmcm9tICcuLi8uLi8uLi9yZW5kZXJpbmcvZGVmYXVsdC1mb3J3YXJkLXBhc3MvZGVzY3JpcHRvci1tYXAnO1xuaW1wb3J0IEdlb21ldHJ5UGlwZWxpbmUgZnJvbSAnLi4vLi4vLi4vcmVuZGVyaW5nL2RlZmF1bHQtZm9yd2FyZC1wYXNzL2dlb21ldHJ5LXBpcGVsaW5lJztcblxuY29uc3QgZGVmYXVsdExheW91dDogQXR0cmlidXRlRGV0YWlsc1tdID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogJ1BPU0lUSU9OJyxcbiAgICAgICAgdHlwZTogJ1ZFQzMnLFxuICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdURVhDT09SRF8wJyxcbiAgICAgICAgdHlwZTogJ1ZFQzInLFxuICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICdUQU5HRU5UJyxcbiAgICAgICAgdHlwZTogJ1ZFQzQnLFxuICAgICAgICBjb21wb25lbnRUeXBlOiBDb21wb25lbnRUeXBlLmZsb2F0MzIsXG4gICAgICAgIGRlcGVuZHM6IFsnTk9STUFMJ10sXG4gICAgICAgIGZpbGw6IFsxLCAwLCAwLCAxXSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ05PUk1BTCcsXG4gICAgICAgIHR5cGU6ICdWRUMzJyxcbiAgICAgICAgY29tcG9uZW50VHlwZTogQ29tcG9uZW50VHlwZS5mbG9hdDMyLFxuICAgICAgICBzdHJpcDogdHJ1ZSxcbiAgICAgICAgZmVhdHVyZTogUGlwZWxpbmVGZWF0dXJlRmxhZ3MuVmVydGV4Tm9ybWFscyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ0NPTE9SXzAnLFxuICAgICAgICB0eXBlOiAnVkVDNCcsXG4gICAgICAgIGNvbXBvbmVudFR5cGU6IENvbXBvbmVudFR5cGUuZmxvYXQzMixcbiAgICAgICAgc3RyaXA6IHRydWUsXG4gICAgICAgIGZlYXR1cmU6IFBpcGVsaW5lRmVhdHVyZUZsYWdzLlZlcnRleENvbG9ycyxcbiAgICAgICAgZmlsbDogWzEsIDEsIDEsIDFdLFxuICAgIH0sXG5dO1xuXG5jb25zdCByZWN1cnNlTm9kZSA9IChcbiAgICBwYXJlbnRNYXRyaXg6IE1hdDRUeXBlPE1hdDRBcmc+LFxuICAgIG1lc2hlczogTWFwPEdMVEZNZXNoUG9zdHByb2Nlc3NlZCwgTWF0NFR5cGU8TWF0NEFyZz5bXT4sXG4pID0+IChub2RlOiBHTFRGTm9kZVBvc3Rwcm9jZXNzZWQpID0+IHtcbiAgICBjb25zdCBtYXRyaXggPSBub2RlLm1hdHJpeCA/PyBtYXQ0LmlkZW50aXR5KCk7XG5cbiAgICBpZiAobm9kZS5tYXRyaXggPT0gbnVsbCkge1xuICAgICAgICBpZiAobm9kZS5zY2FsZSkgbWF0NC5zY2FsaW5nKG5vZGUuc2NhbGUsIG1hdHJpeCk7XG5cbiAgICAgICAgaWYgKG5vZGUucm90YXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IHsgYXhpcywgYW5nbGUgfSA9IHF1YXQudG9BeGlzQW5nbGUobm9kZS5yb3RhdGlvbik7XG4gICAgICAgICAgICBtYXQ0LnJvdGF0ZShtYXRyaXgsIGF4aXMsIGFuZ2xlLCBtYXRyaXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5vZGUudHJhbnNsYXRpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgbWF0NC5zZXRUcmFuc2xhdGlvbihtYXRyaXgsIG5vZGUudHJhbnNsYXRpb24sIG1hdHJpeCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBtYXQ0Lm11bChwYXJlbnRNYXRyaXgsIG1hdHJpeCwgbWF0cml4KTtcblxuICAgIGlmIChub2RlLm1lc2ggIT0gbnVsbCkge1xuICAgICAgICBpZiAoIW1lc2hlcy5oYXMobm9kZS5tZXNoKSkgbWVzaGVzLnNldChub2RlLm1lc2gsIFtdKTtcbiAgICAgICAgbWVzaGVzLmdldChub2RlLm1lc2gpIS5wdXNoKG1hdHJpeCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgIH1cblxuICAgIG5vZGUuY2hpbGRyZW4/LmZvckVhY2gocmVjdXJzZU5vZGUobWF0cml4LCBtZXNoZXMpKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydEdsdGYoXG4gICAgdXJsOiBzdHJpbmcgfCBEYXRhVHlwZSxcbiAgICBkZXZpY2U6IEdQVURldmljZSxcbiAgICBkZXNjcmlwdG9yTWFwOiBEZXNjcmlwdG9yTWFwLFxuICAgIGRlZmF1bHRNYXRlcmlhbDogTWF0ZXJpYWxEZXNjcmlwdG9yLFxuICAgIGxheW91dDogQXR0cmlidXRlRGV0YWlsc1tdID0gZGVmYXVsdExheW91dCxcbiAgICBwaXBlbGluZXM6IFBhcnRpYWw8UmVjb3JkPG51bWJlciwgR2VvbWV0cnlQaXBlbGluZT4+ID0ge30sXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICBsb2c6ICgobXNnOiB1bmtub3duKSA9PiB2b2lkKSA9IGNvbnNvbGUubG9nLFxuKSB7XG4gICAgbG9nKCdzdGFydGluZyBpbXBvcnQnKTtcblxuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBnbHRmV2l0aEJ1ZmZlcnMgPSBhd2FpdCBsb2FkKHVybCwgR0xURkxvYWRlcik7XG4gICAgbG9nKGBmaW5pc2hlZCBsb2FkaW5nOiAke0RhdGUubm93KCkgLSBzdGFydH1gKTtcblxuICAgIGNvbnN0IHsgc2NlbmUgfSA9IHBvc3RQcm9jZXNzR0xURihnbHRmV2l0aEJ1ZmZlcnMpO1xuICAgIGlmIChzY2VuZT8ubm9kZXMgPT0gbnVsbCkgcmV0dXJuIHBpcGVsaW5lcztcbiAgICBsb2coYGZpbmlzaGVkIHByb2Nlc3Npbmc6ICR7RGF0ZS5ub3coKSAtIHN0YXJ0fWApO1xuXG4gICAgY29uc3QgbWVzaGVzID0gbmV3IE1hcDxHTFRGTWVzaFBvc3Rwcm9jZXNzZWQsIE1hdDRbXT4oKTtcbiAgICBzY2VuZS5ub2Rlcy5mb3JFYWNoKHJlY3Vyc2VOb2RlKG1hdDQuaWRlbnRpdHkoKSwgbWVzaGVzKSk7XG4gICAgbG9nKGBmaW5pc2hlZCBjcmVhdGluZyBpbnN0YW5jZXM6ICR7RGF0ZS5ub3coKSAtIHN0YXJ0fWApO1xuXG4gICAgY29uc3QgbWVzaEVudHJpZXMgPSBBcnJheS5mcm9tKG1lc2hlcy5lbnRyaWVzKCkpO1xuICAgIGNvbnN0IHByaW1pdGl2ZVByb21pc2VzID0gbWVzaEVudHJpZXMuZmxhdE1hcCgoW3sgcHJpbWl0aXZlcyB9LCBpbnN0YW5jZXNdKSA9PlxuICAgICAgICBwcmltaXRpdmVzLm1hcCgocHJpbSkgPT4gbG9hZFByaW1pdGl2ZShcbiAgICAgICAgICAgIGxheW91dCxcbiAgICAgICAgICAgIHByaW0sXG4gICAgICAgICAgICBpbnN0YW5jZXMsXG4gICAgICAgICAgICBkZXNjcmlwdG9yTWFwLFxuICAgICAgICAgICAgZGV2aWNlLFxuICAgICAgICApKSxcbiAgICApO1xuXG4gICAgY29uc3QgcHJpbWl0aXZlRGVzY3JpcHRvcnMgPSBhd2FpdCBQcm9taXNlLmFsbChwcmltaXRpdmVQcm9taXNlcyk7XG4gICAgbG9nKGBmaW5pc2hlZCBjcmVhdGluZyBwcmltaXRpdmVzOiAke0RhdGUubm93KCkgLSBzdGFydH1gKTtcblxuICAgIHR5cGUgTWF0ZXJpYWxLZXkgPSB7IG1hdGVyaWFsSWQ/OiBzdHJpbmcsIGZlYXR1cmVzOiBudW1iZXIgfTtcbiAgICBjb25zdCBtYXRlcmlhbE1hcCA9IG5ldyBNYXA8TWF0ZXJpYWxLZXksIFByaW1pdGl2ZURyYXdEYXRhW10+KCk7XG4gICAgY29uc3QgbWF0ZXJpYWxQcm9taXNlczogUmVjb3JkPHN0cmluZywgUHJvbWlzZTxNYXRlcmlhbERlc2NyaXB0b3I+PiA9IHt9O1xuXG4gICAgZm9yIChjb25zdCB7IG1hdGVyaWFsLCBkcmF3RGF0YSB9IG9mIHByaW1pdGl2ZURlc2NyaXB0b3JzKSB7XG4gICAgICAgIGlmIChkcmF3RGF0YSA9PSBudWxsKSBjb250aW51ZTtcblxuICAgICAgICBjb25zdCBrZXkgPSB7IG1hdGVyaWFsSWQ6IG1hdGVyaWFsPy5pZCwgZmVhdHVyZXM6IGRyYXdEYXRhLmZlYXR1cmVzIH07XG4gICAgICAgIGlmICghbWF0ZXJpYWxNYXAuaGFzKGtleSkpIG1hdGVyaWFsTWFwLnNldChrZXksIFtdKTtcbiAgICAgICAgbWF0ZXJpYWxNYXAuZ2V0KGtleSkhLnB1c2goZHJhd0RhdGEpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cblxuICAgICAgICBpZiAobWF0ZXJpYWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgbWF0ZXJpYWxQcm9taXNlc1ttYXRlcmlhbC5pZF0gPSBsb2FkTWF0ZXJpYWwobWF0ZXJpYWwsIGRlZmF1bHRNYXRlcmlhbCwgZGV2aWNlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG1hdGVyaWFsRW50cmllcyA9IE9iamVjdC5lbnRyaWVzKG1hdGVyaWFsUHJvbWlzZXMpXG4gICAgICAgIC5tYXAoYXN5bmMgKFtpZCwgbWF0XSkgPT4gW2lkLCBhd2FpdCBtYXRdKTtcblxuICAgIGNvbnN0IG1hdGVyaWFsRGVzY3JpcHRvcnMgPSBPYmplY3QuZnJvbUVudHJpZXMoYXdhaXQgUHJvbWlzZS5hbGwobWF0ZXJpYWxFbnRyaWVzKSkgYXMgUmVjb3JkPHN0cmluZywgTWF0ZXJpYWxEZXNjcmlwdG9yPjtcbiAgICBsb2coYGZpbmlzaGVkIGNyZWF0aW5nIG1hdGVyaWFsIGRlc2NyaXB0b3JzOiAke0RhdGUubm93KCkgLSBzdGFydH1gKTtcblxuICAgIGNvbnN0IGZ1bGxEZWZhdWx0TWF0OiBNYXRlcmlhbERlc2NyaXB0b3IgPSB7IC4uLmRlZmF1bHRNYXRlcmlhbCwgbWV0YWxsaWNGYWN0b3I6IDAgfTtcblxuICAgIGZvciAoY29uc3QgW3sgZmVhdHVyZXMsIG1hdGVyaWFsSWQgfSwgZHJhd0RhdGFzXSBvZiBtYXRlcmlhbE1hcC5lbnRyaWVzKCkpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IG1hdGVyaWFsSWQgIT0gbnVsbCA/IG1hdGVyaWFsRGVzY3JpcHRvcnNbbWF0ZXJpYWxJZF0gOiBmdWxsRGVmYXVsdE1hdDtcbiAgICAgICAgY29uc3QgbWF0ID0gbmV3IE1hdGVyaWFsRHJhd0RhdGEoZGVzY3JpcHRvciwgZGV2aWNlLCBkZXNjcmlwdG9yTWFwLCBmZWF0dXJlcywgZHJhd0RhdGFzKTtcbiAgICAgICAgY29uc3QgeyBmZWF0dXJlczogZiB9ID0gbWF0O1xuXG4gICAgICAgIHBpcGVsaW5lc1tmXSA/Pz0gbmV3IEdlb21ldHJ5UGlwZWxpbmUoZiwgZGVzY3JpcHRvck1hcCk7XG4gICAgICAgIHBpcGVsaW5lc1tmXS5hZGRNYXRlcmlhbHMobWF0KTtcbiAgICB9XG5cbiAgICBsb2coYGZpbmlzaGVkOiAke0RhdGUubm93KCkgLSBzdGFydH1gKTtcbiAgICByZXR1cm4gcGlwZWxpbmVzO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///459\n")},6182:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Lr: () => (/* binding */ createAndCopyBuffer)\n/* harmony export */ });\n/* unused harmony exports createAndCopyCubemap, ktx2ToTexture, textureToArrayBuffer, textureToKTX */\n/* harmony import */ var _rendering_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4176);\n\n\n\nfunction createAndCopyBuffer(arr, usage, device, label, alignment = 4) {\n    const pad = alignment - 1;\n    const buffer = device.createBuffer({\n        label,\n        usage,\n        size: (arr.byteLength + pad) & ~pad,\n        mappedAtCreation: true,\n    });\n    const writeArray = new Uint8Array(buffer.getMappedRange());\n    const readArray = arr instanceof ArrayBuffer\n        ? new Uint8Array(arr)\n        : new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n    writeArray.set(readArray);\n    buffer.unmap();\n    return buffer;\n}\nfunction createAndCopyCubemap(device, data, format, usage, label) {\n    const pixelSize = TextureFormatToSize[format];\n    if (pixelSize == null) {\n        throw new Error(`copy cubemap -- unsupported format: ${format}`);\n    }\n    const width = Math.sqrt(data.byteLength / (6 * pixelSize));\n    const size = { width, height: width, depthOrArrayLayers: 6 };\n    const texture = device.createTexture({\n        usage: usage | GPUTextureUsage.COPY_DST,\n        label,\n        format,\n        size,\n    });\n    device.queue.writeTexture({ texture }, data, { bytesPerRow: width * pixelSize, rowsPerImage: width }, size);\n    return texture;\n}\nfunction ktx2ToTexture(buffer, device, options) {\n    const arr = new Uint8Array(buffer);\n    const ktx = ktxparse.read(arr);\n    const format = VkFormatToWebGPU[ktx.vkFormat];\n    if (format == null) {\n        throw new Error(`ktx texture import -- unsupported format: ${ktx.vkFormat}\\n\\tCould not covert to webgpu`);\n    }\n    const pixelSize = TextureFormatToSize[format];\n    if (pixelSize == null) {\n        throw new Error(`ktx texture import -- unsupported format: ${ktx.vkFormat}\\n\\tCould not get pixel byte size`);\n    }\n    const size = {\n        width: ktx.pixelWidth,\n        height: ktx.pixelHeight,\n        depthOrArrayLayers: ktx.faceCount,\n    };\n    const maxMipCount = Math.ceil(Math.log2(Math.max(size.width, size.height))) + 1;\n    let mipLevelCount = ktx.levels.length;\n    if (options?.mipLevelCount === 'max') {\n        mipLevelCount = maxMipCount;\n    }\n    else if (typeof options?.mipLevelCount === 'number') {\n        mipLevelCount = Math.min(maxMipCount, options.mipLevelCount);\n    }\n    let usage = GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    if (options?.textureUsage)\n        usage |= options.textureUsage;\n    const texture = device.createTexture({\n        label: options?.label,\n        size,\n        mipLevelCount,\n        format,\n        usage,\n    });\n    const mipCopies = Math.min(ktx.levels.length, mipLevelCount) - 1;\n    for (let mipLevel = mipCopies; mipLevel >= 0; mipLevel -= 1) {\n        const width = size.width >> mipLevel;\n        const height = size.height >> mipLevel;\n        const { levelData } = ktx.levels[mipLevel];\n        const rawBytesPerRow = width * pixelSize;\n        const bytesPerRow = Math.max(rawBytesPerRow, 256);\n        const rowsPerImage = height;\n        const bytesPerImage = rowsPerImage * bytesPerRow;\n        let imageData = levelData;\n        if (bytesPerRow > rawBytesPerRow) {\n            imageData = new Uint8Array(bytesPerImage * texture.depthOrArrayLayers);\n            for (let h = 0; h < height * texture.depthOrArrayLayers; h += 1) {\n                for (let w = 0; w < rawBytesPerRow; w += 1) {\n                    imageData[w + h * bytesPerRow] = levelData[w + h * rawBytesPerRow];\n                }\n            }\n        }\n        const layerBatch = Math.min(Math.floor(device.limits.maxBufferSize / bytesPerImage), ktx.faceCount);\n        const layerCount = Math.ceil(ktx.faceCount / layerBatch);\n        for (let l = 0; l < layerCount; l += 1) {\n            const offset = l * layerBatch;\n            const count = Math.min(layerBatch, ktx.faceCount - offset);\n            const data = layerCount > 1\n                ? imageData.subarray(offset * bytesPerImage, (offset + count) * bytesPerImage)\n                : imageData;\n            device.queue.writeTexture({ mipLevel, texture, origin: [0, 0, offset] }, data, { bytesPerRow, rowsPerImage }, [width, height, count]);\n        }\n    }\n    return texture;\n}\nasync function textureToArrayBuffer({ device, texture, mipLevel = 0, returnBuffer, storageBuffer, resultBuffer, description, }) {\n    const pixelSize = TextureFormatToSize[texture.format];\n    const fullDescription = padTemplate `[textureToKTX${description ?? ''}${texture.label}] --`;\n    if (pixelSize == null) {\n        throw new Error(`${fullDescription} format ${texture.format} unsupported`);\n    }\n    const width = texture.width >> mipLevel;\n    const height = texture.height >> mipLevel;\n    const rawBytesPerRow = width * pixelSize;\n    const bytesPerRow = Math.max(rawBytesPerRow, 256);\n    const rowsPerImage = height;\n    const byteSize = rowsPerImage * bytesPerRow * texture.depthOrArrayLayers;\n    const resultSize = rawBytesPerRow * height * texture.depthOrArrayLayers;\n    if (resultBuffer != null && resultBuffer.byteLength < byteSize) {\n        throw new Error(`${fullDescription} given result array not large enough.\r\n${resultBuffer.byteLength} < ${byteSize}`);\n    }\n    if (storageBuffer != null && storageBuffer.size < byteSize) {\n        throw new Error(`${fullDescription} given storage buffer not large enough.\r\n${storageBuffer.size} < ${byteSize}`);\n    }\n    const requiredUsage = GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ;\n    if (storageBuffer != null && (storageBuffer.usage & requiredUsage) !== requiredUsage) {\n        throw new Error(`${fullDescription} given storage does not have correct usage flags.\r\nGiven: ${storageBuffer.usage}\r\nRequired: ${requiredUsage}`);\n    }\n    let imageData = resultBuffer ?? new Uint8Array(byteSize);\n    const storage = storageBuffer ?? device.createBuffer({\n        label: `${fullDescription} storage buffer`,\n        size: byteSize,\n        usage: requiredUsage,\n    });\n    const encoder = device.createCommandEncoder({ label: `${fullDescription} encoder` });\n    encoder.copyTextureToBuffer({ texture, mipLevel }, { buffer: storage, rowsPerImage, bytesPerRow }, { width, height, depthOrArrayLayers: texture.depthOrArrayLayers });\n    device.queue.submit([encoder.finish()]);\n    await Promise.all([\n        storage.mapAsync(GPUMapMode.READ, 0, byteSize),\n        device.queue.onSubmittedWorkDone(),\n    ]);\n    const mapped = storage.getMappedRange(0, byteSize);\n    imageData.set(new Uint8Array(mapped));\n    storage.unmap();\n    if (bytesPerRow > rawBytesPerRow) {\n        for (let h = 0; h < height * texture.depthOrArrayLayers; h += 1) {\n            for (let w = 0; w < rawBytesPerRow; w += 1) {\n                imageData[w + h * rawBytesPerRow] = imageData[w + h * bytesPerRow];\n            }\n        }\n        imageData = imageData.slice(0, resultSize);\n    }\n    return {\n        imageData,\n        storageBuffer: returnBuffer ? storage : undefined,\n    };\n}\nasync function textureToKTX(device, texture, cube = false) {\n    const pixelSize = TextureFormatToSize[texture.format];\n    const typeSize = TextureFormatToChannelSize[texture.format];\n    if (pixelSize == null || typeSize == null) {\n        throw new Error(`textureToKTX -- format ${texture.format} of ${texture.label} unsupported`);\n    }\n    const container = new ktxparse.KTX2Container();\n    container.pixelWidth = texture.width;\n    container.pixelHeight = texture.height;\n    container.vkFormat = WebGPUToVkFormat[texture.format];\n    container.typeSize = typeSize;\n    delete container.keyValue.KTXswizzle;\n    const dataFormat = container.dataFormatDescriptor[0];\n    dataFormat.colorModel = ktxparse.KHR_DF_MODEL_RGBSDA;\n    dataFormat.transferFunction = ktxparse.KHR_DF_TRANSFER_LINEAR;\n    dataFormat.bytesPlane[0] = pixelSize;\n    dataFormat.samples = [0, 1, 2, 3].map((i) => ({\n        channelType: [192, 193, 194, 207][i],\n        samplePosition: [0, 0, 0, 0],\n        bitLength: container.typeSize * 8 - 1,\n        bitOffset: container.typeSize * 8 * i,\n        sampleLower: -1082130432,\n        sampleUpper: 1065353216,\n    }));\n    if (texture.dimension === '3d') {\n        container.faceCount = 1;\n        container.pixelDepth = texture.depthOrArrayLayers;\n    }\n    else if (cube) {\n        const cubeLayers = texture.depthOrArrayLayers / 6;\n        container.layerCount = cubeLayers === 1 ? 0 : cubeLayers;\n        container.faceCount = 6;\n    }\n    else {\n        container.layerCount = texture.depthOrArrayLayers;\n        container.faceCount = 1;\n    }\n    let storageBuffer;\n    let imageData;\n    for (let i = 0; i < texture.mipLevelCount; i += 1) {\n        // eslint-disable-next-line no-await-in-loop\n        ({ imageData, storageBuffer } = await textureToArrayBuffer({\n            mipLevel: i,\n            returnBuffer: true,\n            device,\n            texture,\n            storageBuffer,\n        }));\n        container.levels.push({\n            levelData: imageData,\n            uncompressedByteLength: imageData.byteLength,\n        });\n    }\n    return ktxparse.write(container);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUcsTUFBTSxvQkFBb0IsQ0FBQztZQUN2RCxRQUFRLEVBQUUsQ0FBQztZQUNYLFlBQVksRUFBRSxJQUFJO1lBQ2xCLE1BQU07WUFDTixPQUFPO1lBQ1AsYUFBYTtTQUNoQixDQUFDLENBQUMsQ0FBQztRQUVKLFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ2xCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLHNCQUFzQixFQUFFLFNBQVMsQ0FBQyxVQUFVO1NBQy9DLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDckMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NidW50LXBvcnRmb2xpby8uL3NyYy91dGlscy9kYXRhLWNvcHkudHM/YmE1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBrdHhwYXJzZSBmcm9tICdrdHgtcGFyc2UnO1xyXG5cclxuaW1wb3J0IHsgVmtGb3JtYXRUb1dlYkdQVSwgVGV4dHVyZUZvcm1hdFRvU2l6ZSwgVGV4dHVyZUZvcm1hdFRvQ2hhbm5lbFNpemUsIFdlYkdQVVRvVmtGb3JtYXQgfSBmcm9tICcuLi9yZW5kZXJpbmcvY29uc3RhbnRzJztcclxuaW1wb3J0IHsgcGFkVGVtcGxhdGUgfSBmcm9tICcuL2dlbmVyYWwnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFuZENvcHlCdWZmZXIoXHJcbiAgICBhcnI6IEFycmF5QnVmZmVyIHwgVHlwZWRBcnJheUxpa2UsXHJcbiAgICB1c2FnZTogR1BVRmxhZ3NDb25zdGFudCxcclxuICAgIGRldmljZTogR1BVRGV2aWNlLFxyXG4gICAgbGFiZWw/OiBzdHJpbmcsXHJcbiAgICBhbGlnbm1lbnQgPSA0LFxyXG4pOiBHUFVCdWZmZXIge1xyXG4gICAgY29uc3QgcGFkID0gYWxpZ25tZW50IC0gMTtcclxuICAgIGNvbnN0IGJ1ZmZlciA9IGRldmljZS5jcmVhdGVCdWZmZXIoe1xyXG4gICAgICAgIGxhYmVsLFxyXG4gICAgICAgIHVzYWdlLFxyXG4gICAgICAgIHNpemU6IChhcnIuYnl0ZUxlbmd0aCArIHBhZCkgJiB+cGFkLFxyXG4gICAgICAgIG1hcHBlZEF0Q3JlYXRpb246IHRydWUsXHJcbiAgICB9IGFzIEdQVUJ1ZmZlckRlc2NyaXB0b3IpO1xyXG5cclxuICAgIGNvbnN0IHdyaXRlQXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXIuZ2V0TWFwcGVkUmFuZ2UoKSk7XHJcbiAgICBjb25zdCByZWFkQXJyYXkgPSBhcnIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlclxyXG4gICAgICAgID8gbmV3IFVpbnQ4QXJyYXkoYXJyKVxyXG4gICAgICAgIDogbmV3IFVpbnQ4QXJyYXkoYXJyLmJ1ZmZlciwgYXJyLmJ5dGVPZmZzZXQsIGFyci5ieXRlTGVuZ3RoKTtcclxuXHJcbiAgICB3cml0ZUFycmF5LnNldChyZWFkQXJyYXkpO1xyXG4gICAgYnVmZmVyLnVubWFwKCk7XHJcblxyXG4gICAgcmV0dXJuIGJ1ZmZlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUFuZENvcHlDdWJlbWFwKFxyXG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXHJcbiAgICBkYXRhOiBBcnJheUJ1ZmZlcixcclxuICAgIGZvcm1hdDogR1BVVGV4dHVyZUZvcm1hdCxcclxuICAgIHVzYWdlOiBudW1iZXIsXHJcbiAgICBsYWJlbD86IHN0cmluZyxcclxuKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW2Zvcm1hdF07XHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGNvcHkgY3ViZW1hcCAtLSB1bnN1cHBvcnRlZCBmb3JtYXQ6ICR7Zm9ybWF0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHdpZHRoID0gTWF0aC5zcXJ0KGRhdGEuYnl0ZUxlbmd0aCAvICg2ICogcGl4ZWxTaXplKSk7XHJcbiAgICBjb25zdCBzaXplID0geyB3aWR0aCwgaGVpZ2h0OiB3aWR0aCwgZGVwdGhPckFycmF5TGF5ZXJzOiA2IH07XHJcblxyXG4gICAgY29uc3QgdGV4dHVyZSA9IGRldmljZS5jcmVhdGVUZXh0dXJlKHtcclxuICAgICAgICB1c2FnZTogdXNhZ2UgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9EU1QsXHJcbiAgICAgICAgbGFiZWwsXHJcbiAgICAgICAgZm9ybWF0LFxyXG4gICAgICAgIHNpemUsXHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXZpY2UucXVldWUud3JpdGVUZXh0dXJlKFxyXG4gICAgICAgIHsgdGV4dHVyZSB9LFxyXG4gICAgICAgIGRhdGEsXHJcbiAgICAgICAgeyBieXRlc1BlclJvdzogd2lkdGggKiBwaXhlbFNpemUsIHJvd3NQZXJJbWFnZTogd2lkdGggfSxcclxuICAgICAgICBzaXplLFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdGV4dHVyZTtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgS1RYSW1wb3J0T3B0aW9ucyA9IHtcclxuICAgIGxhYmVsPzogc3RyaW5nLFxyXG4gICAgbWlwTGV2ZWxDb3VudD86IG51bWJlciB8ICdtYXgnIHwgJ2RlZmF1bHQnLFxyXG4gICAgdGV4dHVyZVVzYWdlPzogbnVtYmVyLFxyXG4gICAgdmFsaWRhdGU/OiBib29sZWFuLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGt0eDJUb1RleHR1cmUoXHJcbiAgICBidWZmZXI6IEFycmF5QnVmZmVyLFxyXG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXHJcbiAgICBvcHRpb25zPzogS1RYSW1wb3J0T3B0aW9ucyxcclxuKSB7XHJcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xyXG4gICAgY29uc3Qga3R4ID0ga3R4cGFyc2UucmVhZChhcnIpO1xyXG4gICAgY29uc3QgZm9ybWF0ID0gVmtGb3JtYXRUb1dlYkdQVVtrdHgudmtGb3JtYXRdO1xyXG5cclxuICAgIGlmIChmb3JtYXQgPT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihga3R4IHRleHR1cmUgaW1wb3J0IC0tIHVuc3VwcG9ydGVkIGZvcm1hdDogJHtrdHgudmtGb3JtYXR9XFxuXFx0Q291bGQgbm90IGNvdmVydCB0byB3ZWJncHVgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW2Zvcm1hdF07XHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGt0eCB0ZXh0dXJlIGltcG9ydCAtLSB1bnN1cHBvcnRlZCBmb3JtYXQ6ICR7a3R4LnZrRm9ybWF0fVxcblxcdENvdWxkIG5vdCBnZXQgcGl4ZWwgYnl0ZSBzaXplYCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc2l6ZSA9IHtcclxuICAgICAgICB3aWR0aDoga3R4LnBpeGVsV2lkdGgsXHJcbiAgICAgICAgaGVpZ2h0OiBrdHgucGl4ZWxIZWlnaHQsXHJcbiAgICAgICAgZGVwdGhPckFycmF5TGF5ZXJzOiBrdHguZmFjZUNvdW50LFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBtYXhNaXBDb3VudCA9IE1hdGguY2VpbChNYXRoLmxvZzIoTWF0aC5tYXgoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpKSkgKyAxO1xyXG4gICAgbGV0IG1pcExldmVsQ291bnQgPSBrdHgubGV2ZWxzLmxlbmd0aDtcclxuICAgIGlmIChvcHRpb25zPy5taXBMZXZlbENvdW50ID09PSAnbWF4Jykge1xyXG4gICAgICAgIG1pcExldmVsQ291bnQgPSBtYXhNaXBDb3VudDtcclxuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnM/Lm1pcExldmVsQ291bnQgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgbWlwTGV2ZWxDb3VudCA9IE1hdGgubWluKG1heE1pcENvdW50LCBvcHRpb25zLm1pcExldmVsQ291bnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCB1c2FnZSA9IEdQVVRleHR1cmVVc2FnZS5URVhUVVJFX0JJTkRJTkcgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9EU1Q7XHJcbiAgICBpZiAob3B0aW9ucz8udGV4dHVyZVVzYWdlKSB1c2FnZSB8PSBvcHRpb25zLnRleHR1cmVVc2FnZTtcclxuXHJcbiAgICBjb25zdCB0ZXh0dXJlID0gZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xyXG4gICAgICAgIGxhYmVsOiBvcHRpb25zPy5sYWJlbCxcclxuICAgICAgICBzaXplLFxyXG4gICAgICAgIG1pcExldmVsQ291bnQsXHJcbiAgICAgICAgZm9ybWF0LFxyXG4gICAgICAgIHVzYWdlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgbWlwQ29waWVzID0gTWF0aC5taW4oa3R4LmxldmVscy5sZW5ndGgsIG1pcExldmVsQ291bnQpIC0gMTtcclxuXHJcbiAgICBmb3IgKGxldCBtaXBMZXZlbCA9IG1pcENvcGllczsgbWlwTGV2ZWwgPj0gMDsgbWlwTGV2ZWwgLT0gMSkge1xyXG4gICAgICAgIGNvbnN0IHdpZHRoID0gc2l6ZS53aWR0aCA+PiBtaXBMZXZlbDtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBzaXplLmhlaWdodCA+PiBtaXBMZXZlbDtcclxuICAgICAgICBjb25zdCB7IGxldmVsRGF0YSB9ID0ga3R4LmxldmVsc1ttaXBMZXZlbF07XHJcblxyXG4gICAgICAgIGNvbnN0IHJhd0J5dGVzUGVyUm93ID0gd2lkdGggKiBwaXhlbFNpemU7XHJcbiAgICAgICAgY29uc3QgYnl0ZXNQZXJSb3cgPSBNYXRoLm1heChyYXdCeXRlc1BlclJvdywgMjU2KTtcclxuICAgICAgICBjb25zdCByb3dzUGVySW1hZ2UgPSBoZWlnaHQ7XHJcbiAgICAgICAgY29uc3QgYnl0ZXNQZXJJbWFnZSA9IHJvd3NQZXJJbWFnZSAqIGJ5dGVzUGVyUm93O1xyXG5cclxuICAgICAgICBsZXQgaW1hZ2VEYXRhID0gbGV2ZWxEYXRhO1xyXG4gICAgICAgIGlmIChieXRlc1BlclJvdyA+IHJhd0J5dGVzUGVyUm93KSB7XHJcbiAgICAgICAgICAgIGltYWdlRGF0YSA9IG5ldyBVaW50OEFycmF5KGJ5dGVzUGVySW1hZ2UgKiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBoID0gMDsgaCA8IGhlaWdodCAqIHRleHR1cmUuZGVwdGhPckFycmF5TGF5ZXJzOyBoICs9IDEpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHcgPSAwOyB3IDwgcmF3Qnl0ZXNQZXJSb3c7IHcgKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVt3ICsgaCAqIGJ5dGVzUGVyUm93XSA9IGxldmVsRGF0YVt3ICsgaCAqIHJhd0J5dGVzUGVyUm93XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbGF5ZXJCYXRjaCA9IE1hdGgubWluKFxyXG4gICAgICAgICAgICBNYXRoLmZsb29yKGRldmljZS5saW1pdHMubWF4QnVmZmVyU2l6ZSAvIGJ5dGVzUGVySW1hZ2UpLFxyXG4gICAgICAgICAgICBrdHguZmFjZUNvdW50LFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgbGF5ZXJDb3VudCA9IE1hdGguY2VpbChrdHguZmFjZUNvdW50IC8gbGF5ZXJCYXRjaCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGwgPSAwOyBsIDwgbGF5ZXJDb3VudDsgbCArPSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGwgKiBsYXllckJhdGNoO1xyXG4gICAgICAgICAgICBjb25zdCBjb3VudCA9IE1hdGgubWluKGxheWVyQmF0Y2gsIGt0eC5mYWNlQ291bnQgLSBvZmZzZXQpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGxheWVyQ291bnQgPiAxXHJcbiAgICAgICAgICAgICAgICA/IGltYWdlRGF0YS5zdWJhcnJheShvZmZzZXQgKiBieXRlc1BlckltYWdlLCAob2Zmc2V0ICsgY291bnQpICogYnl0ZXNQZXJJbWFnZSlcclxuICAgICAgICAgICAgICAgIDogaW1hZ2VEYXRhO1xyXG5cclxuICAgICAgICAgICAgZGV2aWNlLnF1ZXVlLndyaXRlVGV4dHVyZShcclxuICAgICAgICAgICAgICAgIHsgbWlwTGV2ZWwsIHRleHR1cmUsIG9yaWdpbjogWzAsIDAsIG9mZnNldF0gfSxcclxuICAgICAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgICAgICB7IGJ5dGVzUGVyUm93LCByb3dzUGVySW1hZ2UgfSxcclxuICAgICAgICAgICAgICAgIFt3aWR0aCwgaGVpZ2h0LCBjb3VudF0sXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0ZXh0dXJlO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBUZXh0dXJlVG9BcnJheUJ1ZmZlck9wdGlvbnMgPSB7XHJcbiAgICBkZXZpY2U6IEdQVURldmljZSxcclxuICAgIHRleHR1cmU6IEdQVVRleHR1cmUsXHJcbiAgICBtaXBMZXZlbD86IG51bWJlcixcclxuICAgIHJlc3VsdEJ1ZmZlcj86IFVpbnQ4QXJyYXksXHJcbiAgICBzdG9yYWdlQnVmZmVyPzogR1BVQnVmZmVyLFxyXG4gICAgcmV0dXJuQnVmZmVyPzogYm9vbGVhbixcclxuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nLFxyXG59O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRleHR1cmVUb0FycmF5QnVmZmVyKFxyXG4gICAgb3B0aW9uczogT21pdDxUZXh0dXJlVG9BcnJheUJ1ZmZlck9wdGlvbnMsICdyZXR1cm5CdWZmZXInPiAmIHsgcmV0dXJuQnVmZmVyPzogZmFsc2UgfSxcclxuKTogUHJvbWlzZTx7IGltYWdlRGF0YTogVWludDhBcnJheSB9PjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXh0dXJlVG9BcnJheUJ1ZmZlcihcclxuICAgIG9wdGlvbnM6IE9taXQ8VGV4dHVyZVRvQXJyYXlCdWZmZXJPcHRpb25zLCAncmV0dXJuQnVmZmVyJz4gJiB7IHJldHVybkJ1ZmZlcjogdHJ1ZSB9LFxyXG4pOiBQcm9taXNlPHsgaW1hZ2VEYXRhOiBVaW50OEFycmF5LCBzdG9yYWdlQnVmZmVyOiBHUFVCdWZmZXIgfT47XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGV4dHVyZVRvQXJyYXlCdWZmZXIoe1xyXG4gICAgZGV2aWNlLFxyXG4gICAgdGV4dHVyZSxcclxuICAgIG1pcExldmVsID0gMCxcclxuICAgIHJldHVybkJ1ZmZlcixcclxuICAgIHN0b3JhZ2VCdWZmZXIsXHJcbiAgICByZXN1bHRCdWZmZXIsXHJcbiAgICBkZXNjcmlwdGlvbixcclxufTogVGV4dHVyZVRvQXJyYXlCdWZmZXJPcHRpb25zKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnN0IGZ1bGxEZXNjcmlwdGlvbiA9IHBhZFRlbXBsYXRlYFt0ZXh0dXJlVG9LVFgke2Rlc2NyaXB0aW9uID8/ICcnfSR7dGV4dHVyZS5sYWJlbH1dIC0tYDtcclxuXHJcbiAgICBpZiAocGl4ZWxTaXplID09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBmb3JtYXQgJHt0ZXh0dXJlLmZvcm1hdH0gdW5zdXBwb3J0ZWRgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB3aWR0aCA9IHRleHR1cmUud2lkdGggPj4gbWlwTGV2ZWw7XHJcbiAgICBjb25zdCBoZWlnaHQgPSB0ZXh0dXJlLmhlaWdodCA+PiBtaXBMZXZlbDtcclxuICAgIGNvbnN0IHJhd0J5dGVzUGVyUm93ID0gd2lkdGggKiBwaXhlbFNpemU7XHJcbiAgICBjb25zdCBieXRlc1BlclJvdyA9IE1hdGgubWF4KHJhd0J5dGVzUGVyUm93LCAyNTYpO1xyXG4gICAgY29uc3Qgcm93c1BlckltYWdlID0gaGVpZ2h0O1xyXG4gICAgY29uc3QgYnl0ZVNpemUgPSByb3dzUGVySW1hZ2UgKiBieXRlc1BlclJvdyAqIHRleHR1cmUuZGVwdGhPckFycmF5TGF5ZXJzO1xyXG4gICAgY29uc3QgcmVzdWx0U2l6ZSA9IHJhd0J5dGVzUGVyUm93ICogaGVpZ2h0ICogdGV4dHVyZS5kZXB0aE9yQXJyYXlMYXllcnM7XHJcblxyXG4gICAgaWYgKHJlc3VsdEJ1ZmZlciAhPSBudWxsICYmIHJlc3VsdEJ1ZmZlci5ieXRlTGVuZ3RoIDwgYnl0ZVNpemUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBnaXZlbiByZXN1bHQgYXJyYXkgbm90IGxhcmdlIGVub3VnaC5cclxuJHtyZXN1bHRCdWZmZXIuYnl0ZUxlbmd0aH0gPCAke2J5dGVTaXplfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdG9yYWdlQnVmZmVyICE9IG51bGwgJiYgc3RvcmFnZUJ1ZmZlci5zaXplIDwgYnl0ZVNpemUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZnVsbERlc2NyaXB0aW9ufSBnaXZlbiBzdG9yYWdlIGJ1ZmZlciBub3QgbGFyZ2UgZW5vdWdoLlxyXG4ke3N0b3JhZ2VCdWZmZXIuc2l6ZX0gPCAke2J5dGVTaXplfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlcXVpcmVkVXNhZ2UgPSBHUFVCdWZmZXJVc2FnZS5DT1BZX0RTVCB8IEdQVUJ1ZmZlclVzYWdlLk1BUF9SRUFEO1xyXG5cclxuICAgIGlmIChzdG9yYWdlQnVmZmVyICE9IG51bGwgJiYgKHN0b3JhZ2VCdWZmZXIudXNhZ2UgJiByZXF1aXJlZFVzYWdlKSAhPT0gcmVxdWlyZWRVc2FnZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtmdWxsRGVzY3JpcHRpb259IGdpdmVuIHN0b3JhZ2UgZG9lcyBub3QgaGF2ZSBjb3JyZWN0IHVzYWdlIGZsYWdzLlxyXG5HaXZlbjogJHtzdG9yYWdlQnVmZmVyLnVzYWdlfVxyXG5SZXF1aXJlZDogJHtyZXF1aXJlZFVzYWdlfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBpbWFnZURhdGEgPSByZXN1bHRCdWZmZXIgPz8gbmV3IFVpbnQ4QXJyYXkoYnl0ZVNpemUpO1xyXG4gICAgY29uc3Qgc3RvcmFnZSA9IHN0b3JhZ2VCdWZmZXIgPz8gZGV2aWNlLmNyZWF0ZUJ1ZmZlcih7XHJcbiAgICAgICAgbGFiZWw6IGAke2Z1bGxEZXNjcmlwdGlvbn0gc3RvcmFnZSBidWZmZXJgLFxyXG4gICAgICAgIHNpemU6IGJ5dGVTaXplLFxyXG4gICAgICAgIHVzYWdlOiByZXF1aXJlZFVzYWdlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgZW5jb2RlciA9IGRldmljZS5jcmVhdGVDb21tYW5kRW5jb2Rlcih7IGxhYmVsOiBgJHtmdWxsRGVzY3JpcHRpb259IGVuY29kZXJgIH0pO1xyXG4gICAgZW5jb2Rlci5jb3B5VGV4dHVyZVRvQnVmZmVyKFxyXG4gICAgICAgIHsgdGV4dHVyZSwgbWlwTGV2ZWwgfSxcclxuICAgICAgICB7IGJ1ZmZlcjogc3RvcmFnZSwgcm93c1BlckltYWdlLCBieXRlc1BlclJvdyB9LFxyXG4gICAgICAgIHsgd2lkdGgsIGhlaWdodCwgZGVwdGhPckFycmF5TGF5ZXJzOiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyB9LFxyXG4gICAgKTtcclxuICAgIGRldmljZS5xdWV1ZS5zdWJtaXQoW2VuY29kZXIuZmluaXNoKCldKTtcclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgc3RvcmFnZS5tYXBBc3luYyhHUFVNYXBNb2RlLlJFQUQsIDAsIGJ5dGVTaXplKSxcclxuICAgICAgICBkZXZpY2UucXVldWUub25TdWJtaXR0ZWRXb3JrRG9uZSgpLFxyXG4gICAgXSk7XHJcblxyXG4gICAgY29uc3QgbWFwcGVkID0gc3RvcmFnZS5nZXRNYXBwZWRSYW5nZSgwLCBieXRlU2l6ZSk7XHJcbiAgICBpbWFnZURhdGEuc2V0KG5ldyBVaW50OEFycmF5KG1hcHBlZCkpO1xyXG4gICAgc3RvcmFnZS51bm1hcCgpO1xyXG5cclxuICAgIGlmIChieXRlc1BlclJvdyA+IHJhd0J5dGVzUGVyUm93KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaCA9IDA7IGggPCBoZWlnaHQgKiB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVyczsgaCArPSAxKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHcgPSAwOyB3IDwgcmF3Qnl0ZXNQZXJSb3c7IHcgKz0gMSkge1xyXG4gICAgICAgICAgICAgICAgaW1hZ2VEYXRhW3cgKyBoICogcmF3Qnl0ZXNQZXJSb3ddID0gaW1hZ2VEYXRhW3cgKyBoICogYnl0ZXNQZXJSb3ddO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGltYWdlRGF0YSA9IGltYWdlRGF0YS5zbGljZSgwLCByZXN1bHRTaXplKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGltYWdlRGF0YSxcclxuICAgICAgICBzdG9yYWdlQnVmZmVyOiByZXR1cm5CdWZmZXIgPyBzdG9yYWdlIDogdW5kZWZpbmVkLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRleHR1cmVUb0tUWChkZXZpY2U6IEdQVURldmljZSwgdGV4dHVyZTogR1BVVGV4dHVyZSwgY3ViZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBwaXhlbFNpemUgPSBUZXh0dXJlRm9ybWF0VG9TaXplW3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnN0IHR5cGVTaXplID0gVGV4dHVyZUZvcm1hdFRvQ2hhbm5lbFNpemVbdGV4dHVyZS5mb3JtYXRdO1xyXG5cclxuICAgIGlmIChwaXhlbFNpemUgPT0gbnVsbCB8fCB0eXBlU2l6ZSA9PSBudWxsKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB0ZXh0dXJlVG9LVFggLS0gZm9ybWF0ICR7dGV4dHVyZS5mb3JtYXR9IG9mICR7dGV4dHVyZS5sYWJlbH0gdW5zdXBwb3J0ZWRgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjb250YWluZXIgPSBuZXcga3R4cGFyc2UuS1RYMkNvbnRhaW5lcigpO1xyXG4gICAgY29udGFpbmVyLnBpeGVsV2lkdGggPSB0ZXh0dXJlLndpZHRoO1xyXG4gICAgY29udGFpbmVyLnBpeGVsSGVpZ2h0ID0gdGV4dHVyZS5oZWlnaHQ7XHJcbiAgICBjb250YWluZXIudmtGb3JtYXQgPSBXZWJHUFVUb1ZrRm9ybWF0W3RleHR1cmUuZm9ybWF0XTtcclxuICAgIGNvbnRhaW5lci50eXBlU2l6ZSA9IHR5cGVTaXplO1xyXG4gICAgZGVsZXRlIGNvbnRhaW5lci5rZXlWYWx1ZS5LVFhzd2l6emxlO1xyXG5cclxuICAgIGNvbnN0IGRhdGFGb3JtYXQgPSBjb250YWluZXIuZGF0YUZvcm1hdERlc2NyaXB0b3JbMF07XHJcbiAgICBkYXRhRm9ybWF0LmNvbG9yTW9kZWwgPSBrdHhwYXJzZS5LSFJfREZfTU9ERUxfUkdCU0RBO1xyXG4gICAgZGF0YUZvcm1hdC50cmFuc2ZlckZ1bmN0aW9uID0ga3R4cGFyc2UuS0hSX0RGX1RSQU5TRkVSX0xJTkVBUjtcclxuICAgIGRhdGFGb3JtYXQuYnl0ZXNQbGFuZVswXSA9IHBpeGVsU2l6ZTtcclxuXHJcbiAgICBkYXRhRm9ybWF0LnNhbXBsZXMgPSBbMCwgMSwgMiwgM10ubWFwKChpKSA9PiAoe1xyXG4gICAgICAgIGNoYW5uZWxUeXBlOiBbMTkyLCAxOTMsIDE5NCwgMjA3XVtpXSxcclxuICAgICAgICBzYW1wbGVQb3NpdGlvbjogWzAsIDAsIDAsIDBdLFxyXG4gICAgICAgIGJpdExlbmd0aDogY29udGFpbmVyLnR5cGVTaXplICogOCAtIDEsXHJcbiAgICAgICAgYml0T2Zmc2V0OiBjb250YWluZXIudHlwZVNpemUgKiA4ICogaSxcclxuICAgICAgICBzYW1wbGVMb3dlcjogLTEwODIxMzA0MzIsXHJcbiAgICAgICAgc2FtcGxlVXBwZXI6IDEwNjUzNTMyMTYsXHJcbiAgICB9KSk7XHJcblxyXG4gICAgaWYgKHRleHR1cmUuZGltZW5zaW9uID09PSAnM2QnKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDE7XHJcbiAgICAgICAgY29udGFpbmVyLnBpeGVsRGVwdGggPSB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycztcclxuICAgIH0gZWxzZSBpZiAoY3ViZSkge1xyXG4gICAgICAgIGNvbnN0IGN1YmVMYXllcnMgPSB0ZXh0dXJlLmRlcHRoT3JBcnJheUxheWVycyAvIDY7XHJcbiAgICAgICAgY29udGFpbmVyLmxheWVyQ291bnQgPSBjdWJlTGF5ZXJzID09PSAxID8gMCA6IGN1YmVMYXllcnM7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDY7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnRhaW5lci5sYXllckNvdW50ID0gdGV4dHVyZS5kZXB0aE9yQXJyYXlMYXllcnM7XHJcbiAgICAgICAgY29udGFpbmVyLmZhY2VDb3VudCA9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHN0b3JhZ2VCdWZmZXI6IEdQVUJ1ZmZlciB8IHVuZGVmaW5lZDtcclxuICAgIGxldCBpbWFnZURhdGE6IFVpbnQ4QXJyYXk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0dXJlLm1pcExldmVsQ291bnQ7IGkgKz0gMSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29wXHJcbiAgICAgICAgKHsgaW1hZ2VEYXRhLCBzdG9yYWdlQnVmZmVyIH0gPSBhd2FpdCB0ZXh0dXJlVG9BcnJheUJ1ZmZlcih7XHJcbiAgICAgICAgICAgIG1pcExldmVsOiBpLFxyXG4gICAgICAgICAgICByZXR1cm5CdWZmZXI6IHRydWUsXHJcbiAgICAgICAgICAgIGRldmljZSxcclxuICAgICAgICAgICAgdGV4dHVyZSxcclxuICAgICAgICAgICAgc3RvcmFnZUJ1ZmZlcixcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lci5sZXZlbHMucHVzaCh7XHJcbiAgICAgICAgICAgIGxldmVsRGF0YTogaW1hZ2VEYXRhLFxyXG4gICAgICAgICAgICB1bmNvbXByZXNzZWRCeXRlTGVuZ3RoOiBpbWFnZURhdGEuYnl0ZUxlbmd0aCxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga3R4cGFyc2Uud3JpdGUoY29udGFpbmVyKTtcclxufVxyXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///6182\n")},2253:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   u: () => (/* binding */ imageToTexture),\n/* harmony export */   y: () => (/* binding */ parseHDR)\n/* harmony export */ });\n/* harmony import */ var _data_conversion__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4955);\n/* harmony import */ var _texture_processing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7335);\n\n\nasync function imageToTexture({ device, data, mimeType, usage = GPUTextureUsage.TEXTURE_BINDING, mips = true, format = 'rgba8unorm', colorSpace = 'srgb', label = '', srgbToLinear, }) {\n    const blob = new Blob([data], { type: mimeType });\n    const bitmap = await createImageBitmap(blob, { colorSpaceConversion: 'none' });\n    const size = { width: bitmap.width, height: bitmap.height };\n    const texture = device.createTexture({\n        label,\n        format,\n        size: size,\n        usage: usage | GPUTextureUsage.COPY_DST | GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n        mipLevelCount: mips ? 1 + (Math.log2(Math.max(bitmap.width, bitmap.height)) | 0) : 1,\n    });\n    device.queue.copyExternalImageToTexture({ source: bitmap }, { texture, colorSpace }, size);\n    if (srgbToLinear)\n        (0,_texture_processing__WEBPACK_IMPORTED_MODULE_1__/* .srgbTextureToLinear */ .sP)(device, texture);\n    if (mips)\n        void (0,_texture_processing__WEBPACK_IMPORTED_MODULE_1__/* .generateMips */ .fF)(device, texture);\n    return texture;\n}\nfunction parseHDR(inData) {\n    const decoder = new TextDecoder();\n    const buffer = inData instanceof Uint8Array ? inData : new Uint8Array(inData);\n    let pos = 0;\n    const getLine = (lineLimit = 1024) => {\n        const limit = Math.min(buffer.length, lineLimit + pos);\n        const sub = buffer.subarray(pos, limit);\n        const end = sub.indexOf(0x0A) + 1;\n        pos += end;\n        return end === 0 ? undefined : decoder.decode(sub.subarray(0, end));\n    };\n    const importError = (msg) => new Error('HDR Import Error: ' + msg);\n    // #region Read Header\n    const magicTokenRegex = /^#\\?(\\S+)/;\n    const magicTokenLine = getLine();\n    if (magicTokenLine == null)\n        throw importError('no header found');\n    if (!magicTokenRegex.test(magicTokenLine))\n        throw importError('bad initial token');\n    const headerRegs = [\n        /FORMAT=(?<format>\\S+)/, // format\n        /-Y\\s+(?<Y>\\d+)\\s+\\+X\\s+(?<X>\\d+)/, // size\n        /EXPOSURE\\s*=\\s*(?<exposure>\\d+(\\.\\d+)?)/, // exposure\n        /GAMMA\\s*=\\s*(?<gamma>\\d+(\\.\\d+)?)/, // gamma\n    ];\n    const headerReg = new RegExp(`^\\\\s*(${headerRegs.map(({ source }) => `(${source})`).join('|')})\\\\s*$`);\n    let noFormat = true;\n    let gamma = 1; /* a value of 1.0 in an image corresponds to <exposure> watts/steradian/m^2. defaults to 1.0 */\n    let exposure = 1; /* image has already been gamma corrected with given gamma. defaults to 1.0 (no correction) */\n    let width = undefined;\n    let height = undefined;\n    for (let line = getLine(); line != null; line = width == null ? getLine() : undefined) {\n        const groups = line.match(headerReg)?.groups;\n        if (groups == null)\n            continue;\n        if (groups.format != null) {\n            noFormat = false;\n        }\n        else if (groups.X != null && groups.Y != null) {\n            width = parseInt(groups.X);\n            height = parseInt(groups.Y);\n        }\n        else if (groups.gamma != null) {\n            gamma = parseFloat(groups.gamma);\n        }\n        else if (groups.exposure != null) {\n            exposure = parseFloat(groups.exposure);\n        }\n    }\n    if (noFormat)\n        throw importError('missing format specifier');\n    if (width == null || height == null)\n        throw importError('missing image size specifier');\n    // #endregion\n    // #region Read Scanline Data\n    let rawData;\n    const unencodable = width < 8 || width > 0x7fff;\n    const flatData = buffer[pos] !== 2 || buffer[pos + 1] !== 2 || (buffer[pos + 2] & 0x80) !== 0;\n    if (unencodable || flatData) {\n        rawData = buffer.subarray(pos);\n    }\n    else {\n        rawData = new Uint8Array(width * height * 4);\n        const end = 4 * width;\n        const scanline_buffer = new Uint8Array(end);\n        const len = buffer.byteLength;\n        for (let k = 0, offset = 0; k < height && pos < len; k++) {\n            if (pos + 4 > len)\n                throw importError('file ended durning scanline');\n            if ((2 != buffer[pos++]) || (2 != buffer[pos++]) || (((buffer[pos++] << 8) | buffer[pos++]) != width))\n                throw importError('bad rgbe scanline format');\n            let count;\n            for (let ptr = 0; ptr < end && pos < len; ptr += count) {\n                count = buffer[pos++];\n                const isEncodedRun = count > 128;\n                if (isEncodedRun)\n                    count -= 128;\n                if (count == 0 || ptr + count > end)\n                    throw importError('bad scanline data');\n                if (isEncodedRun) {\n                    scanline_buffer.fill(buffer[pos], ptr, ptr + count);\n                    pos += 1;\n                }\n                else {\n                    scanline_buffer.set(buffer.subarray(pos, pos + count), ptr);\n                    pos += count;\n                }\n            }\n            for (let i = 0; i < width; i++)\n                for (let j = 0; j < end; j += width)\n                    rawData[offset++] = scanline_buffer[i + j];\n        }\n    }\n    // #endregion\n    // #region Convert to Float16\n    const data = new Uint16Array(rawData.length);\n    const float16One = (0,_data_conversion__WEBPACK_IMPORTED_MODULE_0__/* .toFloat16Bytes */ .Q)(1);\n    for (let i = 0; i < width * height * 4; i += 4) {\n        const raw_e = rawData[i + 3];\n        const scale = Math.pow(2.0, raw_e - 128.0) / 255.0;\n        for (let j = 0; j < 3; j += 1) {\n            data[i + j] = (0,_data_conversion__WEBPACK_IMPORTED_MODULE_0__/* .toFloat16Bytes */ .Q)(Math.min(rawData[i + j] * scale, 65504));\n        }\n        data[i + 3] = float16One;\n    }\n    // #endregion\n    return { data, width, height, gamma, exposure };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxDQUFDO0lBQzdDLE1BQU0sVUFBVSxHQUFHLHlFQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFckMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssR0FBRyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUM3QyxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzdCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssR0FBRyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUM7UUFFbkQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDNUIsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyx5RUFBYyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMxRSxDQUFDO1FBQ0QsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUM7SUFDN0IsQ0FBQztJQUNELGFBQWE7SUFFYixPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxDQUFDO0FBQ3BELENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvdXRpbHMvdGV4dHVyZS1pbXBvcnRpbmcudHM/NDI1MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0b0Zsb2F0MTZCeXRlcyB9IGZyb20gJy4vZGF0YS1jb252ZXJzaW9uJztcbmltcG9ydCB7IHNyZ2JUZXh0dXJlVG9MaW5lYXIsIGdlbmVyYXRlTWlwcyB9IGZyb20gJy4vdGV4dHVyZS1wcm9jZXNzaW5nJztcblxuZXhwb3J0IHR5cGUgaW1hZ2VUb1RleHR1cmVEZXNjcmlwdG9yID0ge1xuICAgIGRldmljZTogR1BVRGV2aWNlLFxuICAgIGRhdGE6IFVpbnQ4QXJyYXksXG4gICAgbWltZVR5cGU/OiBzdHJpbmcsXG4gICAgbGFiZWw/OiBzdHJpbmcsXG4gICAgdXNhZ2U/OiBudW1iZXIsXG4gICAgZm9ybWF0PzogR1BVVGV4dHVyZUZvcm1hdCxcbiAgICBtaXBzPzogYm9vbGVhbixcbiAgICBzcmdiVG9MaW5lYXI/OiBib29sZWFuLFxuICAgIGNvbG9yU3BhY2U/OiBQcmVkZWZpbmVkQ29sb3JTcGFjZSxcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbWFnZVRvVGV4dHVyZSh7XG4gICAgZGV2aWNlLFxuICAgIGRhdGEsXG4gICAgbWltZVR5cGUsXG4gICAgdXNhZ2UgPSBHUFVUZXh0dXJlVXNhZ2UuVEVYVFVSRV9CSU5ESU5HLFxuICAgIG1pcHMgPSB0cnVlLFxuICAgIGZvcm1hdCA9ICdyZ2JhOHVub3JtJyxcbiAgICBjb2xvclNwYWNlID0gJ3NyZ2InLFxuICAgIGxhYmVsID0gJycsXG4gICAgc3JnYlRvTGluZWFyLFxufTogaW1hZ2VUb1RleHR1cmVEZXNjcmlwdG9yKSB7XG4gICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwgeyB0eXBlOiBtaW1lVHlwZSB9KTtcbiAgICBjb25zdCBiaXRtYXAgPSBhd2FpdCBjcmVhdGVJbWFnZUJpdG1hcChibG9iLCB7IGNvbG9yU3BhY2VDb252ZXJzaW9uOiAnbm9uZScgfSk7XG4gICAgY29uc3Qgc2l6ZSA9IHsgd2lkdGg6IGJpdG1hcC53aWR0aCwgaGVpZ2h0OiBiaXRtYXAuaGVpZ2h0IH07XG5cbiAgICBjb25zdCB0ZXh0dXJlID0gZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgZm9ybWF0LFxuICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICB1c2FnZTogdXNhZ2UgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9EU1QgfCBHUFVUZXh0dXJlVXNhZ2UuQ09QWV9TUkMgfCBHUFVUZXh0dXJlVXNhZ2UuUkVOREVSX0FUVEFDSE1FTlQsXG4gICAgICAgIG1pcExldmVsQ291bnQ6IG1pcHMgPyAxICsgKE1hdGgubG9nMihNYXRoLm1heChiaXRtYXAud2lkdGgsIGJpdG1hcC5oZWlnaHQpKSB8IDApIDogMSxcbiAgICB9KTtcblxuICAgIGRldmljZS5xdWV1ZS5jb3B5RXh0ZXJuYWxJbWFnZVRvVGV4dHVyZShcbiAgICAgICAgeyBzb3VyY2U6IGJpdG1hcCB9LFxuICAgICAgICB7IHRleHR1cmUsIGNvbG9yU3BhY2UgfSxcbiAgICAgICAgc2l6ZSxcbiAgICApO1xuXG4gICAgaWYgKHNyZ2JUb0xpbmVhcikgc3JnYlRleHR1cmVUb0xpbmVhcihkZXZpY2UsIHRleHR1cmUpO1xuICAgIGlmIChtaXBzKSB2b2lkIGdlbmVyYXRlTWlwcyhkZXZpY2UsIHRleHR1cmUpO1xuXG4gICAgcmV0dXJuIHRleHR1cmU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUhEUihpbkRhdGE6IFVpbnQ4QXJyYXkgfCBBcnJheUJ1ZmZlcikge1xuICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICBjb25zdCBidWZmZXIgPSBpbkRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gaW5EYXRhIDogbmV3IFVpbnQ4QXJyYXkoaW5EYXRhKTtcbiAgICBsZXQgcG9zID0gMDtcblxuICAgIGNvbnN0IGdldExpbmUgPSAobGluZUxpbWl0ID0gMTAyNCkgPT4ge1xuICAgICAgICBjb25zdCBsaW1pdCA9IE1hdGgubWluKGJ1ZmZlci5sZW5ndGgsIGxpbmVMaW1pdCArIHBvcyk7XG4gICAgICAgIGNvbnN0IHN1YiA9IGJ1ZmZlci5zdWJhcnJheShwb3MsIGxpbWl0KTtcbiAgICAgICAgY29uc3QgZW5kID0gc3ViLmluZGV4T2YoMHgwQSkgKyAxO1xuICAgICAgICBwb3MgKz0gZW5kO1xuICAgICAgICByZXR1cm4gZW5kID09PSAwID8gdW5kZWZpbmVkIDogZGVjb2Rlci5kZWNvZGUoc3ViLnN1YmFycmF5KDAsIGVuZCkpO1xuICAgIH07XG5cbiAgICBjb25zdCBpbXBvcnRFcnJvciA9IChtc2c6IHN0cmluZykgPT4gbmV3IEVycm9yKCdIRFIgSW1wb3J0IEVycm9yOiAnICsgbXNnKTtcblxuICAgIC8vICNyZWdpb24gUmVhZCBIZWFkZXJcbiAgICBjb25zdCBtYWdpY1Rva2VuUmVnZXggPSAvXiNcXD8oXFxTKykvO1xuICAgIGNvbnN0IG1hZ2ljVG9rZW5MaW5lID0gZ2V0TGluZSgpO1xuXG4gICAgaWYgKG1hZ2ljVG9rZW5MaW5lID09IG51bGwpIHRocm93IGltcG9ydEVycm9yKCdubyBoZWFkZXIgZm91bmQnKTtcbiAgICBpZiAoIW1hZ2ljVG9rZW5SZWdleC50ZXN0KG1hZ2ljVG9rZW5MaW5lKSkgdGhyb3cgaW1wb3J0RXJyb3IoJ2JhZCBpbml0aWFsIHRva2VuJyk7XG5cbiAgICBjb25zdCBoZWFkZXJSZWdzID0gW1xuICAgICAgICAvRk9STUFUPSg/PGZvcm1hdD5cXFMrKS8sIC8vIGZvcm1hdFxuICAgICAgICAvLVlcXHMrKD88WT5cXGQrKVxccytcXCtYXFxzKyg/PFg+XFxkKykvLCAvLyBzaXplXG4gICAgICAgIC9FWFBPU1VSRVxccyo9XFxzKig/PGV4cG9zdXJlPlxcZCsoXFwuXFxkKyk/KS8sIC8vIGV4cG9zdXJlXG4gICAgICAgIC9HQU1NQVxccyo9XFxzKig/PGdhbW1hPlxcZCsoXFwuXFxkKyk/KS8sIC8vIGdhbW1hXG4gICAgXTtcblxuICAgIGNvbnN0IGhlYWRlclJlZyA9IG5ldyBSZWdFeHAoYF5cXFxccyooJHtcbiAgICAgICAgaGVhZGVyUmVncy5tYXAoKHsgc291cmNlIH0pID0+IGAoJHtzb3VyY2V9KWApLmpvaW4oJ3wnKVxuICAgIH0pXFxcXHMqJGApO1xuXG4gICAgbGV0IG5vRm9ybWF0ID0gdHJ1ZTtcbiAgICBsZXQgZ2FtbWEgPSAxOyAvKiBhIHZhbHVlIG9mIDEuMCBpbiBhbiBpbWFnZSBjb3JyZXNwb25kcyB0byA8ZXhwb3N1cmU+IHdhdHRzL3N0ZXJhZGlhbi9tXjIuIGRlZmF1bHRzIHRvIDEuMCAqL1xuICAgIGxldCBleHBvc3VyZSA9IDE7IC8qIGltYWdlIGhhcyBhbHJlYWR5IGJlZW4gZ2FtbWEgY29ycmVjdGVkIHdpdGggZ2l2ZW4gZ2FtbWEuIGRlZmF1bHRzIHRvIDEuMCAobm8gY29ycmVjdGlvbikgKi9cbiAgICBsZXQgd2lkdGg6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICBsZXQgaGVpZ2h0OiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbiAgICBmb3IgKGxldCBsaW5lID0gZ2V0TGluZSgpOyBsaW5lICE9IG51bGw7IGxpbmUgPSB3aWR0aCA9PSBudWxsID8gZ2V0TGluZSgpIDogdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGdyb3VwcyA9IGxpbmUubWF0Y2goaGVhZGVyUmVnKT8uZ3JvdXBzIGFzIFBhcnRpYWw8UmVjb3JkPHN0cmluZywgc3RyaW5nPj4gfCB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChncm91cHMgPT0gbnVsbCkgY29udGludWU7XG5cbiAgICAgICAgaWYgKGdyb3Vwcy5mb3JtYXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgbm9Gb3JtYXQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIGlmIChncm91cHMuWCAhPSBudWxsICYmIGdyb3Vwcy5ZICE9IG51bGwpIHtcbiAgICAgICAgICAgIHdpZHRoID0gcGFyc2VJbnQoZ3JvdXBzLlgpO1xuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQoZ3JvdXBzLlkpO1xuICAgICAgICB9IGVsc2UgaWYgKGdyb3Vwcy5nYW1tYSAhPSBudWxsKSB7XG4gICAgICAgICAgICBnYW1tYSA9IHBhcnNlRmxvYXQoZ3JvdXBzLmdhbW1hKTtcbiAgICAgICAgfSBlbHNlIGlmIChncm91cHMuZXhwb3N1cmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgZXhwb3N1cmUgPSBwYXJzZUZsb2F0KGdyb3Vwcy5leHBvc3VyZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobm9Gb3JtYXQpIHRocm93IGltcG9ydEVycm9yKCdtaXNzaW5nIGZvcm1hdCBzcGVjaWZpZXInKTtcbiAgICBpZiAod2lkdGggPT0gbnVsbCB8fCBoZWlnaHQgPT0gbnVsbCkgdGhyb3cgaW1wb3J0RXJyb3IoJ21pc3NpbmcgaW1hZ2Ugc2l6ZSBzcGVjaWZpZXInKTtcbiAgICAvLyAjZW5kcmVnaW9uXG5cbiAgICAvLyAjcmVnaW9uIFJlYWQgU2NhbmxpbmUgRGF0YVxuICAgIGxldCByYXdEYXRhOiBVaW50OEFycmF5O1xuICAgIGNvbnN0IHVuZW5jb2RhYmxlID0gd2lkdGggPCA4IHx8IHdpZHRoID4gMHg3ZmZmO1xuICAgIGNvbnN0IGZsYXREYXRhID0gYnVmZmVyW3Bvc10gIT09IDIgfHwgYnVmZmVyW3BvcyArIDFdICE9PSAyIHx8IChidWZmZXJbcG9zICsgMl0gJiAweDgwKSAhPT0gMDtcblxuICAgIGlmICh1bmVuY29kYWJsZSB8fCBmbGF0RGF0YSkge1xuICAgICAgICByYXdEYXRhID0gYnVmZmVyLnN1YmFycmF5KHBvcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmF3RGF0YSA9IG5ldyBVaW50OEFycmF5KHdpZHRoICogaGVpZ2h0ICogNCk7XG4gICAgICAgIGNvbnN0IGVuZCA9IDQgKiB3aWR0aDtcbiAgICAgICAgY29uc3Qgc2NhbmxpbmVfYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoZW5kKTtcbiAgICAgICAgY29uc3QgbGVuID0gYnVmZmVyLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgZm9yIChsZXQgayA9IDAsIG9mZnNldCA9IDA7IGsgPCBoZWlnaHQgJiYgcG9zIDwgbGVuOyBrKyspIHtcbiAgICAgICAgICAgIGlmIChwb3MgKyA0ID4gbGVuKVxuICAgICAgICAgICAgICAgIHRocm93IGltcG9ydEVycm9yKCdmaWxlIGVuZGVkIGR1cm5pbmcgc2NhbmxpbmUnKTtcblxuICAgICAgICAgICAgaWYgKCgyICE9IGJ1ZmZlcltwb3MrK10pIHx8ICgyICE9IGJ1ZmZlcltwb3MrK10pIHx8ICgoKGJ1ZmZlcltwb3MrK10gPDwgOCkgfCBidWZmZXJbcG9zKytdKSAhPSB3aWR0aCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgaW1wb3J0RXJyb3IoJ2JhZCByZ2JlIHNjYW5saW5lIGZvcm1hdCcpO1xuXG4gICAgICAgICAgICBsZXQgY291bnQ7XG4gICAgICAgICAgICBmb3IgKGxldCBwdHIgPSAwOyBwdHIgPCBlbmQgJiYgcG9zIDwgbGVuOyBwdHIgKz0gY291bnQpIHtcbiAgICAgICAgICAgICAgICBjb3VudCA9IGJ1ZmZlcltwb3MrK107XG4gICAgICAgICAgICAgICAgY29uc3QgaXNFbmNvZGVkUnVuID0gY291bnQgPiAxMjg7XG4gICAgICAgICAgICAgICAgaWYgKGlzRW5jb2RlZFJ1bikgY291bnQgLT0gMTI4O1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID09IDAgfHwgcHRyICsgY291bnQgPiBlbmQpXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGltcG9ydEVycm9yKCdiYWQgc2NhbmxpbmUgZGF0YScpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRW5jb2RlZFJ1bikge1xuICAgICAgICAgICAgICAgICAgICBzY2FubGluZV9idWZmZXIuZmlsbChidWZmZXJbcG9zXSwgcHRyLCBwdHIgKyBjb3VudCk7XG4gICAgICAgICAgICAgICAgICAgIHBvcyArPSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYW5saW5lX2J1ZmZlci5zZXQoYnVmZmVyLnN1YmFycmF5KHBvcywgcG9zICsgY291bnQpLCBwdHIpO1xuICAgICAgICAgICAgICAgICAgICBwb3MgKz0gY291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdpZHRoOyBpKyspXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBlbmQ7IGogKz0gd2lkdGgpXG4gICAgICAgICAgICAgICAgICAgIHJhd0RhdGFbb2Zmc2V0KytdID0gc2NhbmxpbmVfYnVmZmVyW2kgKyBqXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyAjZW5kcmVnaW9uXG5cbiAgICAvLyAjcmVnaW9uIENvbnZlcnQgdG8gRmxvYXQxNlxuICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDE2QXJyYXkocmF3RGF0YS5sZW5ndGgpO1xuICAgIGNvbnN0IGZsb2F0MTZPbmUgPSB0b0Zsb2F0MTZCeXRlcygxKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2lkdGggKiBoZWlnaHQgKiA0OyBpICs9IDQpIHtcbiAgICAgICAgY29uc3QgcmF3X2UgPSByYXdEYXRhW2kgKyAzXTtcbiAgICAgICAgY29uc3Qgc2NhbGUgPSBNYXRoLnBvdygyLjAsIHJhd19lIC0gMTI4LjApIC8gMjU1LjA7XG5cbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqICs9IDEpIHtcbiAgICAgICAgICAgIGRhdGFbaSArIGpdID0gdG9GbG9hdDE2Qnl0ZXMoTWF0aC5taW4ocmF3RGF0YVtpICsgal0gKiBzY2FsZSwgNjU1MDQpKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhW2kgKyAzXSA9IGZsb2F0MTZPbmU7XG4gICAgfVxuICAgIC8vICNlbmRyZWdpb25cblxuICAgIHJldHVybiB7IGRhdGEsIHdpZHRoLCBoZWlnaHQsIGdhbW1hLCBleHBvc3VyZSB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2253\n")},7335:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fF: () => (/* binding */ generateMips),\n/* harmony export */   l3: () => (/* binding */ equirectangularToCubemap),\n/* harmony export */   sP: () => (/* binding */ srgbTextureToLinear)\n/* harmony export */ });\n/* harmony import */ var _shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7959);\n/* harmony import */ var _shaders_cubemap_sampling_shader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(423);\n/* harmony import */ var _data_copy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6182);\n/* harmony import */ var _general__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(80);\n\n\n\n\nasync function equirectangularToCubemap(device, { data, width, height, gamma = 1, exposure = 1 }, outputDescriptor) {\n    const code = /* wgsl */ `\n        override EXPOSURE: f32 = 1.0;\n        override GAMMA: f32 = 1.0;\n        override FLIP_Y: bool = false;\n\n        @group(0) @binding(0) var equirectangularMap: texture_2d<f32>;\n        @group(0) @binding(1) var mapSampler: sampler;\n        @group(0) @binding(2) var<uniform> face: u32;\n\n        fn sampleSphericalMap(v: vec3f) -> vec2f {\n            const invAtan = vec2(0.1591, 0.3183);\n\n            var uv = vec2(atan2(v.z, v.x), asin(v.y));\n            uv *= invAtan;\n            uv += 0.5;\n            return uv;\n        }\n \n        ${_shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A}\n        ${_shaders_cubemap_sampling_shader__WEBPACK_IMPORTED_MODULE_2__/* .toWorldDir */ .V}\n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f {\n            var dir = toWorldDirF32(uv, face);\n            dir = vec3(dir.z, dir.y, -dir.x);\n            var coord = sampleSphericalMap(dir);\n            if (FLIP_Y) { coord.y = 1 - coord.y; }\n\n            var color = textureSample(equirectangularMap, mapSampler, coord).rgb;\n            if (GAMMA != 1.0) { color = pow(color, vec3(1.0 / GAMMA)); }\n            if (EXPOSURE != 1.0) { color /= EXPOSURE; }\n            return vec4(color, 1.0);\n        }\n    `;\n    let FLIP_Y = 0;\n    let equirectangular;\n    if (data instanceof GPUTexture) {\n        equirectangular = data;\n    }\n    else {\n        FLIP_Y = 1;\n        equirectangular = device.createTexture({\n            label: `${outputDescriptor.label} equirectangular`,\n            dimension: '2d',\n            format: 'rgba16float',\n            size: { width, height },\n            usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n        });\n        device.queue.writeTexture({ texture: equirectangular, mipLevel: 0 }, data, { bytesPerRow: width * 2 * 4 }, { width, height, depthOrArrayLayers: 1 });\n        await device.queue.onSubmittedWorkDone();\n    }\n    const faceSize = equirectangular.height >> 1;\n    const cubemapDescriptor = outputDescriptor;\n    cubemapDescriptor.mipLevelCount ??= Math.log2(faceSize) | 0;\n    cubemapDescriptor.size = { width: faceSize, height: faceSize, depthOrArrayLayers: 6 };\n    cubemapDescriptor.dimension = '2d';\n    cubemapDescriptor.usage |= GPUTextureUsage.RENDER_ATTACHMENT;\n    const cubemap = device.createTexture(cubemapDescriptor);\n    const label = (0,_general__WEBPACK_IMPORTED_MODULE_3__/* .padTemplate */ .OY) `hdr copy${outputDescriptor.label}`;\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 2,\n                buffer: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const module = device.createShaderModule({ label, code });\n    const sampler = device.createSampler({ label, minFilter: 'linear', magFilter: 'linear' });\n    const params = new Uint32Array(1);\n    const paramBuffer = (0,_data_copy__WEBPACK_IMPORTED_MODULE_0__/* .createAndCopyBuffer */ .Lr)(params, GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM, device, label);\n    const bindgroup = device.createBindGroup({\n        label,\n        layout: bindgroupLayout,\n        entries: [\n            { binding: 0, resource: equirectangular.createView() },\n            { binding: 1, resource: sampler },\n            { binding: 2, resource: { buffer: paramBuffer } },\n        ],\n    });\n    const pipelineLayout = device.createPipelineLayout({\n        label,\n        bindGroupLayouts: [bindgroupLayout],\n    });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: { module },\n        fragment: {\n            module,\n            targets: [{ format: cubemap.format }],\n            constants: {\n                GAMMA: gamma,\n                EXPOSURE: exposure,\n                FLIP_Y,\n            },\n        },\n    });\n    for (let i = 0; i < 6; i += 1) {\n        params[0] = i;\n        device.queue.writeBuffer(paramBuffer, 0, params, 0, 1);\n        const view = cubemap.createView({\n            dimension: '2d',\n            arrayLayerCount: 1,\n            baseArrayLayer: i,\n            mipLevelCount: 1,\n        });\n        const encoder = device.createCommandEncoder();\n        const pass = encoder.beginRenderPass({\n            label,\n            colorAttachments: [{\n                    view,\n                    loadOp: 'clear',\n                    storeOp: 'store',\n                }],\n        });\n        pass.setPipeline(pipeline);\n        pass.setBindGroup(0, bindgroup);\n        pass.draw(3);\n        pass.end();\n        device.queue.submit([encoder.finish()]);\n    }\n    return cubemap;\n}\nasync function generateMips(device, texture) {\n    const code = /* wgsl */ `\n        @group(0) @binding(0) var image: texture_2d<f32>;\n        @group(0) @binding(1) var mipSampler: sampler;\n\n        ${_shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A}\n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f {\n            return textureSample(image, mipSampler, uv);\n        }\n    `;\n    const label = (0,_general__WEBPACK_IMPORTED_MODULE_3__/* .padTemplate */ .OY) `mip generation${texture.label}`;\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: { viewDimension: '2d', sampleType: 'float' },\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const colorAttachment = {\n        view: undefined,\n        loadOp: 'clear',\n        storeOp: 'store',\n    };\n    const sampler = device.createSampler({\n        minFilter: 'linear',\n        magFilter: 'linear',\n    });\n    const module = device.createShaderModule({ label, code });\n    const pipelineLayout = device.createPipelineLayout({ label, bindGroupLayouts: [bindgroupLayout] });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            entryPoint: 'vs',\n            module,\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format: texture.format }],\n            module,\n        },\n    });\n    colorAttachment.view = texture.createView({ mipLevelCount: 1, baseMipLevel: 0 });\n    await device.queue.onSubmittedWorkDone();\n    for (let i = 1; i < texture.mipLevelCount; i += 1) {\n        const bindgroup = device.createBindGroup({\n            label,\n            layout: bindgroupLayout,\n            entries: [\n                {\n                    binding: 0,\n                    resource: colorAttachment.view,\n                },\n                {\n                    binding: 1,\n                    resource: sampler,\n                },\n            ],\n        });\n        colorAttachment.view = texture.createView({ mipLevelCount: 1, baseMipLevel: i });\n        const encoder = device.createCommandEncoder();\n        const pass = encoder.beginRenderPass({\n            label,\n            colorAttachments: [colorAttachment],\n        });\n        pass.setPipeline(pipeline);\n        pass.setBindGroup(0, bindgroup);\n        pass.draw(3);\n        pass.end();\n        device.queue.submit([encoder.finish()]);\n        await device.queue.onSubmittedWorkDone();\n    }\n}\nfunction srgbTextureToLinear(device, texture) {\n    const code = /* wgsl */ `\n        @group(0) @binding(0) var image: texture_2d<f32>;\n        @group(0) @binding(1) var imageSampler: sampler;\n\n        ${_shaders_blit_vert_shader__WEBPACK_IMPORTED_MODULE_1__/* [\"default\"] */ .A}\n\n        fn sRGBToLinear(color: vec3f) -> vec3f {\n            return select( \n                pow(color * 0.9478672986 + 0.0521327014, vec3(2.4)), \n                color * 0.0773993808, \n                color <= vec3(0.04045), \n            );\n        }  \n\n        @fragment\n        fn fs(@location(0) uv: vec2f) -> @location(0) vec4f  {\n            let sample = textureSample(image, imageSampler, uv);\n            let color = sRGBToLinear(sample.rgb);\n            return vec4(color, sample.a);\n        }\n    `;\n    const label = (0,_general__WEBPACK_IMPORTED_MODULE_3__/* .padTemplate */ .OY) `srgb to linear${texture.label}`;\n    const size = { width: texture.width, height: texture.height };\n    const tempTexture = device.createTexture({\n        format: texture.format,\n        usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n        size,\n    });\n    const bindgroupLayout = device.createBindGroupLayout({\n        label,\n        entries: [\n            {\n                binding: 0,\n                texture: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n            {\n                binding: 1,\n                sampler: {},\n                visibility: GPUShaderStage.FRAGMENT,\n            },\n        ],\n    });\n    const sampler = device.createSampler({\n        minFilter: 'linear',\n        magFilter: 'linear',\n    });\n    const module = device.createShaderModule({ label, code: code });\n    const pipelineLayout = device.createPipelineLayout({ label, bindGroupLayouts: [bindgroupLayout] });\n    const pipeline = device.createRenderPipeline({\n        label,\n        layout: pipelineLayout,\n        vertex: {\n            entryPoint: 'vs',\n            module,\n        },\n        fragment: {\n            entryPoint: 'fs',\n            targets: [{ format: texture.format }],\n            module,\n        },\n    });\n    const bindgroup = device.createBindGroup({\n        label,\n        layout: bindgroupLayout,\n        entries: [\n            {\n                binding: 0,\n                resource: tempTexture.createView(),\n            },\n            {\n                binding: 1,\n                resource: sampler,\n            },\n        ],\n    });\n    const encoder = device.createCommandEncoder();\n    encoder.copyTextureToTexture({ texture }, { texture: tempTexture }, size);\n    const pass = encoder.beginRenderPass({\n        label,\n        colorAttachments: [{\n                view: texture.createView({ mipLevelCount: 1, baseMipLevel: 0 }),\n                loadOp: 'clear',\n                storeOp: 'store',\n            }],\n    });\n    pass.setPipeline(pipeline);\n    pass.setBindGroup(0, bindgroup);\n    pass.draw(3);\n    pass.end();\n    device.queue.submit([encoder.finish()]);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsb0JBQW9CLENBQ3hCLEVBQUUsT0FBTyxFQUFFLEVBQ1gsRUFBRSxPQUFPLEVBQUUsV0FBVyxFQUFFLEVBQ3hCLElBQUksQ0FDUCxDQUFDO0lBRUYsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLGVBQWUsQ0FBQztRQUNqQyxLQUFLO1FBQ0wsZ0JBQWdCLEVBQUUsQ0FBQztnQkFDZixJQUFJLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxDQUFDLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxDQUFDO2dCQUMvRCxNQUFNLEVBQUUsT0FBTztnQkFDZixPQUFPLEVBQUUsT0FBTzthQUNuQixDQUFDO0tBQ0wsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMzQixJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2IsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBRVgsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzVDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jYnVudC1wb3J0Zm9saW8vLi9zcmMvdXRpbHMvdGV4dHVyZS1wcm9jZXNzaW5nLnRzPzc2NDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJsaXQgZnJvbSAnLi4vc2hhZGVycy9ibGl0LXZlcnQuc2hhZGVyJztcbmltcG9ydCB7IHRvV29ybGREaXIgfSBmcm9tICcuLi9zaGFkZXJzL2N1YmVtYXAtc2FtcGxpbmcuc2hhZGVyJztcbmltcG9ydCB7IGNyZWF0ZUFuZENvcHlCdWZmZXIgfSBmcm9tICcuL2RhdGEtY29weSc7XG5pbXBvcnQgeyBwYWRUZW1wbGF0ZSB9IGZyb20gJy4vZ2VuZXJhbCc7XG5cbnR5cGUgRXF1aXJlY3Rhbmd1bGFyRGVzY3JpcHRvciA9IHtcbiAgICBkYXRhOiBTaGFyZWRBcnJheUJ1ZmZlciB8IEJ1ZmZlclNvdXJjZSB8IEdQVVRleHR1cmUsXG4gICAgd2lkdGg6IG51bWJlcixcbiAgICBoZWlnaHQ6IG51bWJlcixcbiAgICBnYW1tYT86IG51bWJlcixcbiAgICBleHBvc3VyZT86IG51bWJlcixcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlcXVpcmVjdGFuZ3VsYXJUb0N1YmVtYXAoXG4gICAgZGV2aWNlOiBHUFVEZXZpY2UsXG4gICAgeyBkYXRhLCB3aWR0aCwgaGVpZ2h0LCBnYW1tYSA9IDEsIGV4cG9zdXJlID0gMSB9OiBFcXVpcmVjdGFuZ3VsYXJEZXNjcmlwdG9yLFxuICAgIG91dHB1dERlc2NyaXB0b3I6IE9taXQ8R1BVVGV4dHVyZURlc2NyaXB0b3IsICdkaW1lbnNpb24nIHwgJ3NpemUnPixcbikge1xuICAgIGNvbnN0IGNvZGUgPSAvKiB3Z3NsICovIGBcbiAgICAgICAgb3ZlcnJpZGUgRVhQT1NVUkU6IGYzMiA9IDEuMDtcbiAgICAgICAgb3ZlcnJpZGUgR0FNTUE6IGYzMiA9IDEuMDtcbiAgICAgICAgb3ZlcnJpZGUgRkxJUF9ZOiBib29sID0gZmFsc2U7XG5cbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDApIHZhciBlcXVpcmVjdGFuZ3VsYXJNYXA6IHRleHR1cmVfMmQ8ZjMyPjtcbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDEpIHZhciBtYXBTYW1wbGVyOiBzYW1wbGVyO1xuICAgICAgICBAZ3JvdXAoMCkgQGJpbmRpbmcoMikgdmFyPHVuaWZvcm0+IGZhY2U6IHUzMjtcblxuICAgICAgICBmbiBzYW1wbGVTcGhlcmljYWxNYXAodjogdmVjM2YpIC0+IHZlYzJmIHtcbiAgICAgICAgICAgIGNvbnN0IGludkF0YW4gPSB2ZWMyKDAuMTU5MSwgMC4zMTgzKTtcblxuICAgICAgICAgICAgdmFyIHV2ID0gdmVjMihhdGFuMih2LnosIHYueCksIGFzaW4odi55KSk7XG4gICAgICAgICAgICB1diAqPSBpbnZBdGFuO1xuICAgICAgICAgICAgdXYgKz0gMC41O1xuICAgICAgICAgICAgcmV0dXJuIHV2O1xuICAgICAgICB9XG4gXG4gICAgICAgICR7YmxpdH1cbiAgICAgICAgJHt0b1dvcmxkRGlyfVxuXG4gICAgICAgIEBmcmFnbWVudFxuICAgICAgICBmbiBmcyhAbG9jYXRpb24oMCkgdXY6IHZlYzJmKSAtPiBAbG9jYXRpb24oMCkgdmVjNGYge1xuICAgICAgICAgICAgdmFyIGRpciA9IHRvV29ybGREaXJGMzIodXYsIGZhY2UpO1xuICAgICAgICAgICAgZGlyID0gdmVjMyhkaXIueiwgZGlyLnksIC1kaXIueCk7XG4gICAgICAgICAgICB2YXIgY29vcmQgPSBzYW1wbGVTcGhlcmljYWxNYXAoZGlyKTtcbiAgICAgICAgICAgIGlmIChGTElQX1kpIHsgY29vcmQueSA9IDEgLSBjb29yZC55OyB9XG5cbiAgICAgICAgICAgIHZhciBjb2xvciA9IHRleHR1cmVTYW1wbGUoZXF1aXJlY3Rhbmd1bGFyTWFwLCBtYXBTYW1wbGVyLCBjb29yZCkucmdiO1xuICAgICAgICAgICAgaWYgKEdBTU1BICE9IDEuMCkgeyBjb2xvciA9IHBvdyhjb2xvciwgdmVjMygxLjAgLyBHQU1NQSkpOyB9XG4gICAgICAgICAgICBpZiAoRVhQT1NVUkUgIT0gMS4wKSB7IGNvbG9yIC89IEVYUE9TVVJFOyB9XG4gICAgICAgICAgICByZXR1cm4gdmVjNChjb2xvciwgMS4wKTtcbiAgICAgICAgfVxuICAgIGA7XG5cbiAgICBsZXQgRkxJUF9ZID0gMDtcbiAgICBsZXQgZXF1aXJlY3Rhbmd1bGFyOiBHUFVUZXh0dXJlO1xuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgR1BVVGV4dHVyZSkge1xuICAgICAgICBlcXVpcmVjdGFuZ3VsYXIgPSBkYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIEZMSVBfWSA9IDE7XG4gICAgICAgIGVxdWlyZWN0YW5ndWxhciA9IGRldmljZS5jcmVhdGVUZXh0dXJlKHtcbiAgICAgICAgICAgIGxhYmVsOiBgJHtvdXRwdXREZXNjcmlwdG9yLmxhYmVsfSBlcXVpcmVjdGFuZ3VsYXJgLFxuICAgICAgICAgICAgZGltZW5zaW9uOiAnMmQnLFxuICAgICAgICAgICAgZm9ybWF0OiAncmdiYTE2ZmxvYXQnLFxuICAgICAgICAgICAgc2l6ZTogeyB3aWR0aCwgaGVpZ2h0IH0sXG4gICAgICAgICAgICB1c2FnZTogR1BVVGV4dHVyZVVzYWdlLkNPUFlfRFNUIHwgR1BVVGV4dHVyZVVzYWdlLlRFWFRVUkVfQklORElORyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGV2aWNlLnF1ZXVlLndyaXRlVGV4dHVyZShcbiAgICAgICAgICAgIHsgdGV4dHVyZTogZXF1aXJlY3Rhbmd1bGFyLCBtaXBMZXZlbDogMCB9LFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIHsgYnl0ZXNQZXJSb3c6IHdpZHRoICogMiAqIDQgfSxcbiAgICAgICAgICAgIHsgd2lkdGgsIGhlaWdodCwgZGVwdGhPckFycmF5TGF5ZXJzOiAxIH0sXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IGRldmljZS5xdWV1ZS5vblN1Ym1pdHRlZFdvcmtEb25lKCk7XG4gICAgfVxuXG4gICAgY29uc3QgZmFjZVNpemUgPSBlcXVpcmVjdGFuZ3VsYXIuaGVpZ2h0ID4+IDE7XG4gICAgY29uc3QgY3ViZW1hcERlc2NyaXB0b3IgPSBvdXRwdXREZXNjcmlwdG9yIGFzIEdQVVRleHR1cmVEZXNjcmlwdG9yO1xuICAgIGN1YmVtYXBEZXNjcmlwdG9yLm1pcExldmVsQ291bnQgPz89IE1hdGgubG9nMihmYWNlU2l6ZSkgfCAwO1xuICAgIGN1YmVtYXBEZXNjcmlwdG9yLnNpemUgPSB7IHdpZHRoOiBmYWNlU2l6ZSwgaGVpZ2h0OiBmYWNlU2l6ZSwgZGVwdGhPckFycmF5TGF5ZXJzOiA2IH07XG4gICAgY3ViZW1hcERlc2NyaXB0b3IuZGltZW5zaW9uID0gJzJkJztcbiAgICBjdWJlbWFwRGVzY3JpcHRvci51c2FnZSB8PSBHUFVUZXh0dXJlVXNhZ2UuUkVOREVSX0FUVEFDSE1FTlQ7XG4gICAgY29uc3QgY3ViZW1hcCA9IGRldmljZS5jcmVhdGVUZXh0dXJlKGN1YmVtYXBEZXNjcmlwdG9yKTtcblxuICAgIGNvbnN0IGxhYmVsID0gcGFkVGVtcGxhdGVgaGRyIGNvcHkke291dHB1dERlc2NyaXB0b3IubGFiZWx9YDtcbiAgICBjb25zdCBiaW5kZ3JvdXBMYXlvdXQgPSBkZXZpY2UuY3JlYXRlQmluZEdyb3VwTGF5b3V0KHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGVudHJpZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgICAgIHRleHR1cmU6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAxLFxuICAgICAgICAgICAgICAgIHNhbXBsZXI6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAyLFxuICAgICAgICAgICAgICAgIGJ1ZmZlcjoge30sXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogR1BVU2hhZGVyU3RhZ2UuRlJBR01FTlQsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0pO1xuXG4gICAgY29uc3QgbW9kdWxlID0gZGV2aWNlLmNyZWF0ZVNoYWRlck1vZHVsZSh7IGxhYmVsLCBjb2RlIH0pO1xuICAgIGNvbnN0IHNhbXBsZXIgPSBkZXZpY2UuY3JlYXRlU2FtcGxlcih7IGxhYmVsLCBtaW5GaWx0ZXI6ICdsaW5lYXInLCBtYWdGaWx0ZXI6ICdsaW5lYXInIH0pO1xuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVaW50MzJBcnJheSgxKTtcbiAgICBjb25zdCBwYXJhbUJ1ZmZlciA9IGNyZWF0ZUFuZENvcHlCdWZmZXIocGFyYW1zLCBHUFVCdWZmZXJVc2FnZS5DT1BZX0RTVCB8IEdQVUJ1ZmZlclVzYWdlLlVOSUZPUk0sIGRldmljZSwgbGFiZWwpO1xuXG4gICAgY29uc3QgYmluZGdyb3VwID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cCh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBsYXlvdXQ6IGJpbmRncm91cExheW91dCxcbiAgICAgICAgZW50cmllczogW1xuICAgICAgICAgICAgeyBiaW5kaW5nOiAwLCByZXNvdXJjZTogZXF1aXJlY3Rhbmd1bGFyLmNyZWF0ZVZpZXcoKSB9LFxuICAgICAgICAgICAgeyBiaW5kaW5nOiAxLCByZXNvdXJjZTogc2FtcGxlciB9LFxuICAgICAgICAgICAgeyBiaW5kaW5nOiAyLCByZXNvdXJjZTogeyBidWZmZXI6IHBhcmFtQnVmZmVyIH0gfSxcbiAgICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHBpcGVsaW5lTGF5b3V0ID0gZGV2aWNlLmNyZWF0ZVBpcGVsaW5lTGF5b3V0KHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGJpbmRHcm91cExheW91dHM6IFtiaW5kZ3JvdXBMYXlvdXRdLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcGlwZWxpbmUgPSBkZXZpY2UuY3JlYXRlUmVuZGVyUGlwZWxpbmUoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgbGF5b3V0OiBwaXBlbGluZUxheW91dCxcbiAgICAgICAgdmVydGV4OiB7IG1vZHVsZSB9LFxuICAgICAgICBmcmFnbWVudDoge1xuICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICAgICAgdGFyZ2V0czogW3sgZm9ybWF0OiBjdWJlbWFwLmZvcm1hdCB9XSxcbiAgICAgICAgICAgIGNvbnN0YW50czoge1xuICAgICAgICAgICAgICAgIEdBTU1BOiBnYW1tYSxcbiAgICAgICAgICAgICAgICBFWFBPU1VSRTogZXhwb3N1cmUsXG4gICAgICAgICAgICAgICAgRkxJUF9ZLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNjsgaSArPSAxKSB7XG4gICAgICAgIHBhcmFtc1swXSA9IGk7XG4gICAgICAgIGRldmljZS5xdWV1ZS53cml0ZUJ1ZmZlcihwYXJhbUJ1ZmZlciwgMCwgcGFyYW1zLCAwLCAxKTtcblxuICAgICAgICBjb25zdCB2aWV3ID0gY3ViZW1hcC5jcmVhdGVWaWV3KHtcbiAgICAgICAgICAgIGRpbWVuc2lvbjogJzJkJyxcbiAgICAgICAgICAgIGFycmF5TGF5ZXJDb3VudDogMSxcbiAgICAgICAgICAgIGJhc2VBcnJheUxheWVyOiBpLFxuICAgICAgICAgICAgbWlwTGV2ZWxDb3VudDogMSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZW5jb2RlciA9IGRldmljZS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuICAgICAgICBjb25zdCBwYXNzID0gZW5jb2Rlci5iZWdpblJlbmRlclBhc3Moe1xuICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICBjb2xvckF0dGFjaG1lbnRzOiBbe1xuICAgICAgICAgICAgICAgIHZpZXcsXG4gICAgICAgICAgICAgICAgbG9hZE9wOiAnY2xlYXInLFxuICAgICAgICAgICAgICAgIHN0b3JlT3A6ICdzdG9yZScsXG4gICAgICAgICAgICB9XSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcGFzcy5zZXRQaXBlbGluZShwaXBlbGluZSk7XG4gICAgICAgIHBhc3Muc2V0QmluZEdyb3VwKDAsIGJpbmRncm91cCk7XG4gICAgICAgIHBhc3MuZHJhdygzKTtcbiAgICAgICAgcGFzcy5lbmQoKTtcbiAgICAgICAgZGV2aWNlLnF1ZXVlLnN1Ym1pdChbZW5jb2Rlci5maW5pc2goKV0pO1xuICAgIH1cblxuICAgIHJldHVybiBjdWJlbWFwO1xufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlTWlwcyhkZXZpY2U6IEdQVURldmljZSwgdGV4dHVyZTogR1BVVGV4dHVyZSkge1xuICAgIGNvbnN0IGNvZGUgPSAvKiB3Z3NsICovIGBcbiAgICAgICAgQGdyb3VwKDApIEBiaW5kaW5nKDApIHZhciBpbWFnZTogdGV4dHVyZV8yZDxmMzI+O1xuICAgICAgICBAZ3JvdXAoMCkgQGJpbmRpbmcoMSkgdmFyIG1pcFNhbXBsZXI6IHNhbXBsZXI7XG5cbiAgICAgICAgJHtibGl0fVxuXG4gICAgICAgIEBmcmFnbWVudFxuICAgICAgICBmbiBmcyhAbG9jYXRpb24oMCkgdXY6IHZlYzJmKSAtPiBAbG9jYXRpb24oMCkgdmVjNGYge1xuICAgICAgICAgICAgcmV0dXJuIHRleHR1cmVTYW1wbGUoaW1hZ2UsIG1pcFNhbXBsZXIsIHV2KTtcbiAgICAgICAgfVxuICAgIGA7XG5cbiAgICBjb25zdCBsYWJlbCA9IHBhZFRlbXBsYXRlYG1pcCBnZW5lcmF0aW9uJHt0ZXh0dXJlLmxhYmVsfWA7XG5cbiAgICBjb25zdCBiaW5kZ3JvdXBMYXlvdXQgPSBkZXZpY2UuY3JlYXRlQmluZEdyb3VwTGF5b3V0KHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGVudHJpZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgICAgIHRleHR1cmU6IHsgdmlld0RpbWVuc2lvbjogJzJkJywgc2FtcGxlVHlwZTogJ2Zsb2F0JyB9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBiaW5kaW5nOiAxLFxuICAgICAgICAgICAgICAgIHNhbXBsZXI6IHt9LFxuICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IEdQVVNoYWRlclN0YWdlLkZSQUdNRU5ULFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNvbG9yQXR0YWNobWVudCA9IHtcbiAgICAgICAgdmlldzogdW5kZWZpbmVkIGFzIEdQVVRleHR1cmVWaWV3IHwgdW5kZWZpbmVkLFxuICAgICAgICBsb2FkT3A6ICdjbGVhcicsXG4gICAgICAgIHN0b3JlT3A6ICdzdG9yZScsXG4gICAgfTtcblxuICAgIGNvbnN0IHNhbXBsZXIgPSBkZXZpY2UuY3JlYXRlU2FtcGxlcih7XG4gICAgICAgIG1pbkZpbHRlcjogJ2xpbmVhcicsXG4gICAgICAgIG1hZ0ZpbHRlcjogJ2xpbmVhcicsXG4gICAgfSk7XG4gICAgY29uc3QgbW9kdWxlID0gZGV2aWNlLmNyZWF0ZVNoYWRlck1vZHVsZSh7IGxhYmVsLCBjb2RlIH0pO1xuICAgIGNvbnN0IHBpcGVsaW5lTGF5b3V0ID0gZGV2aWNlLmNyZWF0ZVBpcGVsaW5lTGF5b3V0KHsgbGFiZWwsIGJpbmRHcm91cExheW91dHM6IFtiaW5kZ3JvdXBMYXlvdXRdIH0pO1xuXG4gICAgY29uc3QgcGlwZWxpbmUgPSBkZXZpY2UuY3JlYXRlUmVuZGVyUGlwZWxpbmUoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgbGF5b3V0OiBwaXBlbGluZUxheW91dCxcbiAgICAgICAgdmVydGV4OiB7XG4gICAgICAgICAgICBlbnRyeVBvaW50OiAndnMnLFxuICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICB9LFxuICAgICAgICBmcmFnbWVudDoge1xuICAgICAgICAgICAgZW50cnlQb2ludDogJ2ZzJyxcbiAgICAgICAgICAgIHRhcmdldHM6IFt7IGZvcm1hdDogdGV4dHVyZS5mb3JtYXQgfV0sXG4gICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb2xvckF0dGFjaG1lbnQudmlldyA9IHRleHR1cmUuY3JlYXRlVmlldyh7IG1pcExldmVsQ291bnQ6IDEsIGJhc2VNaXBMZXZlbDogMCB9KTtcbiAgICBhd2FpdCBkZXZpY2UucXVldWUub25TdWJtaXR0ZWRXb3JrRG9uZSgpO1xuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPCB0ZXh0dXJlLm1pcExldmVsQ291bnQ7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBiaW5kZ3JvdXAgPSBkZXZpY2UuY3JlYXRlQmluZEdyb3VwKHtcbiAgICAgICAgICAgIGxhYmVsLFxuICAgICAgICAgICAgbGF5b3V0OiBiaW5kZ3JvdXBMYXlvdXQsXG4gICAgICAgICAgICBlbnRyaWVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBiaW5kaW5nOiAwLFxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZTogY29sb3JBdHRhY2htZW50LnZpZXcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGJpbmRpbmc6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJlc291cmNlOiBzYW1wbGVyLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb2xvckF0dGFjaG1lbnQudmlldyA9IHRleHR1cmUuY3JlYXRlVmlldyh7IG1pcExldmVsQ291bnQ6IDEsIGJhc2VNaXBMZXZlbDogaSB9KTtcbiAgICAgICAgY29uc3QgZW5jb2RlciA9IGRldmljZS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuICAgICAgICBjb25zdCBwYXNzID0gZW5jb2Rlci5iZWdpblJlbmRlclBhc3Moe1xuICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICBjb2xvckF0dGFjaG1lbnRzOiBbY29sb3JBdHRhY2htZW50IGFzIEdQVVJlbmRlclBhc3NDb2xvckF0dGFjaG1lbnRdLFxuICAgICAgICB9KTtcblxuICAgICAgICBwYXNzLnNldFBpcGVsaW5lKHBpcGVsaW5lKTtcbiAgICAgICAgcGFzcy5zZXRCaW5kR3JvdXAoMCwgYmluZGdyb3VwKTtcbiAgICAgICAgcGFzcy5kcmF3KDMpO1xuICAgICAgICBwYXNzLmVuZCgpO1xuXG4gICAgICAgIGRldmljZS5xdWV1ZS5zdWJtaXQoW2VuY29kZXIuZmluaXNoKCldKTtcbiAgICAgICAgYXdhaXQgZGV2aWNlLnF1ZXVlLm9uU3VibWl0dGVkV29ya0RvbmUoKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzcmdiVGV4dHVyZVRvTGluZWFyKGRldmljZTogR1BVRGV2aWNlLCB0ZXh0dXJlOiBHUFVUZXh0dXJlKSB7XG4gICAgY29uc3QgY29kZSA9IC8qIHdnc2wgKi8gYFxuICAgICAgICBAZ3JvdXAoMCkgQGJpbmRpbmcoMCkgdmFyIGltYWdlOiB0ZXh0dXJlXzJkPGYzMj47XG4gICAgICAgIEBncm91cCgwKSBAYmluZGluZygxKSB2YXIgaW1hZ2VTYW1wbGVyOiBzYW1wbGVyO1xuXG4gICAgICAgICR7YmxpdH1cblxuICAgICAgICBmbiBzUkdCVG9MaW5lYXIoY29sb3I6IHZlYzNmKSAtPiB2ZWMzZiB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0KCBcbiAgICAgICAgICAgICAgICBwb3coY29sb3IgKiAwLjk0Nzg2NzI5ODYgKyAwLjA1MjEzMjcwMTQsIHZlYzMoMi40KSksIFxuICAgICAgICAgICAgICAgIGNvbG9yICogMC4wNzczOTkzODA4LCBcbiAgICAgICAgICAgICAgICBjb2xvciA8PSB2ZWMzKDAuMDQwNDUpLCBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gIFxuXG4gICAgICAgIEBmcmFnbWVudFxuICAgICAgICBmbiBmcyhAbG9jYXRpb24oMCkgdXY6IHZlYzJmKSAtPiBAbG9jYXRpb24oMCkgdmVjNGYgIHtcbiAgICAgICAgICAgIGxldCBzYW1wbGUgPSB0ZXh0dXJlU2FtcGxlKGltYWdlLCBpbWFnZVNhbXBsZXIsIHV2KTtcbiAgICAgICAgICAgIGxldCBjb2xvciA9IHNSR0JUb0xpbmVhcihzYW1wbGUucmdiKTtcbiAgICAgICAgICAgIHJldHVybiB2ZWM0KGNvbG9yLCBzYW1wbGUuYSk7XG4gICAgICAgIH1cbiAgICBgO1xuXG4gICAgY29uc3QgbGFiZWwgPSBwYWRUZW1wbGF0ZWBzcmdiIHRvIGxpbmVhciR7dGV4dHVyZS5sYWJlbH1gO1xuXG4gICAgY29uc3Qgc2l6ZSA9IHsgd2lkdGg6IHRleHR1cmUud2lkdGgsIGhlaWdodDogdGV4dHVyZS5oZWlnaHQgfTtcblxuICAgIGNvbnN0IHRlbXBUZXh0dXJlID0gZGV2aWNlLmNyZWF0ZVRleHR1cmUoe1xuICAgICAgICBmb3JtYXQ6IHRleHR1cmUuZm9ybWF0LFxuICAgICAgICB1c2FnZTogR1BVVGV4dHVyZVVzYWdlLkNPUFlfRFNUIHwgR1BVVGV4dHVyZVVzYWdlLlRFWFRVUkVfQklORElORyxcbiAgICAgICAgc2l6ZSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGJpbmRncm91cExheW91dCA9IGRldmljZS5jcmVhdGVCaW5kR3JvdXBMYXlvdXQoe1xuICAgICAgICBsYWJlbCxcbiAgICAgICAgZW50cmllczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDAsXG4gICAgICAgICAgICAgICAgdGV4dHVyZToge30sXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogR1BVU2hhZGVyU3RhZ2UuRlJBR01FTlQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDEsXG4gICAgICAgICAgICAgICAgc2FtcGxlcjoge30sXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogR1BVU2hhZGVyU3RhZ2UuRlJBR01FTlQsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH0pO1xuXG4gICAgY29uc3Qgc2FtcGxlciA9IGRldmljZS5jcmVhdGVTYW1wbGVyKHtcbiAgICAgICAgbWluRmlsdGVyOiAnbGluZWFyJyxcbiAgICAgICAgbWFnRmlsdGVyOiAnbGluZWFyJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZHVsZSA9IGRldmljZS5jcmVhdGVTaGFkZXJNb2R1bGUoeyBsYWJlbCwgY29kZTogY29kZSB9KTtcbiAgICBjb25zdCBwaXBlbGluZUxheW91dCA9IGRldmljZS5jcmVhdGVQaXBlbGluZUxheW91dCh7IGxhYmVsLCBiaW5kR3JvdXBMYXlvdXRzOiBbYmluZGdyb3VwTGF5b3V0XSB9KTtcblxuICAgIGNvbnN0IHBpcGVsaW5lID0gZGV2aWNlLmNyZWF0ZVJlbmRlclBpcGVsaW5lKHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGxheW91dDogcGlwZWxpbmVMYXlvdXQsXG4gICAgICAgIHZlcnRleDoge1xuICAgICAgICAgICAgZW50cnlQb2ludDogJ3ZzJyxcbiAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgfSxcbiAgICAgICAgZnJhZ21lbnQ6IHtcbiAgICAgICAgICAgIGVudHJ5UG9pbnQ6ICdmcycsXG4gICAgICAgICAgICB0YXJnZXRzOiBbeyBmb3JtYXQ6IHRleHR1cmUuZm9ybWF0IH1dLFxuICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgYmluZGdyb3VwID0gZGV2aWNlLmNyZWF0ZUJpbmRHcm91cCh7XG4gICAgICAgIGxhYmVsLFxuICAgICAgICBsYXlvdXQ6IGJpbmRncm91cExheW91dCxcbiAgICAgICAgZW50cmllczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJpbmRpbmc6IDAsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2U6IHRlbXBUZXh0dXJlLmNyZWF0ZVZpZXcoKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYmluZGluZzogMSxcbiAgICAgICAgICAgICAgICByZXNvdXJjZTogc2FtcGxlcixcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBlbmNvZGVyID0gZGV2aWNlLmNyZWF0ZUNvbW1hbmRFbmNvZGVyKCk7XG4gICAgZW5jb2Rlci5jb3B5VGV4dHVyZVRvVGV4dHVyZShcbiAgICAgICAgeyB0ZXh0dXJlIH0sXG4gICAgICAgIHsgdGV4dHVyZTogdGVtcFRleHR1cmUgfSxcbiAgICAgICAgc2l6ZSxcbiAgICApO1xuXG4gICAgY29uc3QgcGFzcyA9IGVuY29kZXIuYmVnaW5SZW5kZXJQYXNzKHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIGNvbG9yQXR0YWNobWVudHM6IFt7XG4gICAgICAgICAgICB2aWV3OiB0ZXh0dXJlLmNyZWF0ZVZpZXcoeyBtaXBMZXZlbENvdW50OiAxLCBiYXNlTWlwTGV2ZWw6IDAgfSksXG4gICAgICAgICAgICBsb2FkT3A6ICdjbGVhcicsXG4gICAgICAgICAgICBzdG9yZU9wOiAnc3RvcmUnLFxuICAgICAgICB9XSxcbiAgICB9KTtcblxuICAgIHBhc3Muc2V0UGlwZWxpbmUocGlwZWxpbmUpO1xuICAgIHBhc3Muc2V0QmluZEdyb3VwKDAsIGJpbmRncm91cCk7XG4gICAgcGFzcy5kcmF3KDMpO1xuICAgIHBhc3MuZW5kKCk7XG5cbiAgICBkZXZpY2UucXVldWUuc3VibWl0KFtlbmNvZGVyLmZpbmlzaCgpXSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///7335\n")}}]);